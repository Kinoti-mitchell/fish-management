var Os=Object.defineProperty,Cs=Object.defineProperties;var Ds=Object.getOwnPropertyDescriptors;var Ke=Object.getOwnPropertySymbols;var Fs=Object.prototype.hasOwnProperty,Is=Object.prototype.propertyIsEnumerable;var Re=(N,g,x)=>g in N?Os(N,g,{enumerable:!0,configurable:!0,writable:!0,value:x}):N[g]=x,f=(N,g)=>{for(var x in g||(g={}))Fs.call(g,x)&&Re(N,x,g[x]);if(Ke)for(var x of Ke(g))Is.call(g,x)&&Re(N,x,g[x]);return N},y=(N,g)=>Cs(N,Ds(g));var O=(N,g,x)=>new Promise((M,B)=>{var ee=U=>{try{V(x.next(U))}catch(G){B(G)}},ge=U=>{try{V(x.throw(U))}catch(G){B(G)}},V=U=>U.done?M(U.value):Promise.resolve(U.value).then(ee,ge);V((x=x.apply(N,g)).next())});import{c as ze,m as Ps,r as b,j as e,S as be,B as _,L as C,e as L,P as W,I as le,a as H,b as X,F as _e,f as $s,g as As,l as D,E as ne,W as Ts,X as He,T as Xe,t as S,q as Je,v as Us,s as z}from"./index-BopqAkGc.js";import{S as Ye,a as Ze,b as es,c as ss,d as Y}from"./select-DMqfGFn2.js";import{T as ts}from"./textarea--7cwtIbl.js";import{D as de,a as Es,b as ce,c as oe,d as me,f as xe,e as Ls}from"./dialog-mq7k2ueJ.js";import{C as as}from"./checkbox-3nL7-2dk.js";import{i as Ms}from"./inventoryService-CBp3CtPl.js";import{F as Bs}from"./FishFarmMarquee-BJN5OL5B.js";import{a as Vs}from"./auditLogger-BTBu8m6O.js";import{C as Z}from"./clock-CpNLkAzZ.js";import{C as P}from"./circle-check-big-D0p4vUNm.js";import{C as Ne}from"./calendar-CFWPSyWu.js";import{F as ve}from"./file-text-BRn0723M.js";import{S as Ws}from"./star-SGT-YRqE.js";import{R as Gs}from"./ruler-InO5FVxo.js";import{a as Qs}from"./index-CINu9dHP.js";import{M as rs}from"./map-pin-CXJjNCPd.js";import{P as Ks}from"./phone-CBFT5yDL.js";import{P as Rs}from"./plus-snqcj8Q8.js";import{D as Hs}from"./dollar-sign-CCZzSQeK.js";import{B as Xs}from"./building-2-CClPKL8I.js";import"./index-CtHfZV8A.js";import"./index-BYgpo3uK.js";import"./trending-up-X7g_A8AD.js";import"./award-DYBsp9Cf.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],we=ze("ban",Js);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ys=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],is=ze("circle-plus",Ys);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],ls=ze("user-check",Zs),et=[{size:0,label:"Size 0 - Premium Large",description:"2.5+ kg each"},{size:1,label:"Size 1 - Extra Large",description:"2.0-2.5 kg each"},{size:2,label:"Size 2 - Large",description:"1.5-2.0 kg each"},{size:3,label:"Size 3 - Medium-Large",description:"1.2-1.5 kg each"},{size:4,label:"Size 4 - Medium",description:"1.0-1.2 kg each"},{size:5,label:"Size 5 - Medium-Small",description:"0.8-1.0 kg each"},{size:6,label:"Size 6 - Small-Medium",description:"0.6-0.8 kg each"},{size:7,label:"Size 7 - Small",description:"0.4-0.6 kg each"},{size:8,label:"Size 8 - Extra Small",description:"0.3-0.4 kg each"},{size:9,label:"Size 9 - Mini",description:"0.2-0.3 kg each"},{size:10,label:"Size 10 - Tiny",description:"0.1-0.2 kg each"}];function qt({onNavigate:N}){var Be,Ve,We,Ge,Qe;const{user:g}=Ps(),[x,M]=b.useState([]),[B,ee]=b.useState([]),[ge,V]=b.useState([]),[U,G]=b.useState(!0),[ns,se]=b.useState(!1),[ds,ue]=b.useState(!1),[cs,Q]=b.useState(!1),[o,os]=b.useState(null),[ms,te]=b.useState(!1),[j,qe]=b.useState(null),ke=(s,t,a,n,d)=>O(this,null,function*(){try{yield Vs.custom(s,t,a,{old_values:n,new_values:d})}catch(i){console.warn("Failed to log audit event:",i)}}),[q,ae]=b.useState("all"),[r,F]=b.useState({outlet_id:"",requested_quantity:"",requested_grade:"",price_per_kg:"",requested_sizes:[],size_quantities:{},use_any_size:!1,delivery_date:"",notes:""}),[u,E]=b.useState({}),[he,Se]=b.useState(!1),[$,re]=b.useState({confirmedBy:"",notes:"",action:"approve"}),[pe,Oe]=b.useState(!1),[v,K]=b.useState([]),[I,Ce]=b.useState(null),[De,fe]=b.useState([]),[xs,Fe]=b.useState(!1),[ye,je]=b.useState({}),gs=(s,t)=>{F(a=>y(f({},a),{size_quantities:y(f({},a.size_quantities),{[s]:t})}))},us=s=>{F(t=>y(f({},t),{use_any_size:s,requested_sizes:s?[]:t.requested_sizes,size_quantities:s?{}:t.size_quantities}))},hs=s=>O(this,null,function*(){Fe(!0);try{const t=yield Ms.getInventoryByStorage();if(!t||t.length===0){console.log("No inventory data available"),fe([]),je({});return}const a=new Set,n={};t.forEach(d=>{const i=d.size;!isNaN(i)&&d.total_quantity>0&&(a.add(i),n[i]||(n[i]={quantity:0,storageLocation:d.storage_location_name||"Unknown Storage",grade:"A",totalWeight:0}),n[i].quantity+=d.total_quantity,n[i].totalWeight+=d.total_weight_kg,n[i].storageLocation==="Unknown Storage"&&(n[i].storageLocation=d.storage_location_name||"Unknown Storage"))}),fe(Array.from(a).sort((d,i)=>d-i)),je(n)}catch(t){console.error("Error fetching available sizes:",t),S.error("Failed to fetch available sizes",{description:"Please try again or check your connection",duration:5e3}),fe([]),je({})}finally{Fe(!1)}}),Ie=()=>O(this,null,function*(){try{const{data:s,error:t}=yield z.from("processing_records").select(`
          *,
          warehouse_entries!inner(
            entry_date,
            total_weight,
            total_pieces,
            condition,
            temperature,
            price_per_kg,
            total_value,
            notes,
            farmers!inner(
              name,
              phone,
              location,
              rating,
              reliability
            )
          )
        `).gt("ready_for_dispatch_count",0).order("processing_date",{ascending:!1});if(t)throw t;const n=((s==null?void 0:s.map(i=>{let l=0;if(i.size_distribution&&typeof i.size_distribution=="object"){const p=Object.keys(i.size_distribution);p.length>0&&(l=parseInt(p[0])||0)}let h="Unknown";if(i.grading_results&&typeof i.grading_results=="object"){const p=Object.keys(i.grading_results);p.length>0&&(h=p[0])}const c=i.warehouse_entries,m=c==null?void 0:c.farmers;return y(f({},i),{final_grade:h,final_size:l,storage_location:"Processing Area",farmer_name:(m==null?void 0:m.name)||"Unknown Farmer",entry_date:c==null?void 0:c.entry_date,total_pieces:c==null?void 0:c.total_pieces,condition:c==null?void 0:c.condition,temperature:c==null?void 0:c.temperature,price_per_kg:c==null?void 0:c.price_per_kg,total_value:c==null?void 0:c.total_value,notes:c==null?void 0:c.notes,farmer_phone:m==null?void 0:m.phone,farmer_location:m==null?void 0:m.location,farmer_rating:m==null?void 0:m.rating,farmer_reliability:m==null?void 0:m.reliability})}))||[]).reduce((i,l)=>{const h=l.final_size,c=l.storage_location,m=`${h}_${c}`;i[m]||(i[m]={id:`grouped_${m}`,final_size:h,final_grade:l.final_grade,storage_location:c,total_quantity:0,total_weight:0,total_value:0,processing_records:[],farmers:new Set,entry_dates:new Set,conditions:new Set,temperatures:[],processed_by_names:new Set,ready_for_dispatch_count:0,warehouse_entry_id:l.warehouse_entry_id,processing_date:l.processing_date,processed_by:l.processed_by,pre_processing_weight:l.pre_processing_weight,post_processing_weight:l.post_processing_weight,processing_waste:l.processing_waste,processing_yield:l.processing_yield,size_distribution:l.size_distribution,grading_results:l.grading_results,final_value:l.final_value,created_at:l.created_at,updated_at:l.updated_at,farmer_name:l.farmer_name,entry_date:l.entry_date,total_pieces:l.total_pieces,condition:l.condition,temperature:l.temperature,price_per_kg:l.price_per_kg,notes:l.notes,farmer_phone:l.farmer_phone,farmer_location:l.farmer_location,farmer_rating:l.farmer_rating,farmer_reliability:l.farmer_reliability});const p=l.size_distribution||{},k=p[h]||0;i[m].total_quantity+=k;const w=Object.values(p).reduce((R,Ss)=>R+(Number(Ss)||0),0),T=w>0?l.post_processing_weight/w:0,ie=k*T;return i[m].total_weight+=ie,i[m].total_value+=l.final_value||0,i[m].processing_records.push(l.id),i[m].farmers.add(l.farmer_name),i[m].entry_dates.add(l.entry_date),i[m].conditions.add(l.condition),l.temperature&&i[m].temperatures.push(l.temperature),i[m].ready_for_dispatch_count+=l.ready_for_dispatch_count||0,i},{}),d=Object.values(n).map(i=>y(f({},i),{farmers:Array.from(i.farmers).join(", "),entry_dates:Array.from(i.entry_dates).join(", "),conditions:Array.from(i.conditions).join(", "),average_temperature:i.temperatures.length>0?(i.temperatures.reduce((l,h)=>l+h,0)/i.temperatures.length).toFixed(1):null,processing_count:i.processing_records.length}));d.sort((i,l)=>i.final_size!==l.final_size?i.final_size-l.final_size:i.storage_location.localeCompare(l.storage_location)),V(d)}catch(s){console.error("Error fetching inventory:",s),S.error("Failed to fetch inventory data",{description:"Please refresh the page or try again later",duration:5e3}),V([])}}),Pe=()=>O(this,null,function*(){try{G(!0);const[s,t]=yield Promise.allSettled([Je.getOutletOrders(),Us.getOutlets()]);M(s.status==="fulfilled"?s.value:[]),ee(t.status==="fulfilled"?t.value:[]),yield Ie(),s.status==="rejected"&&console.warn("Outlet orders table not available yet:",s.reason),t.status==="rejected"&&console.warn("Outlets table not available yet:",t.reason)}catch(s){console.error("Error fetching data:",s),S.error("Failed to load order data",{description:"Please refresh the page or check your connection",duration:5e3}),M([]),ee([]),V([])}finally{G(!1)}});b.useEffect(()=>{Pe()},[]);const $e=s=>{switch(s){case"pending":return"bg-amber-500 text-white";case"confirmed":return"bg-blue-500 text-white";case"dispatched":return"bg-emerald-500 text-white";case"completed":return"bg-green-600 text-white";default:return"bg-gray-500 text-white"}},Ae=s=>{switch(s){case"pending":return e.jsx(Z,{className:"h-4 w-4"});case"confirmed":return e.jsx(P,{className:"h-4 w-4"});case"dispatched":return e.jsx(P,{className:"h-4 w-4"});case"completed":return e.jsx(P,{className:"h-4 w-4"});default:return e.jsx(Z,{className:"h-4 w-4"})}},A=s=>`KES ${s.toLocaleString()}`,Te=s=>{if(s.length===0)return"No sizes selected";const t=s.sort((a,n)=>a-n);return t.length===1?`Size ${t[0]}`:`Sizes ${t[0]}-${t[t.length-1]}`},ps=s=>{F(t=>y(f({},t),{requested_sizes:t.requested_sizes.includes(s)?t.requested_sizes.filter(a=>a!==s):[...t.requested_sizes,s].sort((a,n)=>a-n),requested_grade:""}))},fs=()=>{const s={};if(r.outlet_id||(s.outlet_id="Please select an outlet"),r.use_any_size)(!r.requested_quantity||parseFloat(r.requested_quantity)<=0)&&(s.requested_quantity="Please enter a valid total quantity (greater than 0)");else if(r.requested_sizes.length===0)s.requested_sizes="Please select at least one fish size";else{Object.values(r.size_quantities).reduce((a,n)=>a+n,0)<=0&&(s.requested_sizes="Please specify quantities for selected sizes");for(const a of r.requested_sizes){const n=r.size_quantities[a]||0,d=ye[a],i=d?d.totalWeight:0;if(n>i){s.requested_sizes=`Size ${a}: Requested ${n}kg exceeds available ${i.toFixed(1)}kg`;break}}}return(!r.price_per_kg||parseFloat(r.price_per_kg)<=0)&&(s.price_per_kg="Please enter a valid price per kg (greater than 0)"),r.requested_grade||(s.requested_grade="Please select a grade preference"),r.delivery_date&&new Date(r.delivery_date)<new Date&&(s.delivery_date="Delivery date cannot be in the past"),E(s),Object.keys(s).length===0},ys=()=>O(this,null,function*(){try{const{data:s,error:t}=yield z.from("outlet_orders").select("order_number").not("order_number","is",null).order("created_at",{ascending:!1}).limit(1);if(t)throw t;let a=1;if(s&&s.length>0){const n=s[0].order_number,d=n==null?void 0:n.match(/INV(\d+)/);d&&(a=parseInt(d[1])+1)}return`INV${a.toString().padStart(3,"0")}`}catch(s){return console.error("Error generating order number:",s),`INV${Date.now().toString().slice(-6)}`}}),js=()=>O(this,null,function*(){if(fs()){Se(!0);try{const s=yield ys();let t,a;r.use_any_size?(t=parseFloat(r.requested_quantity),a=[]):(t=Object.values(r.size_quantities).reduce((l,h)=>l+h,0),a=r.requested_sizes);const n=t*parseFloat(r.price_per_kg),d={outlet_id:r.outlet_id,order_date:new Date().toISOString().split("T")[0],delivery_date:r.delivery_date||null,requested_sizes:a,requested_quantity:t,requested_grade:r.requested_grade==="any"?null:r.requested_grade,price_per_kg:parseFloat(r.price_per_kg),total_value:n,status:"pending",notes:r.notes,order_number:s,size_quantities:r.use_any_size?{}:r.size_quantities,use_any_size:r.use_any_size};console.log("Creating order with data:",d);const i=yield Je.createOutletOrder(d);M([i,...x]),F({outlet_id:"",requested_quantity:"",requested_grade:"",price_per_kg:"",requested_sizes:[],size_quantities:{},use_any_size:!1,delivery_date:"",notes:""}),E({}),se(!1),S.success(`Order ${s} created successfully!`,{description:`Order Number: ${s}`,duration:5e3})}catch(s){console.error("Error creating order:",s),S.error("Failed to create order",{description:s.message||"Unknown error occurred",duration:5e3})}finally{Se(!1)}}}),Ue=s=>{const t=x.find(a=>a.id===s);t&&(qe(t),te(!0),re({confirmedBy:(g==null?void 0:g.email)||"Current User",notes:"",action:"approve"}))},bs=()=>O(this,null,function*(){if(!j){S.error("No order selected for confirmation");return}Oe(!0);try{if($.action==="approve"){const{error:s}=yield z.from("outlet_orders").update({status:"confirmed",confirmed_date:new Date().toISOString().split("T")[0],notes:$.notes||j.notes}).eq("id",j.id);if(s)throw s;yield ke("UPDATE","outlet_orders",j.id,{status:j.status},{status:"confirmed",confirmed_date:new Date().toISOString().split("T")[0]}),yield _s(j),yield Ns(),yield vs(j),M(t=>t.map(a=>a.id===j.id?y(f({},a),{status:"confirmed",confirmedDate:new Date().toISOString().split("T")[0]}):a)),S.success(`Order ${j.order_number||j.id} approved, confirmed, and moved to dispatch!`)}else{const{error:s}=yield z.from("outlet_orders").update({status:"cancelled",notes:`Order discarded by ${(g==null?void 0:g.email)||"Current User"}. ${$.notes||""}`.trim()}).eq("id",j.id);if(s)throw s;yield ke("UPDATE","outlet_orders",j.id,{status:j.status},{status:"cancelled",notes:`Order discarded by ${(g==null?void 0:g.email)||"Current User"}. ${$.notes||""}`.trim()}),M(t=>t.map(a=>a.id===j.id?y(f({},a),{status:"cancelled"}):a)),S.success(`Order ${j.order_number||j.id} has been discarded.`)}te(!1),qe(null)}catch(s){console.error("Error processing order confirmation:",s),S.error("Failed to process order confirmation",{description:"Please try again or contact support if the issue persists",duration:5e3})}finally{Oe(!1)}}),_s=s=>O(this,null,function*(){try{const{data:t,error:a}=yield z.from("sorting_results").select(`
          *,
          sorting_batch:sorting_batches!inner(
            id,
            status
          )
        `).eq("sorting_batch.status","completed").gt("total_weight_grams",0);if(a)throw a;if(!t||t.length===0)throw new Error("No available inventory found for order confirmation");let d=s.requested_quantity||0;const i=[];if(s.size_quantities&&Object.keys(s.size_quantities).length>0)for(const[l,h]of Object.entries(s.size_quantities)){const c=parseInt(l),m=h,p=t.filter(w=>w.size_class===c&&w.total_weight_grams>0);let k=m;for(const w of p){if(k<=0)break;const T=Math.min(k,w.total_weight_grams/1e3),{error:ie}=yield z.from("sorting_results").update({total_weight_grams:w.total_weight_grams-T*1e3,total_pieces:Math.max(0,w.total_pieces-Math.ceil(T))}).eq("id",w.id);if(ie)throw ie;try{const{error:R}=yield z.from("inventory_entries").insert({size:c,quantity_change:-Math.ceil(T),entry_type:"order_dispatch",reference_id:s.id,notes:`Order dispatch - Size ${c}, Weight: ${T.toFixed(2)}kg`});R&&console.warn("Could not create inventory entry:",R)}catch(R){console.warn("Inventory entries table might not exist:",R)}i.push({size:c,weight_deducted:T,remaining_stock:(w.total_weight_grams-T*1e3)/1e3}),k-=T}}else for(const l of t){if(d<=0)break;const h=Math.min(d,l.total_weight_grams/1e3),{error:c}=yield z.from("sorting_results").update({total_weight_grams:l.total_weight_grams-h*1e3,total_pieces:Math.max(0,l.total_pieces-Math.ceil(h))}).eq("id",l.id);if(c)throw c;try{const{error:m}=yield z.from("inventory_entries").insert({size:l.size_class||0,quantity_change:-Math.ceil(h),entry_type:"order_dispatch",reference_id:s.id,notes:`Order dispatch - Size ${l.size_class||0}, Weight: ${h.toFixed(2)}kg`});m&&console.warn("Could not create inventory entry:",m)}catch(m){console.warn("Inventory entries table might not exist:",m)}i.push({size:l.size_class||0,weight_deducted:h,remaining_stock:(l.total_weight_grams-h*1e3)/1e3}),d-=h}return console.log("Inventory deducted for order confirmation:",i),i}catch(t){throw console.error("Error deducting inventory on order confirmation:",t),t}}),Ns=()=>O(this,null,function*(){try{console.log("ðŸ”„ Updating storage capacity after order confirmation...");const{error:s}=yield z.rpc("update_storage_capacity_from_inventory");s?console.warn("âš ï¸ Could not update storage capacity:",s):console.log("âœ… Storage capacity updated successfully")}catch(s){console.warn("âš ï¸ Error updating storage capacity:",s)}}),vs=s=>O(this,null,function*(){try{const t=B.find(c=>c.id===s.outlet_id),a=(t==null?void 0:t.name)||"Unknown Outlet",n=s.requested_quantity||0,d=s.requested_quantity||0,i=s.size_quantities||{},{data:l,error:h}=yield z.from("dispatch_records").insert({outlet_order_id:s.id,fish_ids:[],destination:a,dispatch_date:new Date().toISOString().split("T")[0],total_weight:n,total_pieces:d,size_breakdown:i,total_value:s.total_value||0,status:"scheduled",notes:`Auto-created dispatch for confirmed order ${s.order_number||s.id}`,dispatched_by:(g==null?void 0:g.id)||null}).select().single();if(h)throw console.error("Error creating dispatch record:",h),h;return console.log("Automatic dispatch record created:",l),l}catch(t){console.error("Failed to create automatic dispatch record:",t),S.warning("Order confirmed but dispatch record creation failed. Please create dispatch manually.")}}),ws=()=>O(this,null,function*(){if(!I||v.length===0){S.error("Please select items from inventory");return}try{const s=v.map(p=>p.inventoryItem.id),{error:t}=yield z.from("processing_records").update({ready_for_dispatch_count:0}).in("id",s);if(t)throw t;const a=v.reduce((p,k)=>p+k.weight,0),n=v.reduce((p,k)=>p+k.quantity,0),d=v.reduce((p,k)=>{const w=k.inventoryItem.final_size||0;return p[w]=(p[w]||0)+k.quantity,p},{}),i=x.find(p=>p.id===I),l=B.find(p=>p.id===(i==null?void 0:i.outlet_id)),{data:h,error:c}=yield z.from("dispatch_records").insert({outlet_order_id:I,fish_ids:s,destination:(l==null?void 0:l.name)||"Unknown",dispatch_date:new Date().toISOString().split("T")[0],total_weight:a,total_pieces:n,size_breakdown:d,total_value:(i==null?void 0:i.total_value)||0,status:"dispatched",notes:`Inventory picked for order ${(i==null?void 0:i.order_number)||I}`,dispatched_by:(g==null?void 0:g.id)||null}).select().single();if(c)throw c;const{error:m}=yield z.from("outlet_orders").update({status:"dispatched",dispatch_date:new Date().toISOString().split("T")[0]}).eq("id",I);if(m)throw m;yield Pe(),yield Ie(),ue(!1),Ce(null),K([]),S.success("Order dispatched successfully!",{description:`Order ${(i==null?void 0:i.order_number)||I} has been dispatched with ${n} pieces`,duration:5e3})}catch(s){console.error("Error dispatching order:",s),S.error("Failed to dispatch order",{description:"Please try again or contact support if the issue persists",duration:5e3})}}),Ee=()=>{switch(q){case"pending":return x.filter(s=>s.status==="pending");case"confirmed":return x.filter(s=>s.status==="confirmed");case"cancelled":return x.filter(s=>s.status==="cancelled");case"all":default:return x}},zs=s=>{const t=x.find(a=>a.id===s);t&&(os(t),Q(!0))},qs=(s,t)=>{const a=v.findIndex(n=>n.inventoryItem.id===s.id);if(a>=0){const n=[...v];n[a].quantity+=t,n[a].weight=n[a].quantity*(s.post_processing_weight/(s.total_pieces||1)),K(n)}else{const n=t*(s.post_processing_weight/(s.total_pieces||1));K(d=>[...d,{inventoryItem:s,quantity:t,weight:n}])}},Le=s=>{K(t=>t.filter(a=>a.inventoryItem.id!==s))},ks=(s,t)=>{if(t<=0){Le(s);return}K(a=>a.map(n=>{if(n.inventoryItem.id===s){const d=t*(n.inventoryItem.post_processing_weight/(n.inventoryItem.total_pieces||1));return y(f({},n),{quantity:t,weight:d})}return n}))},Me=s=>ge.filter(t=>!(!t.total_quantity||t.total_quantity<=0||t.ready_for_dispatch_count<=0||s.requested_sizes&&s.requested_sizes.length>0&&!s.requested_sizes.includes(t.final_size||0)||s.requested_grade&&s.requested_grade!=="any"&&t.final_grade!==s.requested_grade)),J={totalOrders:x.length,pendingOrders:x.filter(s=>s.status==="pending").length,confirmedOrders:x.filter(s=>s.status==="confirmed").length,totalValue:x.reduce((s,t)=>s+t.total_value,0),totalQuantity:x.reduce((s,t)=>s+(t.requested_quantity||0),0)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 content-container responsive-padding",children:[e.jsx(Bs,{}),e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h1",{className:"text-4xl font-bold text-gray-900 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl shadow-lg",children:e.jsx(be,{className:"h-10 w-10 text-white"})}),"Order Management"]}),e.jsx("p",{className:"text-xl text-gray-600 ml-16",children:"Manage fish orders from outlets across Kenya â€¢ Size-based selection"})]}),e.jsxs(de,{open:ns,onOpenChange:s=>{console.log("Dialog state changing to:",s),se(s)},children:[e.jsx(Es,{asChild:!0,children:e.jsxs(_,{onClick:()=>{console.log("New Order button clicked"),se(!0)},className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-4 rounded-2xl font-semibold text-lg shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105",children:[e.jsx(is,{className:"h-6 w-6 mr-3"}),"New Order"]})}),e.jsxs(ce,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(oe,{className:"pb-4",children:[e.jsxs(me,{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg",children:e.jsx(is,{className:"h-5 w-5 text-white"})}),"Create New Order"]}),e.jsx(xe,{className:"text-gray-600",children:"Create a new order for your outlet with real-time inventory validation"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(Z,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-700 font-medium",children:"FIFO System Active: Orders will automatically use oldest batches first"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(C,{className:"text-base font-semibold text-gray-700",children:"Select Outlet *"}),e.jsxs(Ye,{value:r.outlet_id,onValueChange:s=>{F(y(f({},r),{outlet_id:s,requested_sizes:[]})),u.outlet_id&&E(y(f({},u),{outlet_id:""})),hs()},children:[e.jsx(Ze,{className:`h-12 ${u.outlet_id?"border-red-500":"border-gray-300"}`,children:e.jsx(es,{placeholder:"Choose an outlet..."})}),e.jsx(ss,{children:B.map(s=>e.jsx(Y,{value:s.id,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx("span",{className:"text-sm text-gray-500",children:s.location})]})},s.id))})]}),u.outlet_id&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{children:u.outlet_id})]})]}),r.outlet_id&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(C,{className:"text-base font-semibold text-gray-700",children:"Select Fish Sizes *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(as,{id:"any-size",checked:r.use_any_size,onCheckedChange:us,className:"h-4 w-4"}),e.jsx("label",{htmlFor:"any-size",className:"text-sm text-gray-600 cursor-pointer",children:"Use any available size"})]})]}),r.use_any_size?e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(P,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Any Size Selected"})]}),e.jsx("p",{className:"text-xs text-green-700",children:"The system will automatically select the best available sizes based on inventory and your total quantity requirement."})]}):e.jsxs(e.Fragment,{children:[xs?e.jsxs("div",{className:"p-6 text-center border border-gray-200 rounded-lg bg-gray-50",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Loading available sizes..."})]}):e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 max-h-60 overflow-y-auto p-3 border border-gray-200 rounded-lg bg-gray-50",children:[et.filter(s=>De.includes(s.size)).map(s=>{const t=ye[s.size];return e.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all ${r.requested_sizes.includes(s.size)?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-blue-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(as,{id:`size-${s.size}`,checked:r.requested_sizes.includes(s.size),onCheckedChange:()=>ps(s.size),className:"h-4 w-4"}),e.jsxs("label",{htmlFor:`size-${s.size}`,className:"cursor-pointer text-sm font-medium",children:["Size ",s.size]})]}),t&&e.jsxs("div",{className:"text-xs text-gray-600 pl-6 mb-2",children:[e.jsxs("div",{children:[t.quantity," pcs"]}),e.jsxs("div",{children:[t.totalWeight?t.totalWeight.toFixed(1):"0.0"," kg"]})]})]},s.size)}),De.length===0&&e.jsxs("div",{className:"col-span-full text-center py-4 text-gray-500",children:[e.jsx(W,{className:"h-6 w-6 mx-auto mb-1 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No sizes available"})]})]})}),r.requested_sizes.length>0&&e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-800 mb-3",children:["Selected: ",Te(r.requested_sizes)," (",r.requested_sizes.length," size",r.requested_sizes.length!==1?"s":"",")"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-blue-700 font-medium",children:"Specify quantity (kg) for each size:"}),r.requested_sizes.map(s=>{const t=ye[s],a=t?t.totalWeight:0,n=r.size_quantities[s]||0;return e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-blue-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-700",children:["Size ",s]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Available: ",a.toFixed(1)," kg"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",placeholder:"0.0",min:"0.1",max:a,step:"0.1",className:"h-8 text-sm flex-1",value:n||"",onChange:d=>gs(s,parseFloat(d.target.value)||0)}),e.jsx("span",{className:"text-xs text-gray-500",children:"kg"})]}),n>a&&e.jsxs("div",{className:"flex items-center gap-1 text-red-600 text-xs mt-1",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsx("span",{children:"Exceeds available stock"})]})]},s)}),e.jsx("div",{className:"pt-2 border-t border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium text-blue-800",children:"Total Requested:"}),e.jsxs("span",{className:"font-bold text-blue-600",children:[Object.values(r.size_quantities).reduce((s,t)=>s+t,0).toFixed(1)," kg"]})]})})]})]})]}),u.requested_sizes&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{children:u.requested_sizes})]})]}),(r.requested_sizes.length>0||r.use_any_size)&&e.jsxs("div",{className:"space-y-4",children:[r.use_any_size?e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{className:"text-sm font-medium text-gray-700",children:"Total Quantity (kg) *"}),e.jsx(le,{type:"number",placeholder:"100",min:"1",step:"0.1",className:`h-10 ${u.requested_quantity?"border-red-500":"border-gray-300"}`,value:r.requested_quantity,onChange:s=>{F(y(f({},r),{requested_quantity:s.target.value})),u.requested_quantity&&E(y(f({},u),{requested_quantity:""}))}}),u.requested_quantity&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsx("span",{children:u.requested_quantity})]})]}):e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Quantity:"}),e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[Object.values(r.size_quantities).reduce((s,t)=>s+t,0).toFixed(1)," kg"]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Calculated from individual size quantities above"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{className:"text-sm font-medium text-gray-700",children:"Price per kg (KES) *"}),e.jsx(le,{type:"number",placeholder:"500",min:"1",step:"0.01",className:`h-10 ${u.price_per_kg?"border-red-500":"border-gray-300"}`,value:r.price_per_kg,onChange:s=>{F(y(f({},r),{price_per_kg:s.target.value})),u.price_per_kg&&E(y(f({},u),{price_per_kg:""}))}}),u.price_per_kg&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsx("span",{children:u.price_per_kg})]})]})]}),(r.requested_sizes.length>0||r.use_any_size)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{className:"text-sm font-medium text-gray-700",children:"Grade Preference"}),e.jsxs(Ye,{value:r.requested_grade,onValueChange:s=>{F(y(f({},r),{requested_grade:s})),u.requested_grade&&E(y(f({},u),{requested_grade:""}))},children:[e.jsx(Ze,{className:`h-10 ${u.requested_grade?"border-red-500":"border-gray-300"}`,children:e.jsx(es,{placeholder:"Select grade preference"})}),e.jsxs(ss,{children:[e.jsx(Y,{value:"any",children:"Any Grade Available"}),e.jsx(Y,{value:"A",children:"Grade A (Premium)"}),e.jsx(Y,{value:"B",children:"Grade B (Standard)"}),e.jsx(Y,{value:"C",children:"Grade C (Economy)"})]})]}),u.requested_grade&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsx("span",{children:u.requested_grade})]})]}),r.requested_sizes.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{className:"text-sm font-medium text-gray-700",children:"Delivery Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(le,{type:"date",className:`h-10 pl-10 ${u.delivery_date?"border-red-500":"border-gray-300"}`,value:r.delivery_date,min:new Date().toISOString().split("T")[0],onChange:s=>{F(y(f({},r),{delivery_date:s.target.value})),u.delivery_date&&E(y(f({},u),{delivery_date:""}))}})]}),u.delivery_date&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(L,{className:"h-3 w-3"}),e.jsx("span",{children:u.delivery_date})]})]}),r.requested_sizes.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{className:"text-sm font-medium text-gray-700",children:"Notes (Optional)"}),e.jsx(ts,{placeholder:"Special requirements, delivery instructions, etc...",className:"h-20 border-gray-300 resize-none",value:r.notes,onChange:s=>F(y(f({},r),{notes:s.target.value}))})]}),u.inventory&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"h-5 w-5 text-red-600"}),e.jsx("p",{className:"text-red-800 font-medium",children:"Inventory Insufficient"})]}),e.jsx("p",{className:"text-red-700 text-sm mt-1",children:u.inventory})]}),(r.use_any_size&&r.requested_quantity||!r.use_any_size&&r.requested_sizes.length>0)&&r.price_per_kg&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 border border-blue-200 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-xl",children:e.jsx(ve,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Order Summary"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Review your order details"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-white rounded-xl border border-gray-200 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Quantity"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.use_any_size?`${r.requested_quantity} kg`:`${Object.values(r.size_quantities).reduce((s,t)=>s+t,0).toFixed(1)} kg`})]}),e.jsxs("div",{className:"text-center p-4 bg-white rounded-xl border border-gray-200 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Price per kg"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["KES ",parseFloat(r.price_per_kg||"0").toLocaleString()]})]}),e.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl border border-blue-200 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Total Value"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:["KES ",((r.use_any_size?parseFloat(r.requested_quantity||"0"):Object.values(r.size_quantities).reduce((s,t)=>s+t,0))*parseFloat(r.price_per_kg||"0")).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t border-gray-200",children:[e.jsx(_,{variant:"outline",onClick:()=>{se(!1),E({})},className:"px-8 py-3 text-base border-gray-300 hover:bg-gray-50",disabled:he,children:"Cancel"}),e.jsx(_,{onClick:js,disabled:he||!r.outlet_id||!r.use_any_size&&r.requested_sizes.length===0||!r.price_per_kg||!r.requested_grade,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 px-8 py-3 text-base disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:he?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating Order..."]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Create Order"]})})]})]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[e.jsx(H,{className:"border-0 shadow-xl bg-gradient-to-br from-blue-50 to-blue-100 hover:shadow-2xl transition-all duration-300",children:e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-blue-600 uppercase tracking-wide",children:"Total Orders"}),e.jsx("p",{className:"text-4xl font-bold text-blue-900 mt-2",children:J.totalOrders})]}),e.jsx("div",{className:"p-4 bg-blue-600 rounded-2xl shadow-lg",children:e.jsx(be,{className:"h-8 w-8 text-white"})})]})})}),e.jsx(H,{className:"border-0 shadow-xl bg-gradient-to-br from-amber-50 to-amber-100 hover:shadow-2xl transition-all duration-300",children:e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-amber-600 uppercase tracking-wide",children:"Pending"}),e.jsx("p",{className:"text-4xl font-bold text-amber-900 mt-2",children:J.pendingOrders})]}),e.jsx("div",{className:"p-4 bg-amber-600 rounded-2xl shadow-lg",children:e.jsx(Z,{className:"h-8 w-8 text-white"})})]})})}),e.jsx(H,{className:"border-0 shadow-xl bg-gradient-to-br from-emerald-50 to-emerald-100 hover:shadow-2xl transition-all duration-300",children:e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-emerald-600 uppercase tracking-wide",children:"Confirmed"}),e.jsx("p",{className:"text-4xl font-bold text-emerald-900 mt-2",children:J.confirmedOrders})]}),e.jsx("div",{className:"p-4 bg-emerald-600 rounded-2xl shadow-lg",children:e.jsx(P,{className:"h-8 w-8 text-white"})})]})})}),e.jsx(H,{className:"border-0 shadow-xl bg-gradient-to-br from-purple-50 to-purple-100 hover:shadow-2xl transition-all duration-300",children:e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-purple-600 uppercase tracking-wide",children:"Total Quantity"}),e.jsx("p",{className:"text-4xl font-bold text-purple-900 mt-2",children:J.totalQuantity}),e.jsx("p",{className:"text-sm text-purple-600",children:"kg"})]}),e.jsx("div",{className:"p-4 bg-purple-600 rounded-2xl shadow-lg",children:e.jsx(_e,{className:"h-8 w-8 text-white"})})]})})}),e.jsx(H,{className:"border-0 shadow-xl bg-gradient-to-br from-green-50 to-green-100 hover:shadow-2xl transition-all duration-300",children:e.jsx(X,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-green-600 uppercase tracking-wide",children:"Total Value"}),e.jsx("p",{className:"text-3xl font-bold text-green-900 mt-2",children:A(J.totalValue)})]}),e.jsx("div",{className:"p-4 bg-green-600 rounded-2xl shadow-lg",children:e.jsx(Ws,{className:"h-8 w-8 text-white"})})]})})})]}),e.jsxs(H,{className:"border-0 shadow-2xl bg-white/80 backdrop-blur-sm",children:[e.jsx($s,{className:"pb-6 bg-gradient-to-r from-gray-50 to-gray-100 rounded-t-3xl",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs(As,{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(Gs,{className:"h-8 w-8 text-purple-600"}),"Orders Management"]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(_,{variant:q==="all"?"default":"outline",size:"sm",onClick:()=>ae("all"),className:`flex items-center gap-2 ${q==="all"?"bg-blue-600 hover:bg-blue-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(W,{className:"h-4 w-4"}),"All Orders (",x.length,")"]}),e.jsxs(_,{variant:q==="pending"?"default":"outline",size:"sm",onClick:()=>ae("pending"),className:`flex items-center gap-2 ${q==="pending"?"bg-yellow-600 hover:bg-yellow-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(Z,{className:"h-4 w-4"}),"Pending (",x.filter(s=>s.status==="pending").length,")"]}),e.jsxs(_,{variant:q==="confirmed"?"default":"outline",size:"sm",onClick:()=>ae("confirmed"),className:`flex items-center gap-2 ${q==="confirmed"?"bg-green-600 hover:bg-green-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(Qs,{className:"h-4 w-4"}),"Approved (",x.filter(s=>s.status==="confirmed").length,")"]}),e.jsxs(_,{variant:q==="cancelled"?"default":"outline",size:"sm",onClick:()=>ae("cancelled"),className:`flex items-center gap-2 ${q==="cancelled"?"bg-red-600 hover:bg-red-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(we,{className:"h-4 w-4"}),"Discarded (",x.filter(s=>s.status==="cancelled").length,")"]})]})]})}),e.jsx(X,{className:"p-8",children:Ee().length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"p-4 bg-gray-100 rounded-full",children:e.jsx(W,{className:"h-8 w-8 text-gray-400"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["No ",q==="all"?"":q," orders found"]}),e.jsx("p",{className:"text-gray-500",children:q==="all"?"No orders have been created yet.":`No ${q} orders at the moment.`})]})]})}):e.jsx("div",{className:"space-y-6",children:Ee().map(s=>{var t,a,n,d;return e.jsx("div",{className:`border-2 rounded-3xl p-8 hover:shadow-xl transition-all duration-300 ${s.status==="dispatched"?"border-green-200 bg-gradient-to-r from-green-50 to-emerald-50 hover:from-green-100 hover:to-emerald-100":"border-gray-100 bg-gradient-to-r from-white to-gray-50 hover:from-blue-50 hover:to-purple-50"}`,children:e.jsxs("div",{className:"flex flex-col xl:flex-row justify-between items-start xl:items-center gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Ae(s.status),e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["Order #",s.order_number||s.id]}),s.status==="dispatched"&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(P,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Dispatched"})]})]}),e.jsx(D,{className:`text-sm font-semibold px-4 py-2 rounded-xl ${$e(s.status)}`,children:s.status.toUpperCase()}),s.requested_grade!=="any"&&e.jsxs(D,{variant:"secondary",className:"text-sm px-3 py-1 bg-indigo-100 text-indigo-700 rounded-xl",children:["Grade ",s.requested_grade]}),e.jsx(D,{variant:"outline",className:"text-sm px-3 py-1 bg-orange-100 text-orange-700 border-orange-200 rounded-xl",children:Te(s.requested_sizes||[])})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(rs,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:((t=s.outlet)==null?void 0:t.name)||"Unknown Outlet"}),e.jsx("div",{className:"text-sm text-gray-500",children:((a=s.outlet)==null?void 0:a.location)||"Unknown Location"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(Ks,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"text-sm font-medium",children:((n=s.outlet)==null?void 0:n.phone)||"Unknown Phone"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(Ne,{className:"h-5 w-5 text-purple-500"}),e.jsx("span",{className:"text-sm font-medium",children:new Date(s.order_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(_e,{className:"h-5 w-5 text-cyan-500"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.requested_quantity,"kg requested"]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-6 text-base text-gray-700",children:[e.jsxs("span",{className:"bg-gray-100 px-4 py-2 rounded-xl",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Sizes:"})," ",((d=s.requested_sizes)==null?void 0:d.join(", "))||"Any"]}),e.jsxs("span",{className:"bg-gray-100 px-4 py-2 rounded-xl",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Quantity:"})," ",s.requested_quantity,"kg"]}),e.jsxs("span",{className:"bg-gray-100 px-4 py-2 rounded-xl",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Price:"})," ",A(s.price_per_kg||0),"/kg"]})]}),s.notes&&e.jsxs("div",{className:"text-base text-gray-700 bg-gradient-to-r from-blue-50 to-purple-50 p-4 rounded-2xl border-l-4 border-blue-400",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Notes:"})," ",s.notes]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-4 min-w-fit",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:A(s.total_value)}),e.jsx("div",{className:"text-sm text-gray-500 font-medium",children:"Total Value"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>zs(s.id),className:"px-3 py-2 border-gray-300 hover:bg-gray-50",children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"View"]}),s.status==="pending"&&e.jsx(_,{size:"sm",onClick:()=>Ue(s.id),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2",children:"Confirm"}),s.status==="confirmed"&&e.jsxs(_,{size:"sm",onClick:()=>N("dispatch",s.id),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2",children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"View Dispatch"]})]})]})]})},s.id)})})})]})]}),e.jsx(de,{open:ds,onOpenChange:ue,children:e.jsxs(ce,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(oe,{children:[e.jsxs(me,{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(W,{className:"h-6 w-6 text-orange-600"}),"Pick Items from Inventory"]}),e.jsx(xe,{children:"Select items from available inventory to fulfill this order. Items will be deducted from inventory automatically."})]}),I&&e.jsxs("div",{className:"space-y-6 py-4",children:[(()=>{var t,a;const s=x.find(n=>n.id===I);return s?e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-xl border border-blue-200",children:[e.jsxs("h3",{className:"font-bold text-lg text-blue-900 mb-4 flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5"}),"Order Requirements"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Outlet:"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:((t=s.outlet)==null?void 0:t.name)||"Unknown Outlet"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Requested Quantity:"}),e.jsxs("span",{className:"text-gray-900 font-semibold",children:[s.requested_quantity,"kg"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Requested Sizes:"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:((a=s.requested_sizes)==null?void 0:a.join(", "))||"Any"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Grade:"}),e.jsxs(D,{className:s.requested_grade==="A"?"bg-green-100 text-green-800":s.requested_grade==="B"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",children:["Grade ",s.requested_grade]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Price per kg:"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:A(s.price_per_kg||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Total Value:"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:A(s.total_value)})]})]})]}):null})(),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold text-lg text-gray-900 flex items-center gap-2",children:[e.jsx(Ts,{className:"h-5 w-5 text-green-600"}),"Available Inventory"]}),(()=>{const s=x.find(n=>n.id===I);if(!s)return null;const a=Me(s).reduce((n,d)=>n+(d.total_quantity||0),0);return e.jsx("div",{className:"bg-green-50 px-3 py-1 rounded-full",children:e.jsxs("span",{className:"text-sm font-medium text-green-800",children:[a," pieces available"]})})})()]}),e.jsx("div",{className:"grid gap-4 max-h-96 overflow-y-auto",children:(()=>{const s=x.find(a=>a.id===I);if(!s)return null;const t=Me(s);return t.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(W,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No inventory items match the order requirements"})]}):t.map(a=>{var n;return e.jsx("div",{className:"border border-gray-200 rounded-xl p-4 bg-white hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 text-lg",children:["Size ",a.final_size||"Unknown"," Fish"]}),e.jsxs(D,{className:a.final_grade==="A"?"bg-green-100 text-green-800":a.final_grade==="B"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",children:["Grade ",a.final_grade||"Unknown"]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(W,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Available Quantity:"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-bold text-blue-900",children:[a.total_quantity||0," pieces"]}),e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["(",a.total_weight?a.total_weight.toFixed(1):"0.0"," kg)"]}),a.total_quantity&&a.total_quantity<=10&&e.jsx(D,{className:"bg-orange-100 text-orange-800 border-orange-200 text-xs",children:"Low Stock"})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(rs,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Storage Location:"})]}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:a.storage_location||"Processing Area"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-500 text-xs font-medium",children:"Processing Date"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:a.processing_date?new Date(a.processing_date).toLocaleDateString():"N/A"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-500 text-xs font-medium",children:"Farmer"}),e.jsx("span",{className:"text-gray-900 font-semibold truncate",children:a.farmer_name||"Unknown"})]})]})]}),e.jsx("div",{className:"flex items-center gap-3 ml-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{size:"sm",variant:"outline",onClick:()=>qs(a,1),className:"border-blue-200 text-blue-700 hover:bg-blue-50",children:e.jsx(Rs,{className:"h-4 w-4"})}),e.jsx("span",{className:"text-sm font-medium min-w-[2rem] text-center",children:((n=v.find(d=>d.inventoryItem.id===a.id))==null?void 0:n.quantity)||0}),e.jsx(_,{size:"sm",variant:"outline",onClick:()=>{const d=v.find(i=>i.inventoryItem.id===a.id);d&&d.quantity>0&&ks(a.id,d.quantity-1)},className:"border-blue-200 text-blue-700 hover:bg-blue-50",children:e.jsx(He,{className:"h-4 w-4"})})]})})]})},a.id)})})()})]}),v.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 p-6 rounded-xl border border-green-200",children:[e.jsxs("h3",{className:"font-bold text-lg text-green-900 mb-4 flex items-center gap-2",children:[e.jsx(P,{className:"h-5 w-5"}),"Selected Items Summary"]}),e.jsxs("div",{className:"space-y-3",children:[v.map(s=>e.jsxs("div",{className:"flex justify-between items-center bg-white p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:["Size ",s.inventoryItem.final_size||"Unknown"," - Grade ",s.inventoryItem.final_grade||"Unknown"]}),e.jsxs(D,{variant:"outline",className:"bg-blue-50 text-blue-700",children:[s.quantity," pieces"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[s.weight.toFixed(1),"kg"]}),e.jsx(_,{size:"sm",variant:"outline",onClick:()=>Le(s.inventoryItem.id),className:"border-red-200 text-red-700 hover:bg-red-50",children:e.jsx(He,{className:"h-4 w-4"})})]})]},s.inventoryItem.id)),e.jsx("div",{className:"border-t pt-3 mt-3",children:e.jsxs("div",{className:"flex justify-between items-center font-semibold text-green-900",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:[v.reduce((s,t)=>s+t.quantity,0)," pieces â€¢ "," ",v.reduce((s,t)=>s+t.weight,0).toFixed(1),"kg"]})]})})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-4 pt-4 border-t",children:[e.jsx(_,{variant:"outline",onClick:()=>{ue(!1),K([]),Ce(null)},className:"px-6 py-2",children:"Cancel"}),e.jsxs(_,{onClick:ws,disabled:v.length===0,className:"px-6 py-2 bg-orange-600 hover:bg-orange-700 text-white disabled:bg-gray-300 disabled:cursor-not-allowed",children:[e.jsx(Xe,{className:"h-4 w-4 mr-2"}),"Dispatch Order"]})]})]})]})}),e.jsx(de,{open:cs,onOpenChange:Q,children:e.jsxs(ce,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(oe,{children:[e.jsxs(me,{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(ve,{className:"h-6 w-6 text-blue-600"})}),"Order Details - ",(o==null?void 0:o.order_number)||(o==null?void 0:o.id)]}),e.jsx(xe,{className:"text-gray-600",children:"Complete information for this outlet order"})]}),o&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Ae(o.status),e.jsx(D,{className:`text-sm font-semibold px-4 py-2 rounded-xl ${$e(o.status)}`,children:o.status.toUpperCase()}),o.requested_grade!=="any"&&e.jsxs(D,{variant:"secondary",className:"text-sm px-3 py-1 bg-indigo-100 text-indigo-700 rounded-xl",children:["Grade ",o.requested_grade]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:A(o.total_value)}),e.jsx("div",{className:"text-sm text-gray-500 font-medium",children:"Total Value"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Order Date:"}),e.jsx("span",{className:"text-sm text-gray-900",children:new Date(o.order_date).toLocaleDateString()})]}),o.delivery_date&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Xe,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Delivery Date:"}),e.jsx("span",{className:"text-sm text-gray-900",children:new Date(o.delivery_date).toLocaleDateString()})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-4 w-4 text-cyan-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Quantity:"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[o.requested_quantity,"kg"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Hs,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Price per kg:"}),e.jsx("span",{className:"text-sm text-gray-900",children:A(o.price_per_kg||0)})]})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Xs,{className:"h-5 w-5 text-blue-600"}),"Outlet Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Outlet Name:"}),e.jsx("p",{className:"text-sm text-gray-900 font-semibold",children:((Be=o.outlet)==null?void 0:Be.name)||"Unknown Outlet"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Location:"}),e.jsx("p",{className:"text-sm text-gray-900",children:((Ve=o.outlet)==null?void 0:Ve.location)||"Unknown Location"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Phone:"}),e.jsx("p",{className:"text-sm text-gray-900",children:((We=o.outlet)==null?void 0:We.phone)||"Unknown Phone"})]}),((Ge=o.outlet)==null?void 0:Ge.manager_name)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Manager:"}),e.jsx("p",{className:"text-sm text-gray-900",children:o.outlet.manager_name})]})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(W,{className:"h-5 w-5 text-orange-600"}),"Order Specifications"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Requested Sizes:"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:o.requested_sizes&&o.requested_sizes.length>0?o.requested_sizes.map((s,t)=>e.jsxs(D,{variant:"outline",className:"bg-orange-50 text-orange-700 border-orange-200",children:["Size ",s]},t)):e.jsx(D,{variant:"outline",className:"bg-gray-50 text-gray-700",children:"Any Size"})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Grade Preference:"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:o.requested_grade==="any"?"Any Grade Available":`Grade ${o.requested_grade}`})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Quantity Breakdown:"}),e.jsxs("div",{className:"mt-2 bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Weight:"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[o.requested_quantity,"kg"]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Price per kg:"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:A(o.price_per_kg||0)})]}),e.jsxs("div",{className:"flex justify-between items-center mt-1 pt-2 border-t border-gray-200",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Value:"}),e.jsx("span",{className:"text-sm font-bold text-gray-900",children:A(o.total_value)})]})]})]})})]})]}),o.notes&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5 text-gray-600"}),"Order Notes"]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-gray-700",children:o.notes})})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[e.jsx(_,{variant:"outline",onClick:()=>Q(!1),className:"flex-1",children:"Close"}),o.status==="pending"&&e.jsx(_,{onClick:()=>{Ue(o.id),Q(!1)},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:"Confirm Order"}),o.status==="confirmed"&&e.jsxs(_,{onClick:()=>{N("dispatch",o.id),Q(!1)},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"View Dispatch"]}),o.status==="dispatched"&&e.jsxs(_,{onClick:()=>{N("dispatch",o.id),Q(!1)},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Check Dispatch Page"]})]})]})]})}),e.jsx(de,{open:ms,onOpenChange:te,children:e.jsxs(ce,{className:"max-w-2xl",children:[e.jsxs(oe,{children:[e.jsxs(me,{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(ls,{className:"h-6 w-6 text-blue-600"})}),"Confirm Order"]}),e.jsx(xe,{className:"text-gray-600",children:"Review and confirm this order. Select who is confirming and choose to approve or discard."})]}),j&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Order Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Order Number:"}),e.jsx("span",{className:"ml-2 font-medium",children:j.order_number||j.id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Outlet:"}),e.jsx("span",{className:"ml-2 font-medium",children:((Qe=B.find(s=>s.id===j.outlet_id))==null?void 0:Qe.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Quantity:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[j.requested_quantity," kg"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Total Value:"}),e.jsxs("span",{className:"ml-2 font-medium",children:["KES ",j.total_value.toLocaleString()]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{className:"text-sm font-medium text-gray-700",children:"Confirmed By"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(ls,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:(g==null?void 0:g.email)||"Current User"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Logged in user"})]})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{className:"text-sm font-medium text-gray-700",children:"Action *"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"approve",name:"action",value:"approve",checked:$.action==="approve",onChange:s=>re(t=>y(f({},t),{action:s.target.value})),className:"h-4 w-4 text-green-600"}),e.jsxs(C,{htmlFor:"approve",className:"flex items-center gap-2 text-green-700",children:[e.jsx(P,{className:"h-4 w-4"}),"Approve Order"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"discard",name:"action",value:"discard",checked:$.action==="discard",onChange:s=>re(t=>y(f({},t),{action:s.target.value})),className:"h-4 w-4 text-red-600"}),e.jsxs(C,{htmlFor:"discard",className:"flex items-center gap-2 text-red-700",children:[e.jsx(we,{className:"h-4 w-4"}),"Discard Order"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{className:"text-sm font-medium text-gray-700",children:"Notes (Optional)"}),e.jsx(ts,{placeholder:"Add any notes about this confirmation...",className:"h-20 resize-none",value:$.notes,onChange:s=>re(t=>y(f({},t),{notes:s.target.value}))})]})]}),e.jsxs(Ls,{className:"flex gap-3",children:[e.jsx(_,{variant:"outline",onClick:()=>te(!1),disabled:pe,className:"flex-1",children:"Cancel"}),e.jsx(_,{onClick:bs,disabled:pe,className:`flex-1 ${$.action==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"} text-white`,children:pe?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsx(e.Fragment,{children:$.action==="approve"?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"h-4 w-4 mr-2"}),"Approve Order"]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Discard Order"]})})})]})]})]})})]})}export{qt as default};
