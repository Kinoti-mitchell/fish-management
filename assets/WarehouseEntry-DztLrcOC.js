import{r as o,j as e,A as ne,i as de,B as m,X as oe,e as f,W as Le,C as Ke,F as h,L as x,I as V,a as C,b as S,P as me,k as Ve,f as Ae,g as Oe,l as y,E as J,s as A}from"./main-BRmubxtL.js";import{S as O,a as $,b as B,c as U,d}from"./select-D_9msCHQ.js";import{T as $e}from"./textarea-CoDOjvpH.js";import{D as xe,a as Be,b as he,c as ge,d as je}from"./dialog-Bz3ntVCz.js";import{getOrGenerateEntryCode as Ue,generateUniqueEntryCode as Re}from"./entryCodeGenerator-BVAMPRYr.js";import{C as _}from"./circle-check-big-CVxj8ACg.js";import{P as G}from"./plus-Cm8XecHb.js";import{U as Q}from"./user-DusSpbgZ.js";import{M as ze}from"./map-pin-DsS6pfgm.js";import{W as X}from"./weight-7gXMaHKE.js";import{D as Y}from"./dollar-sign-Bm_RG5x9.js";import{L as ue}from"./loader-circle-XFWPD9vU.js";import{T as Me}from"./trending-up-D64eRXVq.js";import{S as pe}from"./search-DVFYlh63.js";import{D as fe}from"./download-ucN2QySw.js";import{C as qe}from"./index-CRLLa29k.js";import{C as Ne}from"./calendar-CRgHfV5n.js";import"./index-D-ZiJKjQ.js";import"./index-DdgTQUhj.js";function gs({onNavigate:ve}){const[N,R]=o.useState([]),[P,Z]=o.useState([]),[be,E]=o.useState(!1),[we,He]=o.useState(!1),[z,ee]=o.useState(!1),[se,F]=o.useState(null),[ae,T]=o.useState(null),[t,v]=o.useState({farmerId:"",totalWeight:"",totalPieces:"",pricePerKg:"",condition:"",fishType:"",notes:""}),[l,p]=o.useState({}),[k,te]=o.useState(""),[W,re]=o.useState("all"),[M,ye]=o.useState(!0),[g,D]=o.useState(null),[I,Ce]=o.useState(new Set),[L,Se]=o.useState(!0),_e=s=>{switch(s){case"excellent":return"excellent";case"good":return"good";case"fair":return"fair";default:return"good"}},le=s=>{switch(s){case"excellent":return"excellent";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"good"}},Pe=s=>{const a=P.find(i=>i.id===s);return a?a.name:`Farmer ID: ${s}`},Ee=s=>{const a=s.reduce((i,c)=>{const r=c.farmer_id;return i[r]||(i[r]={farmer:P.find(n=>n.id===r)||{id:r,name:`Farmer ID: ${r}`,location:"Unknown"},entries:[],totalWeight:0,totalValue:0,totalPieces:0,entryCount:0}),i[r].entries.push(c),i[r].totalWeight+=c.total_weight,i[r].totalValue+=c.total_value,i[r].totalPieces+=c.total_pieces,i[r].entryCount+=1,i},{});return Object.values(a).sort((i,c)=>c.totalValue-i.totalValue)},ke=s=>{const a=new Set(I);a.has(s)?a.delete(s):a.add(s),Ce(a)},Fe=async()=>{try{const{data:s,error:a}=await A.from("farmers").select("*").eq("status","active").order("name");if(a)throw a;Z(s||[])}catch{Z([])}},Te=async()=>{try{const{data:s,error:a}=await A.from("warehouse_entries").select(`
          *,
          farmers!inner(name)
        `).order("created_at",{ascending:!1}).limit(20);if(a)throw a;const i=await Promise.all((s||[]).map(async c=>{const r=c.entry_code||await Ue(c.id);return{...c,farmer_name:c.farmers?.name||`Farmer ID: ${c.farmer_id}`,entry_code:r}}));R(i)}catch{R([])}};o.useEffect(()=>{Fe(),Te()},[]);const We=()=>{const s={};return t.farmerId||(s.farmerId="Please select a farmer"),(!t.totalWeight||parseFloat(t.totalWeight)<=0)&&(s.totalWeight="Please enter a valid weight"),(!t.totalPieces||parseInt(t.totalPieces)<=0)&&(s.totalPieces="Please enter valid number of pieces"),(!t.pricePerKg||parseFloat(t.pricePerKg)<=0)&&(s.pricePerKg="Please enter a valid price per kg"),t.condition||(s.condition="Please select a grade/condition"),t.fishType||(s.fishType="Please select a fish type"),p(s),Object.keys(s).length===0},De=async(s,a,i,c,r)=>{try{const n=JSON.parse(sessionStorage.getItem("currentUser")||"null");if(!n)return;const j={user_id:n.id,action:s,table_name:a,record_id:i,old_values:c?JSON.stringify(c):null,new_values:r?JSON.stringify(r):null,ip_address:null,user_agent:navigator.userAgent,created_at:new Date().toISOString()},{error:w}=await A.from("audit_logs").insert([j]);w&&console.warn("Failed to log audit event:",w)}catch(n){console.warn("Failed to log audit event:",n)}},Ie=async()=>{if(We()){ee(!0),F(null),T(null);try{const s=P.find(w=>w.id.toString()===t.farmerId||w.id===parseInt(t.farmerId));if(!s)throw new Error("Selected farmer not found");const a=parseFloat(t.totalWeight),i=parseFloat(t.pricePerKg),c=await Re(),r={entry_date:new Date().toISOString().split("T")[0],total_weight:a,total_pieces:parseInt(t.totalPieces),condition:_e(t.condition),fish_type:t.fishType,farmer_id:s.id,price_per_kg:i,total_value:a*i,notes:t.notes.trim()||"",entry_code:c},{data:n,error:j}=await A.from("warehouse_entries").insert([r]).select();if(j)throw j;n&&n.length>0&&(R(w=>[n[0],...w]),await De("INSERT","warehouse_entries",n[0].id,null,r)),v({farmerId:"",totalWeight:"",totalPieces:"",pricePerKg:"",condition:"",fishType:"",notes:""}),p({}),E(!1),T("Entry recorded successfully!"),setTimeout(()=>T(null),3e3)}catch(s){F("Failed to save entry: "+s.message)}finally{ee(!1)}}},q=s=>{switch(le(s)){case"excellent":return"bg-emerald-100 text-emerald-800 border-emerald-300";case"good":return"bg-blue-100 text-blue-800 border-blue-300";case"fair":return"bg-amber-100 text-amber-800 border-amber-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},ie=s=>{switch(le(s)){case"excellent":case"good":return e.jsx(_,{className:"h-4 w-4 text-green-600"});case"fair":return e.jsx(f,{className:"h-4 w-4 text-amber-600"});default:return e.jsx(_,{className:"h-4 w-4 text-gray-600"})}},u=s=>`KES ${s.toLocaleString()}`,H=s=>new Date(s).toLocaleDateString("en-KE",{year:"numeric",month:"short",day:"numeric"}),b=N.filter(s=>{const a=s.farmer_name?.toLowerCase().includes(k.toLowerCase())||s.entry_code?.toLowerCase().includes(k.toLowerCase())||s.notes?.toLowerCase().includes(k.toLowerCase()),i=W==="all"||s.condition===W;return a&&i}),K=(()=>{const s=N.reduce((n,j)=>n+j.total_weight,0),a=N.reduce((n,j)=>n+j.total_value,0),i=N.reduce((n,j)=>n+j.total_pieces,0),c=N.length>0?a/s:0,r=N.reduce((n,j)=>(n[j.condition]=(n[j.condition]||0)+1,n),{});return{totalWeight:s,totalValue:a,totalPieces:i,avgPricePerKg:c,conditionCounts:r,totalEntries:N.length}})(),ce=()=>{const s=[["Entry Code","Date","Farmer","Weight (kg)","Pieces","Price/kg","Total Value","Condition","Notes"],...b.map(r=>[r.entry_code||"",r.entry_date,r.farmer_name||"",r.total_weight,r.total_pieces,r.price_per_kg,r.total_value,r.condition,r.notes||""])].map(r=>r.join(",")).join(`
`),a=new Blob([s],{type:"text/csv"}),i=window.URL.createObjectURL(a),c=document.createElement("a");c.href=i,c.download=`warehouse-entries-${new Date().toISOString().split("T")[0]}.csv`,c.click(),window.URL.revokeObjectURL(i)};return e.jsx("div",{className:"min-h-screen bg-gray-50 content-container responsive-padding",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[ae&&e.jsxs(ne,{className:"border-green-200 bg-green-50 text-green-800",children:[e.jsx(_,{className:"h-4 w-4"}),e.jsx(de,{children:ae}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>T(null),className:"ml-auto h-6 w-6 p-0",children:e.jsx(oe,{className:"h-4 w-4"})})]}),se&&e.jsxs(ne,{className:"border-red-200 bg-red-50 text-red-800",children:[e.jsx(f,{className:"h-4 w-4"}),e.jsx(de,{children:se}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>F(null),className:"ml-auto h-6 w-6 p-0",children:e.jsx(oe,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(Le,{className:"h-8 w-8 text-blue-600"}),"Warehouse Entry"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track fish deliveries and manage inventory"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(m,{variant:"outline",onClick:()=>ye(!M),children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),M?"Hide Stats":"Show Stats"]}),e.jsx(m,{variant:"outline",onClick:()=>ve("dashboard"),children:"Dashboard"}),e.jsxs(xe,{open:be,onOpenChange:E,children:[e.jsx(Be,{asChild:!0,children:e.jsxs(m,{className:"bg-blue-600 hover:bg-blue-700 text-white",size:"lg",children:[e.jsx(G,{className:"h-5 w-5 mr-2"}),"New Entry"]})}),e.jsxs(he,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ge,{children:[e.jsxs(je,{className:"text-2xl flex items-center gap-3",children:[e.jsx(h,{className:"h-6 w-6 text-blue-600"}),"Record New Warehouse Entry"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Enter details for a new fish delivery from a farmer to the warehouse."})]}),e.jsxs("div",{className:"space-y-6 py-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),"Select Farmer *"]}),e.jsxs(O,{value:t.farmerId,onValueChange:s=>{v({...t,farmerId:s}),l.farmerId&&p({...l,farmerId:""})},children:[e.jsx($,{className:`h-12 ${l.farmerId?"border-red-300 focus:border-red-500":""}`,children:e.jsx(B,{placeholder:"Choose a farmer..."})}),e.jsx(U,{children:P.length>0?P.map(s=>e.jsx(d,{value:s.id.toString(),children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[e.jsx(ze,{className:"h-3 w-3"}),s.location]})]})})},s.id)):e.jsx(d,{value:"no-farmers",disabled:!0,children:"No active farmers found"})})]}),l.farmerId&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(f,{className:"h-3 w-3"}),l.farmerId]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(X,{className:"h-4 w-4"}),"Total Weight (kg) *"]}),e.jsx(V,{type:"number",step:"0.1",placeholder:"e.g. 150.5",value:t.totalWeight,onChange:s=>{v({...t,totalWeight:s.target.value}),l.totalWeight&&p({...l,totalWeight:""})},className:`h-12 ${l.totalWeight?"border-red-300 focus:border-red-500":""}`}),l.totalWeight&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(f,{className:"h-3 w-3"}),l.totalWeight]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),"Number of Pieces *"]}),e.jsx(V,{type:"number",placeholder:"e.g. 75",value:t.totalPieces,onChange:s=>{v({...t,totalPieces:s.target.value}),l.totalPieces&&p({...l,totalPieces:""})},className:`h-12 ${l.totalPieces?"border-red-300 focus:border-red-500":""}`}),l.totalPieces&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(f,{className:"h-3 w-3"}),l.totalPieces]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(Y,{className:"h-4 w-4"}),"Price per kg (KES) *"]}),e.jsx(V,{type:"number",placeholder:"e.g. 450",value:t.pricePerKg,onChange:s=>{v({...t,pricePerKg:s.target.value}),l.pricePerKg&&p({...l,pricePerKg:""})},className:`h-12 ${l.pricePerKg?"border-red-300 focus:border-red-500":""}`}),l.pricePerKg&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(f,{className:"h-3 w-3"}),l.pricePerKg]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(x,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4"}),"Fish Type *"]}),e.jsxs(O,{value:t.fishType,onValueChange:s=>{v({...t,fishType:s}),l.fishType&&p({...l,fishType:""})},children:[e.jsx($,{className:`h-12 ${l.fishType?"border-red-300 focus:border-red-500":""}`,children:e.jsx(B,{placeholder:"Select fish type..."})}),e.jsxs(U,{children:[e.jsx(d,{value:"Nile Tilapia",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-blue-600"}),"Nile Tilapia (0.35kg avg)"]})}),e.jsx(d,{value:"Nile Perch",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-green-600"}),"Nile Perch (1.20kg avg)"]})}),e.jsx(d,{value:"African Catfish",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-purple-600"}),"African Catfish (0.65kg avg)"]})}),e.jsx(d,{value:"Silver Cyprinid",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-gray-600"}),"Silver Cyprinid (0.15kg avg)"]})}),e.jsx(d,{value:"African Lungfish",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-orange-600"}),"African Lungfish (0.80kg avg)"]})}),e.jsx(d,{value:"Blue-spotted Tilapia",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-cyan-600"}),"Blue-spotted Tilapia (0.30kg avg)"]})}),e.jsx(d,{value:"Marbled Lungfish",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-red-600"}),"Marbled Lungfish (0.75kg avg)"]})}),e.jsx(d,{value:"Electric Catfish",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-yellow-600"}),"Electric Catfish (0.55kg avg)"]})}),e.jsx(d,{value:"Mixed Batch",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-indigo-600"}),"Mixed Batch (0.50kg avg)"]})})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Select the primary fish type. This helps with accurate processing and sorting."}),l.fishType&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(f,{className:"h-3 w-3"}),l.fishType]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(x,{className:"text-base font-medium",children:"Grade/Quality *"}),e.jsxs(O,{value:t.condition,onValueChange:s=>{v({...t,condition:s}),l.condition&&p({...l,condition:""})},children:[e.jsx($,{className:`h-12 ${l.condition?"border-red-300 focus:border-red-500":""}`,children:e.jsx(B,{placeholder:"Select quality grade..."})}),e.jsxs(U,{children:[e.jsx(d,{value:"excellent",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-green-600"}),"Excellent (Grade A)"]})}),e.jsx(d,{value:"good",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"h-4 w-4 text-blue-600"}),"Good (Grade B)"]})}),e.jsx(d,{value:"fair",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{className:"h-4 w-4 text-amber-600"}),"Fair (Grade C)"]})})]})]}),l.condition&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(f,{className:"h-3 w-3"}),l.condition]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(x,{className:"text-base font-medium",children:"Additional Notes"}),e.jsx($e,{placeholder:"Any special notes about this delivery...",value:t.notes,onChange:s=>v({...t,notes:s.target.value}),className:"h-12 min-h-[48px]"})]})]}),t.totalWeight&&t.pricePerKg&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"text-sm text-blue-700 mb-1",children:"Total Value"}),e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:u(parseFloat(t.totalWeight)*parseFloat(t.pricePerKg))})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t",children:[e.jsx(m,{variant:"outline",onClick:()=>{E(!1),p({}),F(null)},disabled:z,children:"Cancel"}),e.jsx(m,{onClick:Ie,disabled:z,className:"bg-blue-600 hover:bg-blue-700",children:z?e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"h-4 w-4 mr-2 animate-spin"}),"Recording..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Record Entry"]})})]})]})]})]})]})]}),M&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(C,{children:e.jsx(S,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Weight"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[K.totalWeight.toFixed(1)," kg"]})]}),e.jsx(X,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(C,{children:e.jsx(S,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Value"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u(K.totalValue)})]}),e.jsx(Y,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(C,{children:e.jsx(S,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Pieces"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:K.totalPieces.toLocaleString()})]}),e.jsx(me,{className:"h-8 w-8 text-purple-600"})]})})}),e.jsx(C,{children:e.jsx(S,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Price/kg"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u(K.avgPricePerKg)})]}),e.jsx(Me,{className:"h-8 w-8 text-orange-600"})]})})})]}),e.jsx(C,{children:e.jsx(S,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(pe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(V,{placeholder:"Search entries by farmer, code, or notes...",value:k,onChange:s=>te(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(O,{value:W,onValueChange:re,children:[e.jsxs($,{className:"w-40",children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),e.jsx(B,{placeholder:"Filter by condition"})]}),e.jsxs(U,{children:[e.jsx(d,{value:"all",children:"All Conditions"}),e.jsx(d,{value:"excellent",children:"Excellent"}),e.jsx(d,{value:"good",children:"Good"}),e.jsx(d,{value:"fair",children:"Fair"})]})]}),e.jsxs(m,{variant:L?"default":"outline",size:"sm",onClick:()=>Se(!L),className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-4 w-4"}),L?"Group by Farmer":"List View"]}),e.jsxs(m,{variant:"outline",onClick:ce,disabled:b.length===0,children:[e.jsx(fe,{className:"h-4 w-4 mr-2"}),"Export"]})]})]})})}),e.jsxs(C,{children:[e.jsx(Ae,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Oe,{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-5 w-5 text-blue-600"}),"Warehouse Entries",e.jsxs(y,{variant:"secondary",children:[b.length," of ",N.length," entries"]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(m,{variant:"outline",size:"sm",onClick:ce,disabled:b.length===0,children:[e.jsx(fe,{className:"h-4 w-4 mr-1"}),"Export"]})})]})}),e.jsx(S,{children:we?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(ue,{className:"h-8 w-8 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading entries..."})]}):b.length>0?L?e.jsx("div",{className:"space-y-4",children:Ee(b).map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 p-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>ke(s.farmer.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.farmer.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.farmer.location})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(me,{className:"h-4 w-4"}),s.entryCount," entries"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"h-4 w-4"}),s.totalWeight.toFixed(1),"kg"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Y,{className:"h-4 w-4"}),u(s.totalValue)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{variant:"outline",className:"text-xs",children:I.has(s.farmer.id)?"Collapse":"Expand"}),e.jsx(qe,{className:`h-4 w-4 text-gray-400 transition-transform ${I.has(s.farmer.id)?"rotate-180":""}`})]})]})}),I.has(s.farmer.id)&&e.jsx("div",{className:"divide-y divide-gray-100",children:s.entries.map(a=>e.jsxs("div",{className:"p-4 hover:bg-gray-50 transition-colors bg-white",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[ie(a.condition),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"h-3 w-3"}),H(a.entry_date)]}),e.jsx(y,{variant:"outline",className:"font-medium",children:a.entry_code})]})})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsx(y,{className:`${q(a.condition)} border`,children:a.condition}),e.jsxs("span",{className:"text-gray-600",children:[a.total_weight,"kg • ",a.total_pieces," pieces"]}),e.jsxs("span",{className:"text-gray-600",children:[u(a.price_per_kg),"/kg"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold text-gray-900 mb-2",children:u(a.total_value)}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(m,{size:"sm",variant:"outline",onClick:()=>D(a),children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),"View"]})})]})]}),a.notes&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded text-sm text-gray-600",children:[e.jsx("strong",{children:"Notes:"})," ",a.notes]})]},a.id))})]},s.farmer.id))}):e.jsx("div",{className:"divide-y divide-gray-100",children:b.map(s=>e.jsxs("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[ie(s.condition),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Pe(s.farmer_id)}),e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-500 mt-1",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ne,{className:"h-3 w-3"}),H(s.entry_date)]})})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsx(y,{variant:"outline",className:"font-medium",children:s.entry_code}),e.jsx(y,{className:`${q(s.condition)} border`,children:s.condition}),e.jsxs("span",{className:"text-gray-600",children:[s.total_weight,"kg • ",s.total_pieces," pieces"]}),e.jsxs("span",{className:"text-gray-600",children:[u(s.price_per_kg),"/kg"]}),e.jsxs("span",{className:"text-gray-600 font-medium",children:["• ",s.farmer_name]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-3",children:u(s.total_value)}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(m,{size:"sm",variant:"outline",onClick:()=>D(s),children:[e.jsx(J,{className:"h-3 w-3 mr-1"}),"View"]})})]})]}),s.notes&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded text-sm text-gray-600",children:[e.jsx("strong",{children:"Notes:"})," ",s.notes]})]},s.id))}):k||W!=="all"?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(pe,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No entries match your search"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Try adjusting your search or filter criteria"}),e.jsxs("div",{className:"mt-4 flex gap-2 justify-center",children:[e.jsx(m,{variant:"outline",onClick:()=>{te(""),re("all")},children:"Clear Filters"}),e.jsxs(m,{onClick:()=>E(!0),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"New Entry"]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(h,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No warehouse entries yet"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Start by recording your first fish delivery"}),e.jsxs(m,{onClick:()=>E(!0),className:"mt-4 bg-blue-600 hover:bg-blue-700",size:"lg",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"Record First Entry"]})]})})]}),e.jsx(xe,{open:!!g,onOpenChange:()=>D(null),children:e.jsxs(he,{className:"max-w-2xl",children:[e.jsx(ge,{children:e.jsxs(je,{className:"flex items-center gap-2",children:[e.jsx(J,{className:"h-5 w-5 text-blue-600"}),"Entry Details"]})}),g&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{className:"text-sm font-medium text-gray-500",children:"Entry Code"}),e.jsx("p",{className:"text-lg font-semibold",children:g.entry_code})]}),e.jsxs("div",{children:[e.jsx(x,{className:"text-sm font-medium text-gray-500",children:"Date"}),e.jsx("p",{className:"text-lg font-semibold",children:H(g.entry_date)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{className:"text-sm font-medium text-gray-500",children:"Farmer"}),e.jsx("p",{className:"text-lg font-semibold",children:g.farmer_name})]}),e.jsxs("div",{children:[e.jsx(x,{className:"text-sm font-medium text-gray-500",children:"Condition"}),e.jsx(y,{className:`${q(g.condition)} border`,children:g.condition})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{className:"text-sm font-medium text-gray-500",children:"Weight"}),e.jsxs("p",{className:"text-lg font-semibold",children:[g.total_weight," kg"]})]}),e.jsxs("div",{children:[e.jsx(x,{className:"text-sm font-medium text-gray-500",children:"Pieces"}),e.jsx("p",{className:"text-lg font-semibold",children:g.total_pieces})]}),e.jsxs("div",{children:[e.jsx(x,{className:"text-sm font-medium text-gray-500",children:"Price/kg"}),e.jsx("p",{className:"text-lg font-semibold",children:u(g.price_per_kg)})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx(x,{className:"text-sm font-medium text-gray-500",children:"Total Value"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:u(g.total_value)})]}),g.notes&&e.jsxs("div",{children:[e.jsx(x,{className:"text-sm font-medium text-gray-500",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded",children:g.notes})]}),e.jsx("div",{className:"flex justify-end gap-2 pt-4 border-t",children:e.jsx(m,{variant:"outline",onClick:()=>D(null),children:"Close"})})]})]})})]})})}export{gs as default};
