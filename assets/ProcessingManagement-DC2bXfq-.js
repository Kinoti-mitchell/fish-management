const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/entryCodeGenerator-DdMp6m9O.js","assets/main-DSup42DO.js","assets/main-c8IhzymI.css"])))=>i.map(i=>d[i]);
import{r as h,j as e,d as M,B as f,H as ve,a as u,f as F,g as L,C as me,b as C,l as p,E as le,P as V,s as W,_ as Ce,L as O,I as Y}from"./main-DSup42DO.js";import{S as Se,a as Pe,b as ke,c as De,d as J}from"./select-JcD96R-n.js";import{D as ce,a as Ae,b as oe,c as de,d as xe}from"./dialog-CARo6Rko.js";import{getOrGenerateEntryCode as Re,getOrGenerateProcessingCode as We}from"./entryCodeGenerator-DdMp6m9O.js";import{R as X}from"./refresh-cw-DpzMwsnQ.js";import{P as Te}from"./plus-sv7jvrZ1.js";import{T as ge}from"./trending-up-B2JkKUCM.js";import{S as Fe}from"./star-CeOKYYr1.js";import{C as Le}from"./clock-DSBTPoJF.js";import{M as Z}from"./map-pin-DgzEl8ww.js";import{C as he}from"./calendar-jX6YR94c.js";import{C as pe}from"./circle-alert-BqZYLxog.js";import{S as Oe}from"./scale-CCjVAmZH.js";import{W as ze}from"./weight-BZkQDAgF.js";import{C as Be}from"./circle-check-big-CQh1-QOa.js";import"./index-I4apKRuN.js";import"./index-e-y2qn7X.js";import"./index-B45oUSAH.js";const E=a=>({A:"bg-green-500",B:"bg-yellow-500",C:"bg-orange-500"})[a]||"bg-gray-500",U=a=>a>=80?"text-green-600":a>=70?"text-yellow-600":"text-red-600",Ge=({data:a,dataKey:l})=>{if(!a||a.length===0)return e.jsx("div",{className:"flex items-center justify-center h-32 text-gray-500",children:"No data available"});const o=Math.max(...a.map(n=>n[l]||0));return e.jsx("div",{className:"flex items-end justify-between h-32 gap-1",children:a.map((n,x)=>e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:"bg-blue-500 rounded-t w-full min-h-[4px]",style:{height:`${o>0?(n[l]||0)/o*100:0}%`}}),e.jsx("span",{className:"text-xs text-gray-600 mt-1 text-center",children:n.date?new Date(n.date).getDate():x+1})]},x))})},$e=({data:a,dataKey:l})=>{if(!a||a.length===0)return e.jsx("div",{className:"flex items-center justify-center h-32 text-gray-500",children:"No data available"});const o=a.map(S=>S[l]||0),n=Math.max(...o),x=Math.min(...o),w=n-x||1;return e.jsx("div",{className:"relative h-32",children:e.jsxs("svg",{width:"100%",height:"100%",className:"overflow-visible",children:[e.jsx("polyline",{fill:"none",stroke:"#8b5cf6",strokeWidth:"2",points:a.map((S,P)=>{const _=a.length>1?P/(a.length-1)*100:50,y=100-((S[l]||0)-x)/w*80,v=isNaN(y)?50:Math.max(0,Math.min(100,y));return`${_},${v}`}).join(" ")}),a.map((S,P)=>{const _=a.length>1?P/(a.length-1)*100:50,y=100-((S[l]||0)-x)/w*80,v=isNaN(y)?50:Math.max(0,Math.min(100,y));return e.jsx("circle",{cx:`${_}%`,cy:`${v}%`,r:"3",fill:"#8b5cf6"},P)})]})})},Me=({stats:a,processingRecords:l})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[e.jsx(u,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm",children:"Ready for Processing"}),e.jsx("p",{className:"text-3xl font-bold",children:a.readyForProcessing})]}),e.jsx(pe,{className:"h-8 w-8 text-blue-200"})]})})}),e.jsx(u,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white",children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm",children:"Total Processed"}),e.jsx("p",{className:"text-3xl font-bold",children:a.totalProcessed})]}),e.jsx(Be,{className:"h-8 w-8 text-green-200"})]})})}),e.jsx(u,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm",children:"Average Yield"}),e.jsxs("p",{className:"text-3xl font-bold",children:[a.averageYield,"%"]})]}),e.jsx(ge,{className:"h-8 w-8 text-purple-200"})]})})}),e.jsx(u,{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:e.jsx(C,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-sm",children:"Total Waste"}),e.jsxs("p",{className:"text-3xl font-bold",children:[a.totalWaste,"kg"]})]}),e.jsx(me,{className:"h-8 w-8 text-orange-200"})]})})})]}),Ye=({selectedEntryId:a,setSelectedEntryId:l,warehouseEntries:o,processingRecords:n,formData:x,setFormData:w,selectedStorage:S,setSelectedStorage:P,storageLocations:_,isProcessing:N,onSubmit:y,onClose:v})=>{const T=o.filter(t=>!a||t.id===a).filter(t=>!n.some(c=>c.warehouse_entry_id===t.id)),z=(t,c)=>{w({...x,[t]:c})};return a?e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-1",children:"Selected Entry"}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(p,{variant:"outline",className:"bg-white",children:o.find(t=>t.id===a)?.entry_code}),e.jsxs("span",{className:"text-blue-700",children:[o.find(t=>t.id===a)?.total_weight,"kg - ",o.find(t=>t.id===a)?.total_pieces," pieces"]}),e.jsxs("span",{className:"text-blue-600",children:["â€¢ ",o.find(t=>t.id===a)?.farmer_name]})]})]}),e.jsx(f,{variant:"outline",size:"sm",onClick:()=>{l(""),w({})},children:"Change Entry"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{className:"text-sm font-medium",children:"Pre-Processing Weight (kg)"}),e.jsx(Y,{type:"number",value:o.find(t=>t.id===a)?.total_weight||"",readOnly:!0,className:"bg-gray-50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{className:"text-sm font-medium",children:"Post-Processing Weight (kg) *"}),e.jsx(Y,{type:"number",step:"0.1",value:x.post_processing_weight||"",onChange:t=>z("post_processing_weight",Number(t.target.value)),placeholder:"Enter weight after processing"})]})]}),x.post_processing_weight&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Processing Calculations"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Processing Waste"}),e.jsxs("p",{className:"text-xl font-bold text-red-600",children:[x.processing_waste||0,"kg"]})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Processing Yield"}),e.jsxs("p",{className:`text-xl font-bold ${U(x.processing_yield||0)}`,children:[x.processing_yield||0,"%"]})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Weight Loss"}),e.jsxs("p",{className:"text-xl font-bold text-orange-600",children:[((x.processing_waste||0)/(o.find(t=>t.id===a)?.total_weight||1)*100).toFixed(1),"%"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{className:"text-sm font-medium",children:"Number of Fish"}),e.jsx(Y,{type:"number",value:o.find(t=>t.id===a)?.total_pieces||"",readOnly:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Inherited from warehouse entry"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{className:"text-sm font-medium",children:"Final Grade *"}),e.jsxs(Se,{value:x.final_grade||"",onValueChange:t=>z("final_grade",t),children:[e.jsx(Pe,{children:e.jsx(ke,{placeholder:"Select grade"})}),e.jsxs(De,{children:[e.jsx(J,{value:"A",children:"Grade A"}),e.jsx(J,{value:"B",children:"Grade B"}),e.jsx(J,{value:"C",children:"Grade C"})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Size classification will be determined during sorting process"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(O,{className:"text-sm font-medium",children:"Fish Type"}),e.jsx(Y,{value:o.find(t=>t.id===a)?.fish_type||"Not specified",readOnly:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Inherited from warehouse entry"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(V,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Next Step: Sorting"}),e.jsx("p",{className:"text-sm text-blue-700",children:"After processing, fish will be sorted into size classes and assigned to storage locations."})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(f,{variant:"outline",onClick:v,children:"Cancel"}),e.jsx(f,{onClick:y,className:"bg-blue-600 hover:bg-blue-700",disabled:!x.post_processing_weight||!x.final_grade||N,children:N?e.jsxs(e.Fragment,{children:[e.jsx(X,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):"Complete Processing"})]})]})]}):e.jsxs("div",{className:"py-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(V,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Select Warehouse Entry"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Choose a warehouse entry to begin processing"})]}),T.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(pe,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No Entries Available"}),e.jsx("p",{className:"text-sm text-gray-400",children:o.length===0?"No warehouse entries found":"All warehouse entries have been processed"}),o.length>0&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:o.length})," total warehouse entries exist,",e.jsxs("strong",{children:[" ",n.length]})," have been processed"]})})]}):e.jsx("div",{className:"space-y-3",children:T.map(t=>e.jsx(u,{className:"p-4 hover:shadow-md transition-all duration-200 cursor-pointer border hover:border-blue-300",onClick:()=>l(t.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(Oe,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(p,{variant:"outline",className:"font-medium",children:t.entry_code}),e.jsxs(p,{className:"bg-green-500 text-white font-medium",children:[t.total_pieces," pieces"]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ze,{className:"h-4 w-4"}),t.total_weight,"kg"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(he,{className:"h-4 w-4"}),new Date(t.entry_date).toLocaleDateString()]}),e.jsxs("span",{className:"flex items-center gap-1 font-medium text-gray-900",children:[e.jsx(Z,{className:"h-4 w-4"}),t.farmer_name]})]})]})]}),e.jsx(f,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:c=>{c.stopPropagation(),l(t.id)},children:"Select"})]})},t.id))}),e.jsxs("div",{className:"flex justify-between pt-6 border-t mt-6",children:[e.jsxs(f,{variant:"outline",onClick:()=>{window.location.reload()},className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[e.jsx(X,{className:"h-4 w-4 mr-2"}),"Refresh Entries"]}),e.jsx(f,{variant:"outline",onClick:v,children:"Cancel"})]})]})};function ls({onNavigate:a}){const[l,o]=h.useState([]),[n,x]=h.useState([]),[w,S]=h.useState([]),[P,_]=h.useState([]),[N,y]=h.useState(""),[v,T]=h.useState(""),[z,t]=h.useState(!1),[c,je]=h.useState(null),[fe,I]=h.useState(!1),[K,ee]=h.useState(!1),[se,q]=h.useState(!1),[ae,te]=h.useState(!1),[g,B]=h.useState({}),[D,ue]=h.useState({totalProcessed:0,readyForProcessing:0,averageYield:0,totalWaste:0,gradeDistribution:{A:0,B:0,C:0},weeklyProcessing:[],yieldTrends:[]}),ie=async()=>{const{data:s,error:i}=await W.from("warehouse_entries").select(`
        *,
        farmers!inner(name)
      `).order("entry_date",{ascending:!1});if(i)console.error("Error fetching warehouse entries:",i.message);else{const j=await Promise.all((s||[]).map(async d=>{const b=d.entry_code||await Re(d.id);return{...d,farmer_name:d.farmers?.name||`Farmer ID: ${d.farmer_id}`,entry_code:b}}));o(j)}},G=async()=>{const{data:s,error:i}=await W.from("processing_records").select(`
        *,
        warehouse_entries!inner(
          id,
          farmer_id,
          farmers!inner(name)
        )
      `).order("processing_date",{ascending:!1});if(i)console.error("Error fetching processing records:",i.message);else{const j=await Promise.all((s||[]).map(async d=>{const b=d.grading_results||{},R=d.size_distribution||{},k=Object.keys(b)[0]||"A";Object.keys(R)[0];const r=d.processing_code||await We(d.id);return{...d,farmer_name:d.warehouse_entries?.farmers?.name||"Unknown Farmer",final_grade:k,final_size:null,storage_location:"Not specified",ready_for_dispatch:!1,processing_code:r}}));x(j),S(j.slice(0,5))}},re=async()=>{try{const{data:s,error:i}=await W.from("storage_locations").select("*").eq("status","active").order("name");if(i)console.warn("Storage locations table not found, using default locations:",i.message),_([{id:"1",name:"Cold Storage A",capacity:2e3},{id:"2",name:"Cold Storage B",capacity:1500},{id:"3",name:"Freezer Unit 1",capacity:1e3},{id:"4",name:"Processing Area 1",capacity:500},{id:"5",name:"Processing Area 2",capacity:500}]);else{const{data:j,error:d}=await W.from("processing_records").select("post_processing_weight"),b=new Map;if(j&&!d){const m=j.reduce((A,$)=>A+($.post_processing_weight||0),0)/(s?.length||1);s?.forEach(A=>{b.set(A.name,m)})}const k=(s?.map(r=>({id:r.id,name:r.name,capacity:r.capacity_kg,currentUsage:b.get(r.name)||0,availableCapacity:r.capacity_kg-(b.get(r.name)||0)}))||[]).filter(r=>r.availableCapacity>0);k.length===0?(console.warn("No available storage locations found, using defaults"),_([{id:"1",name:"Cold Storage A",capacity:2e3},{id:"2",name:"Cold Storage B",capacity:1500},{id:"3",name:"Freezer Unit 1",capacity:1e3},{id:"4",name:"Processing Area 1",capacity:500},{id:"5",name:"Processing Area 2",capacity:500}])):_(k)}}catch(s){console.warn("Error fetching storage locations, using defaults:",s),_([{id:"1",name:"Cold Storage A",capacity:2e3},{id:"2",name:"Cold Storage B",capacity:1500},{id:"3",name:"Freezer Unit 1",capacity:1e3},{id:"4",name:"Processing Area 1",capacity:500},{id:"5",name:"Processing Area 2",capacity:500}])}},Ne=async()=>{ee(!0);try{await Promise.all([ie(),G(),re()])}finally{ee(!1)}},be=()=>{const s=l.filter(r=>!n.some(m=>m.warehouse_entry_id===r.id)).length,i=n.reduce((r,m)=>r+(m.processing_yield||0),0),j=n.length>0?i/n.length:0,d=n.reduce((r,m)=>r+(m.processing_waste||0),0),b=n.reduce((r,m)=>(m.final_grade&&["A","B","C"].includes(m.final_grade)&&r[m.final_grade]++,r),{A:0,B:0,C:0}),R=Array.from({length:7},(r,m)=>{const A=new Date;A.setDate(A.getDate()-m);const $=A.toISOString().split("T")[0],we=n.filter(_e=>_e.processing_date?.startsWith($)).length;return{date:$,count:we}}).reverse(),k=n.slice(0,10).map(r=>({date:new Date(r.processing_date).toLocaleDateString(),yield:r.processing_yield||0})).reverse();ue({totalProcessed:n.length,readyForProcessing:s,averageYield:Number(j.toFixed(1)),totalWaste:Number(d.toFixed(1)),gradeDistribution:b,weeklyProcessing:R,yieldTrends:k})};h.useEffect(()=>{if(N&&l.length>0){const s=l.find(i=>i.id===N);s&&B(i=>({...i,warehouse_entry_id:s.id,pre_processing_weight:s.total_weight?Number(s.total_weight):0,post_processing_weight:0,final_grade:i.final_grade||"",processing_date:new Date().toISOString()}))}},[N,l]),h.useEffect(()=>{if(g.pre_processing_weight&&g.post_processing_weight!==void 0){const s=g.pre_processing_weight-g.post_processing_weight,i=g.pre_processing_weight>0?g.post_processing_weight/g.pre_processing_weight*100:0;B(j=>({...j,processing_waste:s,processing_yield:Number(i.toFixed(2))}))}},[g.pre_processing_weight,g.post_processing_weight]),h.useEffect(()=>{ie(),G(),re()},[]),h.useEffect(()=>{be()},[l,n]);const ye=async()=>{if(!se){q(!0);try{const s=P.find(m=>m.name===v),i=l.find(m=>m.id===N),{data:j,error:d}=await W.from("processing_records").select("id, processing_code").eq("warehouse_entry_id",N).single();if(d&&d.code!=="PGRST116")throw d;if(j){alert(`This warehouse entry has already been processed! Processing Code: ${j.processing_code}`);return}const{generateUniqueProcessingCode:b}=await Ce(async()=>{const{generateUniqueProcessingCode:m}=await import("./entryCodeGenerator-DdMp6m9O.js");return{generateUniqueProcessingCode:m}},__vite__mapDeps([0,1,2])),R=await b(),k={warehouse_entry_id:g.warehouse_entry_id,processing_date:new Date().toISOString().split("T")[0],processed_by:null,pre_processing_weight:g.pre_processing_weight,post_processing_weight:g.post_processing_weight,processing_waste:g.processing_waste,processing_yield:g.processing_yield,size_distribution:{},grading_results:{[g.final_grade||"A"]:g.post_processing_weight||0},final_value:(g.post_processing_weight||0)*450,total_pieces:i?.total_pieces||0,processing_code:R},{error:r}=await W.from("processing_records").insert([k]);if(r){if(r.code==="23505"&&r.message.includes("warehouse_entry_id")){alert("This warehouse entry has already been processed! Please refresh the page to see the updated list."),await G();return}throw r}await G(),H(),a("sorting")}catch(s){console.error("Error creating processing record:",s.message),alert(`Error creating processing record: ${s.message}`)}finally{q(!1)}}},H=()=>{t(!1),y(""),B({}),T(""),q(!1)},ne=s=>{je(s),I(!0)},Q=l.filter(s=>!n.some(i=>i.warehouse_entry_id===s.id));return e.jsx("div",{className:"min-h-screen bg-gray-50 content-container responsive-padding",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(M,{className:"h-6 w-6 md:h-8 md:w-8 text-blue-600"}),"Processing Management"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor and manage fish processing operations"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(f,{variant:"outline",onClick:Ne,disabled:K,children:[e.jsx(X,{className:`h-4 w-4 mr-2 ${K?"animate-spin":""}`}),"Refresh"]}),e.jsxs(f,{variant:"outline",onClick:()=>a("dashboard"),children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Dashboard"]}),e.jsxs(ce,{open:z,onOpenChange:s=>s?t(!0):H(),children:[e.jsx(Ae,{asChild:!0,children:e.jsxs(f,{className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",disabled:Q.length===0,children:[e.jsx(Te,{className:"h-4 w-4 mr-2"}),Q.length===0?"No Entries to Process":"Start Processing"]})}),e.jsxs(oe,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(de,{children:e.jsxs(xe,{className:"flex items-center gap-2",children:[e.jsx(M,{className:"h-5 w-5 text-blue-600"}),"Start Fish Processing"]})}),e.jsx(Ye,{selectedEntryId:N,setSelectedEntryId:y,warehouseEntries:Q,processingRecords:n,formData:g,setFormData:B,selectedStorage:v,setSelectedStorage:T,storageLocations:P,isProcessing:se,onSubmit:ye,onClose:H})]})]})]})]}),e.jsx(Me,{stats:D,processingRecords:n}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(u,{children:[e.jsx(F,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(me,{className:"h-5 w-5 text-blue-600"}),"Weekly Processing Activity"]})}),e.jsxs(C,{children:[e.jsx(Ge,{data:D.weeklyProcessing,dataKey:"count"}),e.jsx("div",{className:"mt-2 text-center",children:e.jsx("p",{className:"text-sm text-gray-600",children:"Last 7 days"})})]})]}),e.jsxs(u,{children:[e.jsx(F,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"h-5 w-5 text-purple-600"}),"Yield Trends"]})}),e.jsxs(C,{children:[D.yieldTrends.length>0?e.jsx($e,{data:D.yieldTrends,dataKey:"yield"}):e.jsx("div",{className:"h-32 flex items-center justify-center text-gray-500",children:"No yield data available"}),e.jsx("div",{className:"mt-2 text-center",children:e.jsx("p",{className:"text-sm text-gray-600",children:"Recent processing yield %"})})]})]})]}),e.jsxs(u,{children:[e.jsx(F,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"h-5 w-5"}),"Quality Grade Distribution"]})}),e.jsx(C,{children:e.jsx("div",{className:"grid grid-cols-3 gap-4",children:Object.entries(D.gradeDistribution).map(([s,i])=>e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs(p,{className:`${E(s)} text-white mb-2`,children:["Grade ",s]}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:i}),e.jsxs("p",{className:"text-sm text-gray-600",children:[D.totalProcessed>0?(i/D.totalProcessed*100).toFixed(1):0,"%"]})]},s))})})]}),e.jsxs(u,{children:[e.jsx(F,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(Le,{className:"h-5 w-5"}),"Recent Processing Activity",e.jsxs(p,{variant:"secondary",className:"ml-auto",children:[w.length," recent"]})]})}),e.jsx(C,{children:w.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(M,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No recent processing activity"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Start by processing some warehouse entries"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3",children:w.map(s=>(l.find(i=>i.id===s.warehouse_entry_id),e.jsx(u,{className:"p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(p,{variant:"outline",children:l.find(i=>i.id===s.warehouse_entry_id)?.entry_code}),e.jsx(p,{className:"bg-purple-500 text-white",children:s.processing_code}),e.jsxs(p,{className:`${E(s.final_grade)} text-white`,children:["Grade ",s.final_grade]}),e.jsx("span",{className:"text-sm text-gray-600",children:"Size: To be sorted"}),e.jsx(p,{variant:"outline",className:"text-blue-600 border-blue-300",children:"Processing Complete"}),e.jsx("span",{className:"text-xs text-gray-400",children:new Date(s.processing_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-4 text-sm",children:[e.jsxs("span",{children:["Pre: ",s.pre_processing_weight,"kg"]}),e.jsxs("span",{children:["Post: ",s.post_processing_weight,"kg"]}),e.jsxs("span",{children:["Waste: ",s.processing_waste,"kg"]}),e.jsxs("span",{className:U(s.processing_yield),children:["Yield: ",s.processing_yield,"%"]})]}),e.jsxs("p",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Z,{className:"h-3 w-3"}),e.jsx("strong",{children:s.storage_location||"Not assigned"})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(f,{size:"sm",variant:"outline",onClick:()=>ne(s),children:[e.jsx(le,{className:"h-3 w-3 mr-1"}),"Details"]})})]})},s.id)))}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs(f,{variant:"outline",onClick:()=>te(!ae),className:"w-full",children:["View All ",n.length," Records"]})})]})})]}),ae&&e.jsxs(u,{className:"mt-6",children:[e.jsx(F,{children:e.jsxs(L,{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5"}),"All Processing Records (",n.length,")"]})}),e.jsxs(C,{children:[e.jsx("div",{className:"space-y-4",children:n.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(M,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No processing records found"})]}):n.map(s=>(l.find(i=>i.id===s.warehouse_entry_id),e.jsx(u,{className:"p-4 border border-gray-200 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(p,{variant:"outline",className:"font-medium",children:l.find(i=>i.id===s.warehouse_entry_id)?.entry_code}),e.jsx(p,{className:"bg-purple-500 text-white font-medium",children:s.processing_code}),e.jsxs(p,{className:`${E(s.final_grade)} text-white font-medium`,children:["Grade ",s.final_grade]}),e.jsx(p,{className:"bg-purple-500 text-white font-medium",children:"Size: To be sorted"}),e.jsx(p,{variant:"outline",className:"text-blue-600 border-blue-300 font-medium",children:"Processing Complete"}),e.jsxs("span",{className:"text-sm text-gray-500 flex items-center gap-1",children:[e.jsx(he,{className:"h-4 w-4"}),new Date(s.processing_date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-6 text-sm",children:[e.jsxs("span",{children:["Pre: ",s.pre_processing_weight,"kg"]}),e.jsxs("span",{children:["Post: ",s.post_processing_weight,"kg"]}),e.jsxs("span",{children:["Waste: ",s.processing_waste,"kg"]}),e.jsxs("span",{className:U(s.processing_yield),children:["Yield: ",s.processing_yield,"%"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1 font-medium text-gray-900",children:[e.jsx(Z,{className:"h-4 w-4"}),s.farmer_name]}),e.jsxs("span",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(V,{className:"h-4 w-4"}),"Storage: ",s.storage_location||"Not assigned"]})]})]}),e.jsx("div",{className:"flex gap-2 flex-shrink-0",children:e.jsxs(f,{size:"sm",variant:"outline",onClick:()=>ne(s),children:[e.jsx(le,{className:"h-4 w-4 mr-1"}),"View Details"]})})]})},s.id)))}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(f,{variant:"outline",onClick:()=>te(!1),className:"w-full",children:"Show Less"})})]})]}),e.jsx(ce,{open:fe,onOpenChange:I,children:e.jsxs(oe,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(de,{children:e.jsx(xe,{className:"text-2xl font-bold",children:"Processing Details"})}),c&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Entry Code"}),e.jsx("span",{className:"font-medium",children:l.find(s=>s.id===c.warehouse_entry_id)?.entry_code})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Processing Code"}),e.jsx("span",{className:"font-medium",children:c.processing_code})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Processing Date"}),e.jsx("span",{className:"font-medium",children:new Date(c.processing_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Farmer"}),e.jsx("span",{className:"font-medium",children:c.farmer_name||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Processed By"}),e.jsx("span",{className:"font-medium",children:c.processed_by||"Not specified"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Final Grade"}),e.jsxs(p,{className:`${E(c.final_grade)} text-white`,children:["Grade ",c.final_grade]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Size"}),e.jsx("span",{className:"font-medium",children:"To be sorted"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Storage Location"}),e.jsx("span",{className:"font-medium",children:c.storage_location||"Not assigned"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Status"}),e.jsx(p,{className:"bg-green-600 text-white",children:"Complete"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Weight Analysis"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[c.pre_processing_weight,"kg"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Pre-Processing"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[c.post_processing_weight,"kg"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Post-Processing"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[c.processing_waste,"kg"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Waste"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-2xl font-bold ${U(c.processing_yield)}`,children:[c.processing_yield,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Yield"})]})]})]}),c.notes&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Notes"}),e.jsx("p",{className:"text-gray-700 bg-gray-50 p-4 rounded-lg",children:c.notes})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(f,{onClick:()=>I(!1),children:"Close"})})]})]})})]})})}export{ls as default};
