import{s as ks,w as f,u as e,g as be,f as y,a as qe,b as F,k as G,d as V,c as le,o as R,i as B,X as _e,j as Ss,N as Os,m as P,J as ne,C as Cs,P as Qe,E as We,W as C,y as Ke,K as z,z as $s}from"./index-Cx51dYQZ.js";import{T as Re,N as Be,P as Je,_ as Xe,E as H}from"./select-DqWpyIkf-D_8tzK0d.js";import{p as He}from"./textarea-TOFJikG_-C72QqR98.js";import{H as de,K as Fs,O as ce,X as oe,_ as me,E as xe,q as Ps}from"./dialog-NtgNh5u1-2hJTriox.js";import{f as Ye}from"./checkbox-Caq1szpR-CvNcvjTY.js";import{G as Is}from"./inventoryService-gXyYRUkQ-CaNYK-Tu.js";import{y as Ds}from"./FishFarmMarquee-CZKDlPxE-CElfCyDz.js";import{m as As}from"./auditLogger-DsAnB0jd-BH5jyDaI.js";import{i as Y}from"./clock-sArWPAJm-BmsKQooK.js";import{t as E}from"./circle-check-big-BZ9nasO6-BWVBSi9U.js";import{a as ve}from"./calendar-CU6tj0PZ-Ucpt8Hnz.js";import{h as Ne}from"./file-text-35uk4vLR-D2sbaJVA.js";import{c as Es}from"./star-arJKEdXF-DFv3ZT5S.js";import{m as Ts}from"./ruler-CopLYj-b-CeXK_mRn.js";import{u as Us}from"./index-io8wS31O-C_L8DqSR.js";import{o as Ze}from"./map-pin-C-M6umvy-CUBiYWs8.js";import{c as Ls}from"./phone-RCWEg5es-CV2PNXYE.js";import{c as Ms}from"./plus-FJ0CIBRX-DLM2sgk0.js";import{c as Gs}from"./dollar-sign-BhCk0N5D-BR4pe6-Y.js";import{t as Vs}from"./building-2-DwnJS45a-o2Atf5vx.js";import"./index-B7iGXlpc-YR4igk-O.js";import"./trending-up-DUO3gdV8-ywoZrOkl.js";import"./award-DoBG6xPL-BvcxiUhY.js";import"./index-CEgc-Zw--jggqibQ8.js";var Qs=Object.defineProperty,Ws=Object.defineProperties,Ks=Object.getOwnPropertyDescriptors,es=Object.getOwnPropertySymbols,Rs=Object.prototype.hasOwnProperty,Bs=Object.prototype.propertyIsEnumerable,ss=(N,b,_)=>b in N?Qs(N,b,{enumerable:!0,configurable:!0,writable:!0,value:_}):N[b]=_,h=(N,b)=>{for(var _ in b||(b={}))Rs.call(b,_)&&ss(N,_,b[_]);if(es)for(var _ of es(b))Bs.call(b,_)&&ss(N,_,b[_]);return N},g=(N,b)=>Ws(N,Ks(b)),I=(N,b,_)=>new Promise((Z,J)=>{var ee=k=>{try{u(_.next(k))}catch(L){J(L)}},w=k=>{try{u(_.throw(k))}catch(L){J(L)}},u=k=>k.done?Z(k.value):Promise.resolve(k.value).then(ee,w);u((_=_.apply(N,b)).next())});/**
* @license lucide-react v0.487.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Js=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],we=qe("ban",Js);/**
* @license lucide-react v0.487.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Xs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]],ts=qe("circle-plus",Xs);/**
* @license lucide-react v0.487.0 - ISC
*
* This source code is licensed under the ISC license.
* See the LICENSE file in the root directory of this source tree.
*/const Hs=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],as=qe("user-check",Hs),Ys=[{size:0,label:"Size 0 - Premium Large",description:"2.5+ kg each"},{size:1,label:"Size 1 - Extra Large",description:"2.0-2.5 kg each"},{size:2,label:"Size 2 - Large",description:"1.5-2.0 kg each"},{size:3,label:"Size 3 - Medium-Large",description:"1.2-1.5 kg each"},{size:4,label:"Size 4 - Medium",description:"1.0-1.2 kg each"},{size:5,label:"Size 5 - Medium-Small",description:"0.8-1.0 kg each"},{size:6,label:"Size 6 - Small-Medium",description:"0.6-0.8 kg each"},{size:7,label:"Size 7 - Small",description:"0.4-0.6 kg each"},{size:8,label:"Size 8 - Extra Small",description:"0.3-0.4 kg each"},{size:9,label:"Size 9 - Mini",description:"0.2-0.3 kg each"},{size:10,label:"Size 10 - Tiny",description:"0.1-0.2 kg each"}];function wt({onNavigate:N}){var b,_,Z,J,ee;const{user:w}=ks(),[u,k]=f.useState([]),[L,ze]=f.useState([]),[rs,ue]=f.useState([]),[Zs,ke]=f.useState(!0),[is,se]=f.useState(!1),[ls,he]=f.useState(!1),[ns,Q]=f.useState(!1),[d,ds]=f.useState(null),[cs,te]=f.useState(!1),[p,Se]=f.useState(null),Oe=(s,t,a,n,i)=>I(this,null,function*(){try{yield As.custom(s,t,a,{old_values:n,new_values:i})}catch(r){console.warn("Failed to log audit event:",r)}}),[S,ae]=f.useState("all"),[l,D]=f.useState({outlet_id:"",requested_quantity:"",requested_grade:"",price_per_kg:"",requested_sizes:[],size_quantities:{},use_any_size:!1,delivery_date:"",notes:""}),[m,M]=f.useState({}),[ge,Ce]=f.useState(!1),[T,re]=f.useState({confirmedBy:"",notes:"",action:"approve"}),[pe,$e]=f.useState(!1),[q,W]=f.useState([]),[A,Fe]=f.useState(null),[Pe,fe]=f.useState([]),[os,Ie]=f.useState(!1),[ye,je]=f.useState({}),ms=(s,t)=>{D(a=>g(h({},a),{size_quantities:g(h({},a.size_quantities),{[s]:t})}))},xs=s=>{D(t=>g(h({},t),{use_any_size:s,requested_sizes:s?[]:t.requested_sizes,size_quantities:s?{}:t.size_quantities}))},us=s=>I(this,null,function*(){Ie(!0);try{const t=yield Is.getInventoryByStorage();if(!t||t.length===0){console.log("No inventory data available"),fe([]),je({});return}const a=new Set,n={};t.forEach(i=>{const r=i.size;!isNaN(r)&&i.total_quantity>0&&(a.add(r),n[r]||(n[r]={quantity:0,storageLocation:i.storage_location_name||"Unknown Storage",grade:"A",totalWeight:0}),n[r].quantity+=i.total_quantity,n[r].totalWeight+=i.total_weight_kg,n[r].storageLocation==="Unknown Storage"&&(n[r].storageLocation=i.storage_location_name||"Unknown Storage"))}),fe(Array.from(a).sort((i,r)=>i-r)),je(n)}catch(t){console.error("Error fetching available sizes:",t),C.error("Failed to fetch available sizes",{description:"Please try again or check your connection",duration:5e3}),fe([]),je({})}finally{Ie(!1)}}),De=()=>I(this,null,function*(){try{const{data:s,error:t}=yield z.from("processing_records").select(`
          *,
          warehouse_entries!inner(
            entry_date,
            total_weight,
            total_pieces,
            condition,
            temperature,
            price_per_kg,
            total_value,
            notes,
            farmers!inner(
              name,
              phone,
              location,
              rating,
              reliability
            )
          )
        `).gt("ready_for_dispatch_count",0).order("processing_date",{ascending:!1});if(t)throw t;const a=((s==null?void 0:s.map(i=>{let r=0;if(i.size_distribution&&typeof i.size_distribution=="object"){const O=Object.keys(i.size_distribution);O.length>0&&(r=parseInt(O[0])||0)}let x="Unknown";if(i.grading_results&&typeof i.grading_results=="object"){const O=Object.keys(i.grading_results);O.length>0&&(x=O[0])}const o=i.warehouse_entries,c=o==null?void 0:o.farmers;return g(h({},i),{final_grade:x,final_size:r,storage_location:"Processing Area",farmer_name:(c==null?void 0:c.name)||"Unknown Farmer",entry_date:o==null?void 0:o.entry_date,total_pieces:o==null?void 0:o.total_pieces,condition:o==null?void 0:o.condition,temperature:o==null?void 0:o.temperature,price_per_kg:o==null?void 0:o.price_per_kg,total_value:o==null?void 0:o.total_value,notes:o==null?void 0:o.notes,farmer_phone:c==null?void 0:c.phone,farmer_location:c==null?void 0:c.location,farmer_rating:c==null?void 0:c.rating,farmer_reliability:c==null?void 0:c.reliability})}))||[]).reduce((i,r)=>{const x=r.final_size,o=r.storage_location,c=`${x}_${o}`;i[c]||(i[c]={id:`grouped_${c}`,final_size:x,final_grade:r.final_grade,storage_location:o,total_quantity:0,total_weight:0,total_value:0,processing_records:[],farmers:new Set,entry_dates:new Set,conditions:new Set,temperatures:[],processed_by_names:new Set,ready_for_dispatch_count:0,warehouse_entry_id:r.warehouse_entry_id,processing_date:r.processing_date,processed_by:r.processed_by,pre_processing_weight:r.pre_processing_weight,post_processing_weight:r.post_processing_weight,processing_waste:r.processing_waste,processing_yield:r.processing_yield,size_distribution:r.size_distribution,grading_results:r.grading_results,final_value:r.final_value,created_at:r.created_at,updated_at:r.updated_at,farmer_name:r.farmer_name,entry_date:r.entry_date,total_pieces:r.total_pieces,condition:r.condition,temperature:r.temperature,price_per_kg:r.price_per_kg,notes:r.notes,farmer_phone:r.farmer_phone,farmer_location:r.farmer_location,farmer_rating:r.farmer_rating,farmer_reliability:r.farmer_reliability});const O=r.size_distribution||{},j=O[x]||0;i[c].total_quantity+=j;const v=Object.values(O).reduce((K,zs)=>K+(Number(zs)||0),0),$=v>0?r.post_processing_weight/v:0,ie=j*$;return i[c].total_weight+=ie,i[c].total_value+=r.final_value||0,i[c].processing_records.push(r.id),i[c].farmers.add(r.farmer_name),i[c].entry_dates.add(r.entry_date),i[c].conditions.add(r.condition),r.temperature&&i[c].temperatures.push(r.temperature),i[c].ready_for_dispatch_count+=r.ready_for_dispatch_count||0,i},{}),n=Object.values(a).map(i=>g(h({},i),{farmers:Array.from(i.farmers).join(", "),entry_dates:Array.from(i.entry_dates).join(", "),conditions:Array.from(i.conditions).join(", "),average_temperature:i.temperatures.length>0?(i.temperatures.reduce((r,x)=>r+x,0)/i.temperatures.length).toFixed(1):null,processing_count:i.processing_records.length}));n.sort((i,r)=>i.final_size!==r.final_size?i.final_size-r.final_size:i.storage_location.localeCompare(r.storage_location)),ue(n)}catch(s){console.error("Error fetching inventory:",s),C.error("Failed to fetch inventory data",{description:"Please refresh the page or try again later",duration:5e3}),ue([])}}),Ae=()=>I(this,null,function*(){try{ke(!0);const[s,t]=yield Promise.allSettled([Ke.getOutletOrders(),$s.getOutlets()]);k(s.status==="fulfilled"?s.value:[]),ze(t.status==="fulfilled"?t.value:[]),yield De(),s.status==="rejected"&&console.warn("Outlet orders table not available yet:",s.reason),t.status==="rejected"&&console.warn("Outlets table not available yet:",t.reason)}catch(s){console.error("Error fetching data:",s),C.error("Failed to load order data",{description:"Please refresh the page or check your connection",duration:5e3}),k([]),ze([]),ue([])}finally{ke(!1)}});f.useEffect(()=>{Ae()},[]);const Ee=s=>{switch(s){case"pending":return"bg-amber-500 text-white";case"confirmed":return"bg-blue-500 text-white";case"dispatched":return"bg-emerald-500 text-white";case"completed":return"bg-green-600 text-white";default:return"bg-gray-500 text-white"}},Te=s=>{switch(s){case"pending":return e.jsx(Y,{className:"h-4 w-4"});case"confirmed":return e.jsx(E,{className:"h-4 w-4"});case"dispatched":return e.jsx(E,{className:"h-4 w-4"});case"completed":return e.jsx(E,{className:"h-4 w-4"});default:return e.jsx(Y,{className:"h-4 w-4"})}},U=s=>`KES ${s.toLocaleString()}`,Ue=s=>{if(s.length===0)return"No sizes selected";const t=s.sort((a,n)=>a-n);return t.length===1?`Size ${t[0]}`:`Sizes ${t[0]}-${t[t.length-1]}`},hs=s=>{D(t=>g(h({},t),{requested_sizes:t.requested_sizes.includes(s)?t.requested_sizes.filter(a=>a!==s):[...t.requested_sizes,s].sort((a,n)=>a-n),requested_grade:""}))},gs=()=>{const s={};if(l.outlet_id||(s.outlet_id="Please select an outlet"),l.use_any_size)(!l.requested_quantity||parseFloat(l.requested_quantity)<=0)&&(s.requested_quantity="Please enter a valid total quantity (greater than 0)");else if(l.requested_sizes.length===0)s.requested_sizes="Please select at least one fish size";else{Object.values(l.size_quantities).reduce((t,a)=>t+a,0)<=0&&(s.requested_sizes="Please specify quantities for selected sizes");for(const t of l.requested_sizes){const a=l.size_quantities[t]||0,n=ye[t],i=n?n.totalWeight:0;if(a>i){s.requested_sizes=`Size ${t}: Requested ${a}kg exceeds available ${i.toFixed(1)}kg`;break}}}return(!l.price_per_kg||parseFloat(l.price_per_kg)<=0)&&(s.price_per_kg="Please enter a valid price per kg (greater than 0)"),l.requested_grade||(s.requested_grade="Please select a grade preference"),l.delivery_date&&new Date(l.delivery_date)<new Date&&(s.delivery_date="Delivery date cannot be in the past"),M(s),Object.keys(s).length===0},ps=()=>I(this,null,function*(){try{const{data:s,error:t}=yield z.from("outlet_orders").select("order_number").not("order_number","is",null).order("created_at",{ascending:!1}).limit(1);if(t)throw t;let a=1;if(s&&s.length>0){const n=s[0].order_number,i=n==null?void 0:n.match(/INV(\d+)/);i&&(a=parseInt(i[1])+1)}return`INV${a.toString().padStart(3,"0")}`}catch(s){return console.error("Error generating order number:",s),`INV${Date.now().toString().slice(-6)}`}}),fs=()=>I(this,null,function*(){if(gs()){Ce(!0);try{const s=yield ps();let t,a;l.use_any_size?(t=parseFloat(l.requested_quantity),a=[]):(t=Object.values(l.size_quantities).reduce((x,o)=>x+o,0),a=l.requested_sizes);const n=t*parseFloat(l.price_per_kg),i={outlet_id:l.outlet_id,order_date:new Date().toISOString().split("T")[0],delivery_date:l.delivery_date||null,requested_sizes:a,requested_quantity:t,requested_grade:l.requested_grade==="any"?null:l.requested_grade,price_per_kg:parseFloat(l.price_per_kg),total_value:n,status:"pending",notes:l.notes,order_number:s,size_quantities:l.use_any_size?{}:l.size_quantities,use_any_size:l.use_any_size};console.log("Creating order with data:",i);const r=yield Ke.createOutletOrder(i);k([r,...u]),D({outlet_id:"",requested_quantity:"",requested_grade:"",price_per_kg:"",requested_sizes:[],size_quantities:{},use_any_size:!1,delivery_date:"",notes:""}),M({}),se(!1),C.success(`Order ${s} created successfully!`,{description:`Order Number: ${s}`,duration:5e3})}catch(s){console.error("Error creating order:",s),C.error("Failed to create order",{description:s.message||"Unknown error occurred",duration:5e3})}finally{Ce(!1)}}}),Le=s=>{const t=u.find(a=>a.id===s);t&&(Se(t),te(!0),re({confirmedBy:(w==null?void 0:w.email)||"Current User",notes:"",action:"approve"}))},ys=()=>I(this,null,function*(){if(!p){C.error("No order selected for confirmation");return}$e(!0);try{if(T.action==="approve"){const{error:s}=yield z.from("outlet_orders").update({status:"confirmed",confirmed_date:new Date().toISOString().split("T")[0],notes:T.notes||p.notes}).eq("id",p.id);if(s)throw s;yield Oe("UPDATE","outlet_orders",p.id,{status:p.status},{status:"confirmed",confirmed_date:new Date().toISOString().split("T")[0]}),yield js(p),yield bs(),yield _s(p),k(t=>t.map(a=>a.id===p.id?g(h({},a),{status:"confirmed",confirmedDate:new Date().toISOString().split("T")[0]}):a)),C.success(`Order ${p.order_number||p.id} approved, confirmed, and moved to dispatch!`)}else{const{error:s}=yield z.from("outlet_orders").update({status:"cancelled",notes:`Order discarded by ${(w==null?void 0:w.email)||"Current User"}. ${T.notes||""}`.trim()}).eq("id",p.id);if(s)throw s;yield Oe("UPDATE","outlet_orders",p.id,{status:p.status},{status:"cancelled",notes:`Order discarded by ${(w==null?void 0:w.email)||"Current User"}. ${T.notes||""}`.trim()}),k(t=>t.map(a=>a.id===p.id?g(h({},a),{status:"cancelled"}):a)),C.success(`Order ${p.order_number||p.id} has been discarded.`)}te(!1),Se(null)}catch(s){console.error("Error processing order confirmation:",s),C.error("Failed to process order confirmation",{description:"Please try again or contact support if the issue persists",duration:5e3})}finally{$e(!1)}}),js=s=>I(this,null,function*(){try{const{data:t,error:a}=yield z.from("sorting_results").select(`
          *,
          sorting_batch:sorting_batches!inner(
            id,
            status
          )
        `).eq("sorting_batch.status","completed").gt("total_weight_grams",0);if(a)throw a;if(!t||t.length===0)throw new Error("No available inventory found for order confirmation");let n=s.requested_quantity||0;const i=[];if(s.size_quantities&&Object.keys(s.size_quantities).length>0)for(const[r,x]of Object.entries(s.size_quantities)){const o=parseInt(r),c=x,O=t.filter(v=>v.size_class===o&&v.total_weight_grams>0);let j=c;for(const v of O){if(j<=0)break;const $=Math.min(j,v.total_weight_grams/1e3),{error:ie}=yield z.from("sorting_results").update({total_weight_grams:v.total_weight_grams-$*1e3,total_pieces:Math.max(0,v.total_pieces-Math.ceil($))}).eq("id",v.id);if(ie)throw ie;try{const{error:K}=yield z.from("inventory_entries").insert({size:o,quantity_change:-Math.ceil($),entry_type:"order_dispatch",reference_id:s.id,notes:`Order dispatch - Size ${o}, Weight: ${$.toFixed(2)}kg`});K&&console.warn("Could not create inventory entry:",K)}catch(K){console.warn("Inventory entries table might not exist:",K)}i.push({size:o,weight_deducted:$,remaining_stock:(v.total_weight_grams-$*1e3)/1e3}),j-=$}}else for(const r of t){if(n<=0)break;const x=Math.min(n,r.total_weight_grams/1e3),{error:o}=yield z.from("sorting_results").update({total_weight_grams:r.total_weight_grams-x*1e3,total_pieces:Math.max(0,r.total_pieces-Math.ceil(x))}).eq("id",r.id);if(o)throw o;try{const{error:c}=yield z.from("inventory_entries").insert({size:r.size_class||0,quantity_change:-Math.ceil(x),entry_type:"order_dispatch",reference_id:s.id,notes:`Order dispatch - Size ${r.size_class||0}, Weight: ${x.toFixed(2)}kg`});c&&console.warn("Could not create inventory entry:",c)}catch(c){console.warn("Inventory entries table might not exist:",c)}i.push({size:r.size_class||0,weight_deducted:x,remaining_stock:(r.total_weight_grams-x*1e3)/1e3}),n-=x}return console.log("Inventory deducted for order confirmation:",i),i}catch(t){throw console.error("Error deducting inventory on order confirmation:",t),t}}),bs=()=>I(this,null,function*(){try{console.log("ðŸ”„ Updating storage capacity after order confirmation...");const{error:s}=yield z.rpc("update_storage_capacity_from_inventory");s?console.warn("âš ï¸ Could not update storage capacity:",s):console.log("âœ… Storage capacity updated successfully")}catch(s){console.warn("âš ï¸ Error updating storage capacity:",s)}}),_s=s=>I(this,null,function*(){try{const t=L.find(c=>c.id===s.outlet_id),a=(t==null?void 0:t.name)||"Unknown Outlet",n=s.requested_quantity||0,i=s.requested_quantity||0,r=s.size_quantities||{},{data:x,error:o}=yield z.from("dispatch_records").insert({outlet_order_id:s.id,fish_ids:[],destination:a,dispatch_date:new Date().toISOString().split("T")[0],total_weight:n,total_pieces:i,size_breakdown:r,total_value:s.total_value||0,status:"scheduled",notes:`Auto-created dispatch for confirmed order ${s.order_number||s.id}`,dispatched_by:(w==null?void 0:w.id)||null}).select().single();if(o)throw console.error("Error creating dispatch record:",o),o;return console.log("Automatic dispatch record created:",x),x}catch(t){console.error("Failed to create automatic dispatch record:",t),C.warning("Order confirmed but dispatch record creation failed. Please create dispatch manually.")}}),vs=()=>I(this,null,function*(){if(!A||q.length===0){C.error("Please select items from inventory");return}try{const s=q.map(j=>j.inventoryItem.id),{error:t}=yield z.from("processing_records").update({ready_for_dispatch_count:0}).in("id",s);if(t)throw t;const a=q.reduce((j,v)=>j+v.weight,0),n=q.reduce((j,v)=>j+v.quantity,0),i=q.reduce((j,v)=>{const $=v.inventoryItem.final_size||0;return j[$]=(j[$]||0)+v.quantity,j},{}),r=u.find(j=>j.id===A),x=L.find(j=>j.id===(r==null?void 0:r.outlet_id)),{data:o,error:c}=yield z.from("dispatch_records").insert({outlet_order_id:A,fish_ids:s,destination:(x==null?void 0:x.name)||"Unknown",dispatch_date:new Date().toISOString().split("T")[0],total_weight:a,total_pieces:n,size_breakdown:i,total_value:(r==null?void 0:r.total_value)||0,status:"dispatched",notes:`Inventory picked for order ${(r==null?void 0:r.order_number)||A}`,dispatched_by:(w==null?void 0:w.id)||null}).select().single();if(c)throw c;const{error:O}=yield z.from("outlet_orders").update({status:"dispatched",dispatch_date:new Date().toISOString().split("T")[0]}).eq("id",A);if(O)throw O;yield Ae(),yield De(),he(!1),Fe(null),W([]),C.success("Order dispatched successfully!",{description:`Order ${(r==null?void 0:r.order_number)||A} has been dispatched with ${n} pieces`,duration:5e3})}catch(s){console.error("Error dispatching order:",s),C.error("Failed to dispatch order",{description:"Please try again or contact support if the issue persists",duration:5e3})}}),Me=()=>{switch(S){case"pending":return u.filter(s=>s.status==="pending");case"confirmed":return u.filter(s=>s.status==="confirmed");case"cancelled":return u.filter(s=>s.status==="cancelled");case"all":default:return u}},Ns=s=>{const t=u.find(a=>a.id===s);t&&(ds(t),Q(!0))},ws=(s,t)=>{const a=q.findIndex(n=>n.inventoryItem.id===s.id);if(a>=0){const n=[...q];n[a].quantity+=t,n[a].weight=n[a].quantity*(s.post_processing_weight/(s.total_pieces||1)),W(n)}else{const n=t*(s.post_processing_weight/(s.total_pieces||1));W(i=>[...i,{inventoryItem:s,quantity:t,weight:n}])}},Ge=s=>{W(t=>t.filter(a=>a.inventoryItem.id!==s))},qs=(s,t)=>{if(t<=0){Ge(s);return}W(a=>a.map(n=>{if(n.inventoryItem.id===s){const i=t*(n.inventoryItem.post_processing_weight/(n.inventoryItem.total_pieces||1));return g(h({},n),{quantity:t,weight:i})}return n}))},Ve=s=>rs.filter(t=>!(!t.total_quantity||t.total_quantity<=0||t.ready_for_dispatch_count<=0||s.requested_sizes&&s.requested_sizes.length>0&&!s.requested_sizes.includes(t.final_size||0)||s.requested_grade&&s.requested_grade!=="any"&&t.final_grade!==s.requested_grade)),X={totalOrders:u.length,pendingOrders:u.filter(s=>s.status==="pending").length,confirmedOrders:u.filter(s=>s.status==="confirmed").length,totalValue:u.reduce((s,t)=>s+t.total_value,0),totalQuantity:u.reduce((s,t)=>s+(t.requested_quantity||0),0)};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 content-container responsive-padding",children:[e.jsx(Ds,{}),e.jsxs("div",{className:"max-w-7xl mx-auto space-y-8",children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h1",{className:"text-4xl font-bold text-gray-900 flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl shadow-lg",children:e.jsx(be,{className:"h-10 w-10 text-white"})}),"Order Management"]}),e.jsx("p",{className:"text-xl text-gray-600 ml-16",children:"Manage fish orders from outlets across Kenya â€¢ Size-based selection"})]}),e.jsxs(de,{open:is,onOpenChange:s=>{console.log("Dialog state changing to:",s),se(s)},children:[e.jsx(Fs,{asChild:!0,children:e.jsxs(y,{onClick:()=>{console.log("New Order button clicked"),se(!0)},className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white px-8 py-4 rounded-2xl font-semibold text-lg shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105",children:[e.jsx(ts,{className:"h-6 w-6 mr-3"}),"New Order"]})}),e.jsxs(ce,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(oe,{className:"pb-4",children:[e.jsxs(me,{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg",children:e.jsx(ts,{className:"h-5 w-5 text-white"})}),"Create New Order"]}),e.jsx(xe,{className:"text-gray-600",children:"Create a new order for your outlet with real-time inventory validation"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(Y,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm text-green-700 font-medium",children:"FIFO System Active: Orders will automatically use oldest batches first"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(F,{className:"text-base font-semibold text-gray-700",children:"Select Outlet *"}),e.jsxs(Re,{value:l.outlet_id,onValueChange:s=>{D(g(h({},l),{outlet_id:s,requested_sizes:[]})),m.outlet_id&&M(g(h({},m),{outlet_id:""})),us()},children:[e.jsx(Be,{className:`h-12 ${m.outlet_id?"border-red-500":"border-gray-300"}`,children:e.jsx(Je,{placeholder:"Choose an outlet..."})}),e.jsx(Xe,{children:L.map(s=>e.jsx(H,{value:s.id,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:s.name}),e.jsx("span",{className:"text-sm text-gray-500",children:s.location})]})},s.id))})]}),m.outlet_id&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{children:m.outlet_id})]})]}),l.outlet_id&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(F,{className:"text-base font-semibold text-gray-700",children:"Select Fish Sizes *"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ye,{id:"any-size",checked:l.use_any_size,onCheckedChange:xs,className:"h-4 w-4"}),e.jsx("label",{htmlFor:"any-size",className:"text-sm text-gray-600 cursor-pointer",children:"Use any available size"})]})]}),l.use_any_size?e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(E,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Any Size Selected"})]}),e.jsx("p",{className:"text-xs text-green-700",children:"The system will automatically select the best available sizes based on inventory and your total quantity requirement."})]}):e.jsxs(e.Fragment,{children:[os?e.jsxs("div",{className:"p-6 text-center border border-gray-200 rounded-lg bg-gray-50",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Loading available sizes..."})]}):e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 max-h-60 overflow-y-auto p-3 border border-gray-200 rounded-lg bg-gray-50",children:[Ys.filter(s=>Pe.includes(s.size)).map(s=>{const t=ye[s.size];return e.jsxs("div",{className:`p-3 rounded-lg border-2 transition-all ${l.requested_sizes.includes(s.size)?"border-blue-500 bg-blue-50":"border-gray-200 bg-white hover:border-blue-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ye,{id:`size-${s.size}`,checked:l.requested_sizes.includes(s.size),onCheckedChange:()=>hs(s.size),className:"h-4 w-4"}),e.jsxs("label",{htmlFor:`size-${s.size}`,className:"cursor-pointer text-sm font-medium",children:["Size ",s.size]})]}),t&&e.jsxs("div",{className:"text-xs text-gray-600 pl-6 mb-2",children:[e.jsxs("div",{children:[t.quantity," pcs"]}),e.jsxs("div",{children:[t.totalWeight?t.totalWeight.toFixed(1):"0.0"," kg"]})]})]},s.size)}),Pe.length===0&&e.jsxs("div",{className:"col-span-full text-center py-4 text-gray-500",children:[e.jsx(V,{className:"h-6 w-6 mx-auto mb-1 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"No sizes available"})]})]})}),l.requested_sizes.length>0&&e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-800 mb-3",children:["Selected: ",Ue(l.requested_sizes)," (",l.requested_sizes.length," size",l.requested_sizes.length!==1?"s":"",")"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-xs text-blue-700 font-medium",children:"Specify quantity (kg) for each size:"}),l.requested_sizes.map(s=>{const t=ye[s],a=t?t.totalWeight:0,n=l.size_quantities[s]||0;return e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-blue-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-700",children:["Size ",s]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["Available: ",a.toFixed(1)," kg"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{type:"number",placeholder:"0.0",min:"0.1",max:a,step:"0.1",className:"h-8 text-sm flex-1",value:n||"",onChange:i=>ms(s,parseFloat(i.target.value)||0)}),e.jsx("span",{className:"text-xs text-gray-500",children:"kg"})]}),n>a&&e.jsxs("div",{className:"flex items-center gap-1 text-red-600 text-xs mt-1",children:[e.jsx(G,{className:"h-3 w-3"}),e.jsx("span",{children:"Exceeds available stock"})]})]},s)}),e.jsx("div",{className:"pt-2 border-t border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"font-medium text-blue-800",children:"Total Requested:"}),e.jsxs("span",{className:"font-bold text-blue-600",children:[Object.values(l.size_quantities).reduce((s,t)=>s+t,0).toFixed(1)," kg"]})]})})]})]})]}),m.requested_sizes&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(G,{className:"h-4 w-4"}),e.jsx("span",{children:m.requested_sizes})]})]}),(l.requested_sizes.length>0||l.use_any_size)&&e.jsxs("div",{className:"space-y-4",children:[l.use_any_size?e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{className:"text-sm font-medium text-gray-700",children:"Total Quantity (kg) *"}),e.jsx(le,{type:"number",placeholder:"100",min:"1",step:"0.1",className:`h-10 ${m.requested_quantity?"border-red-500":"border-gray-300"}`,value:l.requested_quantity,onChange:s=>{D(g(h({},l),{requested_quantity:s.target.value})),m.requested_quantity&&M(g(h({},m),{requested_quantity:""}))}}),m.requested_quantity&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(G,{className:"h-3 w-3"}),e.jsx("span",{children:m.requested_quantity})]})]}):e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Quantity:"}),e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:[Object.values(l.size_quantities).reduce((s,t)=>s+t,0).toFixed(1)," kg"]})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Calculated from individual size quantities above"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{className:"text-sm font-medium text-gray-700",children:"Price per kg (KES) *"}),e.jsx(le,{type:"number",placeholder:"500",min:"1",step:"0.01",className:`h-10 ${m.price_per_kg?"border-red-500":"border-gray-300"}`,value:l.price_per_kg,onChange:s=>{D(g(h({},l),{price_per_kg:s.target.value})),m.price_per_kg&&M(g(h({},m),{price_per_kg:""}))}}),m.price_per_kg&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(G,{className:"h-3 w-3"}),e.jsx("span",{children:m.price_per_kg})]})]})]}),(l.requested_sizes.length>0||l.use_any_size)&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{className:"text-sm font-medium text-gray-700",children:"Grade Preference"}),e.jsxs(Re,{value:l.requested_grade,onValueChange:s=>{D(g(h({},l),{requested_grade:s})),m.requested_grade&&M(g(h({},m),{requested_grade:""}))},children:[e.jsx(Be,{className:`h-10 ${m.requested_grade?"border-red-500":"border-gray-300"}`,children:e.jsx(Je,{placeholder:"Select grade preference"})}),e.jsxs(Xe,{children:[e.jsx(H,{value:"any",children:"Any Grade Available"}),e.jsx(H,{value:"A",children:"Grade A (Premium)"}),e.jsx(H,{value:"B",children:"Grade B (Standard)"}),e.jsx(H,{value:"C",children:"Grade C (Economy)"})]})]}),m.requested_grade&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(G,{className:"h-3 w-3"}),e.jsx("span",{children:m.requested_grade})]})]}),l.requested_sizes.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{className:"text-sm font-medium text-gray-700",children:"Delivery Date"}),e.jsxs("div",{className:"relative",children:[e.jsx(ve,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(le,{type:"date",className:`h-10 pl-10 ${m.delivery_date?"border-red-500":"border-gray-300"}`,value:l.delivery_date,min:new Date().toISOString().split("T")[0],onChange:s=>{D(g(h({},l),{delivery_date:s.target.value})),m.delivery_date&&M(g(h({},m),{delivery_date:""}))}})]}),m.delivery_date&&e.jsxs("div",{className:"flex items-center gap-2 text-red-600 text-sm",children:[e.jsx(G,{className:"h-3 w-3"}),e.jsx("span",{children:m.delivery_date})]})]}),l.requested_sizes.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{className:"text-sm font-medium text-gray-700",children:"Notes (Optional)"}),e.jsx(He,{placeholder:"Special requirements, delivery instructions, etc...",className:"h-20 border-gray-300 resize-none",value:l.notes,onChange:s=>D(g(h({},l),{notes:s.target.value}))})]}),m.inventory&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(G,{className:"h-5 w-5 text-red-600"}),e.jsx("p",{className:"text-red-800 font-medium",children:"Inventory Insufficient"})]}),e.jsx("p",{className:"text-red-700 text-sm mt-1",children:m.inventory})]}),(l.use_any_size&&l.requested_quantity||!l.use_any_size&&l.requested_sizes.length>0)&&l.price_per_kg&&e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-6 border border-blue-200 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-xl",children:e.jsx(Ne,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Order Summary"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Review your order details"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-white rounded-xl border border-gray-200 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Quantity"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.use_any_size?`${l.requested_quantity} kg`:`${Object.values(l.size_quantities).reduce((s,t)=>s+t,0).toFixed(1)} kg`})]}),e.jsxs("div",{className:"text-center p-4 bg-white rounded-xl border border-gray-200 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Price per kg"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["KES ",parseFloat(l.price_per_kg||"0").toLocaleString()]})]}),e.jsxs("div",{className:"text-center p-4 bg-gradient-to-br from-blue-50 to-purple-50 rounded-xl border border-blue-200 shadow-sm",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Total Value"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:["KES ",((l.use_any_size?parseFloat(l.requested_quantity||"0"):Object.values(l.size_quantities).reduce((s,t)=>s+t,0))*parseFloat(l.price_per_kg||"0")).toLocaleString()]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t border-gray-200",children:[e.jsx(y,{variant:"outline",onClick:()=>{se(!1),M({})},className:"px-8 py-3 text-base border-gray-300 hover:bg-gray-50",disabled:ge,children:"Cancel"}),e.jsx(y,{onClick:fs,disabled:ge||!l.outlet_id||!l.use_any_size&&l.requested_sizes.length===0||!l.price_per_kg||!l.requested_grade,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 px-8 py-3 text-base disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:ge?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating Order..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Create Order"]})})]})]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[e.jsx(R,{className:"border-0 shadow-xl bg-gradient-to-br from-blue-50 to-blue-100 hover:shadow-2xl transition-all duration-300",children:e.jsx(B,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-blue-600 uppercase tracking-wide",children:"Total Orders"}),e.jsx("p",{className:"text-4xl font-bold text-blue-900 mt-2",children:X.totalOrders})]}),e.jsx("div",{className:"p-4 bg-blue-600 rounded-2xl shadow-lg",children:e.jsx(be,{className:"h-8 w-8 text-white"})})]})})}),e.jsx(R,{className:"border-0 shadow-xl bg-gradient-to-br from-amber-50 to-amber-100 hover:shadow-2xl transition-all duration-300",children:e.jsx(B,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-amber-600 uppercase tracking-wide",children:"Pending"}),e.jsx("p",{className:"text-4xl font-bold text-amber-900 mt-2",children:X.pendingOrders})]}),e.jsx("div",{className:"p-4 bg-amber-600 rounded-2xl shadow-lg",children:e.jsx(Y,{className:"h-8 w-8 text-white"})})]})})}),e.jsx(R,{className:"border-0 shadow-xl bg-gradient-to-br from-emerald-50 to-emerald-100 hover:shadow-2xl transition-all duration-300",children:e.jsx(B,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-emerald-600 uppercase tracking-wide",children:"Confirmed"}),e.jsx("p",{className:"text-4xl font-bold text-emerald-900 mt-2",children:X.confirmedOrders})]}),e.jsx("div",{className:"p-4 bg-emerald-600 rounded-2xl shadow-lg",children:e.jsx(E,{className:"h-8 w-8 text-white"})})]})})}),e.jsx(R,{className:"border-0 shadow-xl bg-gradient-to-br from-purple-50 to-purple-100 hover:shadow-2xl transition-all duration-300",children:e.jsx(B,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-purple-600 uppercase tracking-wide",children:"Total Quantity"}),e.jsx("p",{className:"text-4xl font-bold text-purple-900 mt-2",children:X.totalQuantity}),e.jsx("p",{className:"text-sm text-purple-600",children:"kg"})]}),e.jsx("div",{className:"p-4 bg-purple-600 rounded-2xl shadow-lg",children:e.jsx(_e,{className:"h-8 w-8 text-white"})})]})})}),e.jsx(R,{className:"border-0 shadow-xl bg-gradient-to-br from-green-50 to-green-100 hover:shadow-2xl transition-all duration-300",children:e.jsx(B,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-green-600 uppercase tracking-wide",children:"Total Value"}),e.jsx("p",{className:"text-3xl font-bold text-green-900 mt-2",children:U(X.totalValue)})]}),e.jsx("div",{className:"p-4 bg-green-600 rounded-2xl shadow-lg",children:e.jsx(Es,{className:"h-8 w-8 text-white"})})]})})})]}),e.jsxs(R,{className:"border-0 shadow-2xl bg-white/80 backdrop-blur-sm",children:[e.jsx(Ss,{className:"pb-6 bg-gradient-to-r from-gray-50 to-gray-100 rounded-t-3xl",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs(Os,{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(Ts,{className:"h-8 w-8 text-purple-600"}),"Orders Management"]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(y,{variant:S==="all"?"default":"outline",size:"sm",onClick:()=>ae("all"),className:`flex items-center gap-2 ${S==="all"?"bg-blue-600 hover:bg-blue-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(V,{className:"h-4 w-4"}),"All Orders (",u.length,")"]}),e.jsxs(y,{variant:S==="pending"?"default":"outline",size:"sm",onClick:()=>ae("pending"),className:`flex items-center gap-2 ${S==="pending"?"bg-yellow-600 hover:bg-yellow-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(Y,{className:"h-4 w-4"}),"Pending (",u.filter(s=>s.status==="pending").length,")"]}),e.jsxs(y,{variant:S==="confirmed"?"default":"outline",size:"sm",onClick:()=>ae("confirmed"),className:`flex items-center gap-2 ${S==="confirmed"?"bg-green-600 hover:bg-green-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(Us,{className:"h-4 w-4"}),"Approved (",u.filter(s=>s.status==="confirmed").length,")"]}),e.jsxs(y,{variant:S==="cancelled"?"default":"outline",size:"sm",onClick:()=>ae("cancelled"),className:`flex items-center gap-2 ${S==="cancelled"?"bg-red-600 hover:bg-red-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(we,{className:"h-4 w-4"}),"Discarded (",u.filter(s=>s.status==="cancelled").length,")"]})]})]})}),e.jsx(B,{className:"p-8",children:Me().length===0?e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx("div",{className:"p-4 bg-gray-100 rounded-full",children:e.jsx(V,{className:"h-8 w-8 text-gray-400"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:["No ",S==="all"?"":S," orders found"]}),e.jsx("p",{className:"text-gray-500",children:S==="all"?"No orders have been created yet.":`No ${S} orders at the moment.`})]})]})}):e.jsx("div",{className:"space-y-6",children:Me().map(s=>{var t,a,n,i;return e.jsx("div",{className:`border-2 rounded-3xl p-8 hover:shadow-xl transition-all duration-300 ${s.status==="dispatched"?"border-green-200 bg-gradient-to-r from-green-50 to-emerald-50 hover:from-green-100 hover:to-emerald-100":"border-gray-100 bg-gradient-to-r from-white to-gray-50 hover:from-blue-50 hover:to-purple-50"}`,children:e.jsxs("div",{className:"flex flex-col xl:flex-row justify-between items-start xl:items-center gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Te(s.status),e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["Order #",s.order_number||s.id]}),s.status==="dispatched"&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs font-medium",children:"Dispatched"})]})]}),e.jsx(P,{className:`text-sm font-semibold px-4 py-2 rounded-xl ${Ee(s.status)}`,children:s.status.toUpperCase()}),s.requested_grade!=="any"&&e.jsxs(P,{variant:"secondary",className:"text-sm px-3 py-1 bg-indigo-100 text-indigo-700 rounded-xl",children:["Grade ",s.requested_grade]}),e.jsx(P,{variant:"outline",className:"text-sm px-3 py-1 bg-orange-100 text-orange-700 border-orange-200 rounded-xl",children:Ue(s.requested_sizes||[])})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(Ze,{className:"h-5 w-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:((t=s.outlet)==null?void 0:t.name)||"Unknown Outlet"}),e.jsx("div",{className:"text-sm text-gray-500",children:((a=s.outlet)==null?void 0:a.location)||"Unknown Location"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(Ls,{className:"h-5 w-5 text-green-500"}),e.jsx("span",{className:"text-sm font-medium",children:((n=s.outlet)==null?void 0:n.phone)||"Unknown Phone"})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(ve,{className:"h-5 w-5 text-purple-500"}),e.jsx("span",{className:"text-sm font-medium",children:new Date(s.order_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex items-center gap-3 text-gray-700",children:[e.jsx(_e,{className:"h-5 w-5 text-cyan-500"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.requested_quantity,"kg requested"]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-6 text-base text-gray-700",children:[e.jsxs("span",{className:"bg-gray-100 px-4 py-2 rounded-xl",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Sizes:"})," ",((i=s.requested_sizes)==null?void 0:i.join(", "))||"Any"]}),e.jsxs("span",{className:"bg-gray-100 px-4 py-2 rounded-xl",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Quantity:"})," ",s.requested_quantity,"kg"]}),e.jsxs("span",{className:"bg-gray-100 px-4 py-2 rounded-xl",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Price:"})," ",U(s.price_per_kg||0),"/kg"]})]}),s.notes&&e.jsxs("div",{className:"text-base text-gray-700 bg-gradient-to-r from-blue-50 to-purple-50 p-4 rounded-2xl border-l-4 border-blue-400",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"Notes:"})," ",s.notes]})]}),e.jsxs("div",{className:"flex flex-col items-end gap-4 min-w-fit",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:U(s.total_value)}),e.jsx("div",{className:"text-sm text-gray-500 font-medium",children:"Total Value"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(y,{variant:"outline",size:"sm",onClick:()=>Ns(s.id),className:"px-3 py-2 border-gray-300 hover:bg-gray-50",children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"View"]}),s.status==="pending"&&e.jsx(y,{size:"sm",onClick:()=>Le(s.id),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2",children:"Confirm"}),s.status==="confirmed"&&e.jsxs(y,{size:"sm",onClick:()=>N("dispatch",s.id),className:"bg-blue-600 hover:bg-blue-700 text-white px-3 py-2",children:[e.jsx(ne,{className:"h-4 w-4 mr-1"}),"View Dispatch"]})]})]})]})},s.id)})})})]})]}),e.jsx(de,{open:ls,onOpenChange:he,children:e.jsxs(ce,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(oe,{children:[e.jsxs(me,{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(V,{className:"h-6 w-6 text-orange-600"}),"Pick Items from Inventory"]}),e.jsx(xe,{children:"Select items from available inventory to fulfill this order. Items will be deducted from inventory automatically."})]}),A&&e.jsxs("div",{className:"space-y-6 py-4",children:[(()=>{var s,t;const a=u.find(n=>n.id===A);return a?e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-xl border border-blue-200",children:[e.jsxs("h3",{className:"font-bold text-lg text-blue-900 mb-4 flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5"}),"Order Requirements"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Outlet:"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:((s=a.outlet)==null?void 0:s.name)||"Unknown Outlet"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Requested Quantity:"}),e.jsxs("span",{className:"text-gray-900 font-semibold",children:[a.requested_quantity,"kg"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Requested Sizes:"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:((t=a.requested_sizes)==null?void 0:t.join(", "))||"Any"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Grade:"}),e.jsxs(P,{className:a.requested_grade==="A"?"bg-green-100 text-green-800":a.requested_grade==="B"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",children:["Grade ",a.requested_grade]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Price per kg:"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:U(a.price_per_kg||0)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-700 font-medium",children:"Total Value:"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:U(a.total_value)})]})]})]}):null})(),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold text-lg text-gray-900 flex items-center gap-2",children:[e.jsx(Cs,{className:"h-5 w-5 text-green-600"}),"Available Inventory"]}),(()=>{const s=u.find(a=>a.id===A);if(!s)return null;const t=Ve(s).reduce((a,n)=>a+(n.total_quantity||0),0);return e.jsx("div",{className:"bg-green-50 px-3 py-1 rounded-full",children:e.jsxs("span",{className:"text-sm font-medium text-green-800",children:[t," pieces available"]})})})()]}),e.jsx("div",{className:"grid gap-4 max-h-96 overflow-y-auto",children:(()=>{const s=u.find(a=>a.id===A);if(!s)return null;const t=Ve(s);return t.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(V,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No inventory items match the order requirements"})]}):t.map(a=>{var n;return e.jsx("div",{className:"border border-gray-200 rounded-xl p-4 bg-white hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 text-lg",children:["Size ",a.final_size||"Unknown"," Fish"]}),e.jsxs(P,{className:a.final_grade==="A"?"bg-green-100 text-green-800":a.final_grade==="B"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",children:["Grade ",a.final_grade||"Unknown"]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 mb-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-800",children:"Available Quantity:"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-bold text-blue-900",children:[a.total_quantity||0," pieces"]}),e.jsxs("span",{className:"text-sm font-medium text-gray-600",children:["(",a.total_weight?a.total_weight.toFixed(1):"0.0"," kg)"]}),a.total_quantity&&a.total_quantity<=10&&e.jsx(P,{className:"bg-orange-100 text-orange-800 border-orange-200 text-xs",children:"Low Stock"})]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ze,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Storage Location:"})]}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:a.storage_location||"Processing Area"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-500 text-xs font-medium",children:"Processing Date"}),e.jsx("span",{className:"text-gray-900 font-semibold",children:a.processing_date?new Date(a.processing_date).toLocaleDateString():"N/A"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-gray-500 text-xs font-medium",children:"Farmer"}),e.jsx("span",{className:"text-gray-900 font-semibold truncate",children:a.farmer_name||"Unknown"})]})]})]}),e.jsx("div",{className:"flex items-center gap-3 ml-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{size:"sm",variant:"outline",onClick:()=>ws(a,1),className:"border-blue-200 text-blue-700 hover:bg-blue-50",children:e.jsx(Ms,{className:"h-4 w-4"})}),e.jsx("span",{className:"text-sm font-medium min-w-[2rem] text-center",children:((n=q.find(i=>i.inventoryItem.id===a.id))==null?void 0:n.quantity)||0}),e.jsx(y,{size:"sm",variant:"outline",onClick:()=>{const i=q.find(r=>r.inventoryItem.id===a.id);i&&i.quantity>0&&qs(a.id,i.quantity-1)},className:"border-blue-200 text-blue-700 hover:bg-blue-50",children:e.jsx(Qe,{className:"h-4 w-4"})})]})})]})},a.id)})})()})]}),q.length>0&&e.jsxs("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 p-6 rounded-xl border border-green-200",children:[e.jsxs("h3",{className:"font-bold text-lg text-green-900 mb-4 flex items-center gap-2",children:[e.jsx(E,{className:"h-5 w-5"}),"Selected Items Summary"]}),e.jsxs("div",{className:"space-y-3",children:[q.map(s=>e.jsxs("div",{className:"flex justify-between items-center bg-white p-3 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"font-medium text-gray-900",children:["Size ",s.inventoryItem.final_size||"Unknown"," - Grade ",s.inventoryItem.final_grade||"Unknown"]}),e.jsxs(P,{variant:"outline",className:"bg-blue-50 text-blue-700",children:[s.quantity," pieces"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[s.weight.toFixed(1),"kg"]}),e.jsx(y,{size:"sm",variant:"outline",onClick:()=>Ge(s.inventoryItem.id),className:"border-red-200 text-red-700 hover:bg-red-50",children:e.jsx(Qe,{className:"h-4 w-4"})})]})]},s.inventoryItem.id)),e.jsx("div",{className:"border-t pt-3 mt-3",children:e.jsxs("div",{className:"flex justify-between items-center font-semibold text-green-900",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:[q.reduce((s,t)=>s+t.quantity,0)," pieces â€¢ "," ",q.reduce((s,t)=>s+t.weight,0).toFixed(1),"kg"]})]})})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-4 pt-4 border-t",children:[e.jsx(y,{variant:"outline",onClick:()=>{he(!1),W([]),Fe(null)},className:"px-6 py-2",children:"Cancel"}),e.jsxs(y,{onClick:vs,disabled:q.length===0,className:"px-6 py-2 bg-orange-600 hover:bg-orange-700 text-white disabled:bg-gray-300 disabled:cursor-not-allowed",children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Dispatch Order"]})]})]})]})}),e.jsx(de,{open:ns,onOpenChange:Q,children:e.jsxs(ce,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(oe,{children:[e.jsxs(me,{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(Ne,{className:"h-6 w-6 text-blue-600"})}),"Order Details - ",(d==null?void 0:d.order_number)||(d==null?void 0:d.id)]}),e.jsx(xe,{className:"text-gray-600",children:"Complete information for this outlet order"})]}),d&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-6 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[Te(d.status),e.jsx(P,{className:`text-sm font-semibold px-4 py-2 rounded-xl ${Ee(d.status)}`,children:d.status.toUpperCase()}),d.requested_grade!=="any"&&e.jsxs(P,{variant:"secondary",className:"text-sm px-3 py-1 bg-indigo-100 text-indigo-700 rounded-xl",children:["Grade ",d.requested_grade]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:U(d.total_value)}),e.jsx("div",{className:"text-sm text-gray-500 font-medium",children:"Total Value"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Order Date:"}),e.jsx("span",{className:"text-sm text-gray-900",children:new Date(d.order_date).toLocaleDateString()})]}),d.delivery_date&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Delivery Date:"}),e.jsx("span",{className:"text-sm text-gray-900",children:new Date(d.delivery_date).toLocaleDateString()})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-4 w-4 text-cyan-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Quantity:"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[d.requested_quantity,"kg"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gs,{className:"h-4 w-4 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Price per kg:"}),e.jsx("span",{className:"text-sm text-gray-900",children:U(d.price_per_kg||0)})]})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Vs,{className:"h-5 w-5 text-blue-600"}),"Outlet Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Outlet Name:"}),e.jsx("p",{className:"text-sm text-gray-900 font-semibold",children:((b=d.outlet)==null?void 0:b.name)||"Unknown Outlet"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Location:"}),e.jsx("p",{className:"text-sm text-gray-900",children:((_=d.outlet)==null?void 0:_.location)||"Unknown Location"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Phone:"}),e.jsx("p",{className:"text-sm text-gray-900",children:((Z=d.outlet)==null?void 0:Z.phone)||"Unknown Phone"})]}),((J=d.outlet)==null?void 0:J.manager_name)&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Manager:"}),e.jsx("p",{className:"text-sm text-gray-900",children:d.outlet.manager_name})]})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(V,{className:"h-5 w-5 text-orange-600"}),"Order Specifications"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Requested Sizes:"}),e.jsx("div",{className:"mt-2 flex flex-wrap gap-2",children:d.requested_sizes&&d.requested_sizes.length>0?d.requested_sizes.map((s,t)=>e.jsxs(P,{variant:"outline",className:"bg-orange-50 text-orange-700 border-orange-200",children:["Size ",s]},t)):e.jsx(P,{variant:"outline",className:"bg-gray-50 text-gray-700",children:"Any Size"})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Grade Preference:"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:d.requested_grade==="any"?"Any Grade Available":`Grade ${d.requested_grade}`})]})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Quantity Breakdown:"}),e.jsxs("div",{className:"mt-2 bg-gray-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Weight:"}),e.jsxs("span",{className:"text-sm font-semibold text-gray-900",children:[d.requested_quantity,"kg"]})]}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Price per kg:"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:U(d.price_per_kg||0)})]}),e.jsxs("div",{className:"flex justify-between items-center mt-1 pt-2 border-t border-gray-200",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Total Value:"}),e.jsx("span",{className:"text-sm font-bold text-gray-900",children:U(d.total_value)})]})]})]})})]})]}),d.notes&&e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(Ne,{className:"h-5 w-5 text-gray-600"}),"Order Notes"]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("p",{className:"text-sm text-gray-700",children:d.notes})})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[e.jsx(y,{variant:"outline",onClick:()=>Q(!1),className:"flex-1",children:"Close"}),d.status==="pending"&&e.jsx(y,{onClick:()=>{Le(d.id),Q(!1)},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:"Confirm Order"}),d.status==="confirmed"&&e.jsxs(y,{onClick:()=>{N("dispatch",d.id),Q(!1)},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"View Dispatch"]}),d.status==="dispatched"&&e.jsxs(y,{onClick:()=>{N("dispatch",d.id),Q(!1)},className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Check Dispatch Page"]})]})]})]})}),e.jsx(de,{open:cs,onOpenChange:te,children:e.jsxs(ce,{className:"max-w-2xl",children:[e.jsxs(oe,{children:[e.jsxs(me,{className:"text-2xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(as,{className:"h-6 w-6 text-blue-600"})}),"Confirm Order"]}),e.jsx(xe,{className:"text-gray-600",children:"Review and confirm this order. Select who is confirming and choose to approve or discard."})]}),p&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3",children:"Order Summary"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Order Number:"}),e.jsx("span",{className:"ml-2 font-medium",children:p.order_number||p.id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Outlet:"}),e.jsx("span",{className:"ml-2 font-medium",children:((ee=L.find(s=>s.id===p.outlet_id))==null?void 0:ee.name)||"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Quantity:"}),e.jsxs("span",{className:"ml-2 font-medium",children:[p.requested_quantity," kg"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Total Value:"}),e.jsxs("span",{className:"ml-2 font-medium",children:["KES ",p.total_value.toLocaleString()]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{className:"text-sm font-medium text-gray-700",children:"Confirmed By"}),e.jsx("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(as,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:(w==null?void 0:w.email)||"Current User"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Logged in user"})]})]})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{className:"text-sm font-medium text-gray-700",children:"Action *"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"approve",name:"action",value:"approve",checked:T.action==="approve",onChange:s=>re(t=>g(h({},t),{action:s.target.value})),className:"h-4 w-4 text-green-600"}),e.jsxs(F,{htmlFor:"approve",className:"flex items-center gap-2 text-green-700",children:[e.jsx(E,{className:"h-4 w-4"}),"Approve Order"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"discard",name:"action",value:"discard",checked:T.action==="discard",onChange:s=>re(t=>g(h({},t),{action:s.target.value})),className:"h-4 w-4 text-red-600"}),e.jsxs(F,{htmlFor:"discard",className:"flex items-center gap-2 text-red-700",children:[e.jsx(we,{className:"h-4 w-4"}),"Discard Order"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(F,{className:"text-sm font-medium text-gray-700",children:"Notes (Optional)"}),e.jsx(He,{placeholder:"Add any notes about this confirmation...",className:"h-20 resize-none",value:T.notes,onChange:s=>re(t=>g(h({},t),{notes:s.target.value}))})]})]}),e.jsxs(Ps,{className:"flex gap-3",children:[e.jsx(y,{variant:"outline",onClick:()=>te(!1),disabled:pe,className:"flex-1",children:"Cancel"}),e.jsx(y,{onClick:ys,disabled:pe,className:`flex-1 ${T.action==="approve"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"} text-white`,children:pe?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):e.jsx(e.Fragment,{children:T.action==="approve"?e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Approve Order"]}):e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Discard Order"]})})})]})]})]})})]})}export{wt as default};
