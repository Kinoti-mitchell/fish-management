import{w as x,c as e,$ as je,e as ue,n as h,f as pe,Y as w,Z as Be,F as Re,W as j,S as g,_ as U,B as $,a as W,b as fe,q as ze,P as Ge,O as qe,l as T,d as se,J as ae}from"./index-D0a7Ul_G.js";import{_ as H,j as M,C as Y,N as Z,P as m}from"./select-DqWpyIkf-D_8tzK0d-BBn-WGEA.js";import{v as Ue}from"./textarea-TOFJikG_-C72QqR98-D5hWOVfE.js";import{V as Ne,q as He,_ as ve,H as ye,C as be}from"./dialog-NtgNh5u1-2hJTriox-IAMkB2HC.js";import{getOrGenerateEntryCode as Me,generateUniqueEntryCode as Ye}from"./entryCodeGenerator-B82PSXKH-CycamVnB-BX21HUcr.js";import{v as Ze}from"./auditLogger-DsAnB0jd-BH5jyDaI-BCBSj_dH.js";import{p as F}from"./circle-check-big-BZ9nasO6-BWVBSi9U-D_bzRs9E.js";import{p as te}from"./plus-FJ0CIBRX-DLM2sgk0-DVYylXdR.js";import{c as re}from"./user-DBfDT442-BxnNG84M-Bt4n1aDq.js";import{o as Je}from"./map-pin-C-M6umvy-CUBiYWs8-BzOTRlrX.js";import{a as le}from"./weight-CtEhXJRi-DcPJONPf-CLEOuACO.js";import{y as ie}from"./dollar-sign-BhCk0N5D-BR4pe6-Y-C39FtWn3.js";import{r as we}from"./loader-circle-CqHSO3Z4-BnZJOCMy-z05WTHxy.js";import{n as Qe}from"./trending-up-DUO3gdV8-ywoZrOkl-C4LPeYLB.js";import{o as _e}from"./search-BLXOOEcj-BfErFHpQ-DLGkxSNR.js";import{y as Pe}from"./download-cYb9BEHt-BKKeRdQe-9aZ5Dx7S.js";import{a as Xe}from"./index-io8wS31O-C_L8DqSR-BTUohV_t.js";import{h as Ce}from"./calendar-CU6tj0PZ-Ucpt8Hnz-1IrCz7t9.js";import"./index-B7iGXlpc-YR4igk-O-CmE8Ucvu.js";import"./index-CEgc-Zw--jggqibQ8-DNEgScq_.js";var es=Object.defineProperty,ss=Object.defineProperties,as=Object.getOwnPropertyDescriptors,ke=Object.getOwnPropertySymbols,ts=Object.prototype.hasOwnProperty,rs=Object.prototype.propertyIsEnumerable,Se=(f,n,o)=>n in f?es(f,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):f[n]=o,u=(f,n)=>{for(var o in n||(n={}))ts.call(n,o)&&Se(f,o,n[o]);if(ke)for(var o of ke(n))rs.call(n,o)&&Se(f,o,n[o]);return f},p=(f,n)=>ss(f,as(n)),K=(f,n,o)=>new Promise((C,I)=>{var J=_=>{try{O(o.next(_))}catch(S){I(S)}},k=_=>{try{O(o.throw(_))}catch(S){I(S)}},O=_=>_.done?C(_.value):Promise.resolve(_.value).then(J,k);O((o=o.apply(f,n)).next())});function Ps({onNavigate:f}){const[n,o]=x.useState([]),[C,I]=x.useState([]),[J,k]=x.useState(!1),[O,_]=x.useState(!1),[S,ce]=x.useState(!1),[ne,L]=x.useState(null),[de,D]=x.useState(null),[t,P]=x.useState({farmerId:"",totalWeight:"",totalPieces:"",pricePerKg:"",condition:"",fishType:"",notes:""}),[l,b]=x.useState({}),[V,oe]=x.useState(""),[A,me]=x.useState("all"),[Q,Ee]=x.useState(!0),[N,B]=x.useState(null),[R,Te]=x.useState(new Set),[z,$e]=x.useState(!0),We=s=>{switch(s){case"excellent":return"excellent";case"good":return"good";case"fair":return"fair";default:return"good"}},xe=s=>{switch(s){case"excellent":return"excellent";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"good"}},Fe=s=>{const a=C.find(i=>i.id===s);return a?a.name:`Farmer ID: ${s}`},Ie=s=>{const a=s.reduce((i,c)=>{const r=c.farmer_id;return i[r]||(i[r]={farmer:C.find(d=>d.id===r)||{id:r,name:`Farmer ID: ${r}`,location:"Unknown"},entries:[],totalWeight:0,totalValue:0,totalPieces:0,entryCount:0}),i[r].entries.push(c),i[r].totalWeight+=c.total_weight,i[r].totalValue+=c.total_value,i[r].totalPieces+=c.total_pieces,i[r].entryCount+=1,i},{});return Object.values(a).sort((i,c)=>c.totalValue-i.totalValue)},Oe=s=>{const a=new Set(R);a.has(s)?a.delete(s):a.add(s),Te(a)},Ve=()=>K(this,null,function*(){try{const{data:s,error:a}=yield ae.from("farmers").select("*").eq("status","active").order("name");if(a)throw a;I(s||[])}catch(s){I([])}}),Ke=()=>K(this,null,function*(){try{const{data:s,error:a}=yield ae.from("warehouse_entries").select(`
          *,
          farmers!inner(name)
        `).order("created_at",{ascending:!1}).limit(20);if(a)throw a;const i=yield Promise.all((s||[]).map(c=>K(this,null,function*(){var r;const d=c.entry_code||(yield Me(c.id));return p(u({},c),{farmer_name:((r=c.farmers)==null?void 0:r.name)||`Farmer ID: ${c.farmer_id}`,entry_code:d})})));o(i)}catch(s){o([])}});x.useEffect(()=>{Ve(),Ke()},[]);const Le=()=>{const s={};return t.farmerId||(s.farmerId="Please select a farmer"),(!t.totalWeight||parseFloat(t.totalWeight)<=0)&&(s.totalWeight="Please enter a valid weight"),(!t.totalPieces||parseInt(t.totalPieces)<=0)&&(s.totalPieces="Please enter valid number of pieces"),(!t.pricePerKg||parseFloat(t.pricePerKg)<=0)&&(s.pricePerKg="Please enter a valid price per kg"),t.condition||(s.condition="Please select a grade/condition"),t.fishType||(s.fishType="Please select a fish type"),b(s),Object.keys(s).length===0},De=(s,a,i,c,r)=>K(this,null,function*(){try{yield Ze.custom(s,a,i,{old_values:c,new_values:r})}catch(d){console.warn("Failed to log audit event:",d)}}),Ae=()=>K(this,null,function*(){if(Le()){ce(!0),L(null),D(null);try{const s=C.find(q=>q.id.toString()===t.farmerId||q.id===parseInt(t.farmerId));if(!s)throw new Error("Selected farmer not found");const a=parseFloat(t.totalWeight),i=parseFloat(t.pricePerKg),c=yield Ye(),r={entry_date:new Date().toISOString().split("T")[0],total_weight:a,total_pieces:parseInt(t.totalPieces),condition:We(t.condition),fish_type:t.fishType,farmer_id:s.id,price_per_kg:i,total_value:a*i,notes:t.notes.trim()||"",entry_code:c},{data:d,error:v}=yield ae.from("warehouse_entries").insert([r]).select();if(v)throw v;d&&d.length>0&&(o(q=>[d[0],...q]),yield De("INSERT","warehouse_entries",d[0].id,null,r)),P({farmerId:"",totalWeight:"",totalPieces:"",pricePerKg:"",condition:"",fishType:"",notes:""}),b({}),k(!1),D("Entry recorded successfully!"),setTimeout(()=>D(null),3e3)}catch(s){L("Failed to save entry: "+s.message)}finally{ce(!1)}}}),X=s=>{switch(xe(s)){case"excellent":return"bg-emerald-100 text-emerald-800 border-emerald-300";case"good":return"bg-blue-100 text-blue-800 border-blue-300";case"fair":return"bg-amber-100 text-amber-800 border-amber-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},he=s=>{switch(xe(s)){case"excellent":case"good":return e.jsx(F,{className:"h-4 w-4 text-green-600"});case"fair":return e.jsx(w,{className:"h-4 w-4 text-amber-600"});default:return e.jsx(F,{className:"h-4 w-4 text-gray-600"})}},y=s=>`KES ${s.toLocaleString()}`,ee=s=>new Date(s).toLocaleDateString("en-KE",{year:"numeric",month:"short",day:"numeric"}),E=n.filter(s=>{var a,i,c;const r=((a=s.farmer_name)==null?void 0:a.toLowerCase().includes(V.toLowerCase()))||((i=s.entry_code)==null?void 0:i.toLowerCase().includes(V.toLowerCase()))||((c=s.notes)==null?void 0:c.toLowerCase().includes(V.toLowerCase())),d=A==="all"||s.condition===A;return r&&d}),G=(()=>{const s=n.reduce((d,v)=>d+v.total_weight,0),a=n.reduce((d,v)=>d+v.total_value,0),i=n.reduce((d,v)=>d+v.total_pieces,0),c=n.length>0?a/s:0,r=n.reduce((d,v)=>(d[v.condition]=(d[v.condition]||0)+1,d),{});return{totalWeight:s,totalValue:a,totalPieces:i,avgPricePerKg:c,conditionCounts:r,totalEntries:n.length}})(),ge=()=>{const s=[["Entry Code","Date","Farmer","Weight (kg)","Pieces","Price/kg","Total Value","Condition","Notes"],...E.map(r=>[r.entry_code||"",r.entry_date,r.farmer_name||"",r.total_weight,r.total_pieces,r.price_per_kg,r.total_value,r.condition,r.notes||""])].map(r=>r.join(",")).join(`
`),a=new Blob([s],{type:"text/csv"}),i=window.URL.createObjectURL(a),c=document.createElement("a");c.href=i,c.download=`warehouse-entries-${new Date().toISOString().split("T")[0]}.csv`,c.click(),window.URL.revokeObjectURL(i)};return e.jsx("div",{className:"min-h-screen bg-gray-50 content-container responsive-padding",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[de&&e.jsxs(je,{className:"border-green-200 bg-green-50 text-green-800",children:[e.jsx(F,{className:"h-4 w-4"}),e.jsx(ue,{children:de}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>D(null),className:"ml-auto h-6 w-6 p-0",children:e.jsx(pe,{className:"h-4 w-4"})})]}),ne&&e.jsxs(je,{className:"border-red-200 bg-red-50 text-red-800",children:[e.jsx(w,{className:"h-4 w-4"}),e.jsx(ue,{children:ne}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>L(null),className:"ml-auto h-6 w-6 p-0",children:e.jsx(pe,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(Be,{className:"h-8 w-8 text-blue-600"}),"Warehouse Entry"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track fish deliveries and manage inventory"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(h,{variant:"outline",onClick:()=>Ee(!Q),children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),Q?"Hide Stats":"Show Stats"]}),e.jsx(h,{variant:"outline",onClick:()=>f("dashboard"),children:"Dashboard"}),e.jsxs(Ne,{open:J,onOpenChange:k,children:[e.jsx(He,{asChild:!0,children:e.jsxs(h,{className:"bg-blue-600 hover:bg-blue-700 text-white",size:"lg",children:[e.jsx(te,{className:"h-5 w-5 mr-2"}),"New Entry"]})}),e.jsxs(ve,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ye,{children:[e.jsxs(be,{className:"text-2xl flex items-center gap-3",children:[e.jsx(j,{className:"h-6 w-6 text-blue-600"}),"Record New Warehouse Entry"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Enter details for a new fish delivery from a farmer to the warehouse."})]}),e.jsxs("div",{className:"space-y-6 py-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),"Select Farmer *"]}),e.jsxs(H,{value:t.farmerId,onValueChange:s=>{P(p(u({},t),{farmerId:s})),l.farmerId&&b(p(u({},l),{farmerId:""}))},children:[e.jsx(M,{className:`h-12 ${l.farmerId?"border-red-300 focus:border-red-500":""}`,children:e.jsx(Y,{placeholder:"Choose a farmer..."})}),e.jsx(Z,{children:C.length>0?C.map(s=>e.jsx(m,{value:s.id.toString(),children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[e.jsx(Je,{className:"h-3 w-3"}),s.location]})]})})},s.id)):e.jsx(m,{value:"no-farmers",disabled:!0,children:"No active farmers found"})})]}),l.farmerId&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(w,{className:"h-3 w-3"}),l.farmerId]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),"Total Weight (kg) *"]}),e.jsx(U,{type:"number",step:"0.1",placeholder:"e.g. 150.5",value:t.totalWeight,onChange:s=>{P(p(u({},t),{totalWeight:s.target.value})),l.totalWeight&&b(p(u({},l),{totalWeight:""}))},className:`h-12 ${l.totalWeight?"border-red-300 focus:border-red-500":""}`}),l.totalWeight&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(w,{className:"h-3 w-3"}),l.totalWeight]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4"}),"Number of Pieces *"]}),e.jsx(U,{type:"number",placeholder:"e.g. 75",value:t.totalPieces,onChange:s=>{P(p(u({},t),{totalPieces:s.target.value})),l.totalPieces&&b(p(u({},l),{totalPieces:""}))},className:`h-12 ${l.totalPieces?"border-red-300 focus:border-red-500":""}`}),l.totalPieces&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(w,{className:"h-3 w-3"}),l.totalPieces]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Price per kg (KES) *"]}),e.jsx(U,{type:"number",placeholder:"e.g. 450",value:t.pricePerKg,onChange:s=>{P(p(u({},t),{pricePerKg:s.target.value})),l.pricePerKg&&b(p(u({},l),{pricePerKg:""}))},className:`h-12 ${l.pricePerKg?"border-red-300 focus:border-red-500":""}`}),l.pricePerKg&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(w,{className:"h-3 w-3"}),l.pricePerKg]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4"}),"Fish Type *"]}),e.jsxs(H,{value:t.fishType,onValueChange:s=>{P(p(u({},t),{fishType:s})),l.fishType&&b(p(u({},l),{fishType:""}))},children:[e.jsx(M,{className:`h-12 ${l.fishType?"border-red-300 focus:border-red-500":""}`,children:e.jsx(Y,{placeholder:"Select fish type..."})}),e.jsxs(Z,{children:[e.jsx(m,{value:"Nile Tilapia",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-blue-600"}),"Nile Tilapia (0.35kg avg)"]})}),e.jsx(m,{value:"Nile Perch",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-green-600"}),"Nile Perch (1.20kg avg)"]})}),e.jsx(m,{value:"African Catfish",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-purple-600"}),"African Catfish (0.65kg avg)"]})}),e.jsx(m,{value:"Silver Cyprinid",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-gray-600"}),"Silver Cyprinid (0.15kg avg)"]})}),e.jsx(m,{value:"African Lungfish",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-orange-600"}),"African Lungfish (0.80kg avg)"]})}),e.jsx(m,{value:"Blue-spotted Tilapia",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-cyan-600"}),"Blue-spotted Tilapia (0.30kg avg)"]})}),e.jsx(m,{value:"Marbled Lungfish",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-red-600"}),"Marbled Lungfish (0.75kg avg)"]})}),e.jsx(m,{value:"Electric Catfish",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-yellow-600"}),"Electric Catfish (0.55kg avg)"]})}),e.jsx(m,{value:"Mixed Batch",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-4 w-4 text-indigo-600"}),"Mixed Batch (0.50kg avg)"]})})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Select the primary fish type. This helps with accurate processing and sorting."}),l.fishType&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(w,{className:"h-3 w-3"}),l.fishType]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{className:"text-base font-medium",children:"Grade/Quality *"}),e.jsxs(H,{value:t.condition,onValueChange:s=>{P(p(u({},t),{condition:s})),l.condition&&b(p(u({},l),{condition:""}))},children:[e.jsx(M,{className:`h-12 ${l.condition?"border-red-300 focus:border-red-500":""}`,children:e.jsx(Y,{placeholder:"Select quality grade..."})}),e.jsxs(Z,{children:[e.jsx(m,{value:"excellent",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4 text-green-600"}),"Excellent (Grade A)"]})}),e.jsx(m,{value:"good",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{className:"h-4 w-4 text-blue-600"}),"Good (Grade B)"]})}),e.jsx(m,{value:"fair",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-4 w-4 text-amber-600"}),"Fair (Grade C)"]})})]})]}),l.condition&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(w,{className:"h-3 w-3"}),l.condition]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{className:"text-base font-medium",children:"Additional Notes"}),e.jsx(Ue,{placeholder:"Any special notes about this delivery...",value:t.notes,onChange:s=>P(p(u({},t),{notes:s.target.value})),className:"h-12 min-h-[48px]"})]})]}),t.totalWeight&&t.pricePerKg&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"text-sm text-blue-700 mb-1",children:"Total Value"}),e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:y(parseFloat(t.totalWeight)*parseFloat(t.pricePerKg))})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t",children:[e.jsx(h,{variant:"outline",onClick:()=>{k(!1),b({}),L(null)},disabled:S,children:"Cancel"}),e.jsx(h,{onClick:Ae,disabled:S,className:"bg-blue-600 hover:bg-blue-700",children:S?e.jsxs(e.Fragment,{children:[e.jsx(we,{className:"h-4 w-4 mr-2 animate-spin"}),"Recording..."]}):e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"h-4 w-4 mr-2"}),"Record Entry"]})})]})]})]})]})]})]}),Q&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx($,{children:e.jsx(W,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Weight"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[G.totalWeight.toFixed(1)," kg"]})]}),e.jsx(le,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx($,{children:e.jsx(W,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Value"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:y(G.totalValue)})]}),e.jsx(ie,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx($,{children:e.jsx(W,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Pieces"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:G.totalPieces.toLocaleString()})]}),e.jsx(fe,{className:"h-8 w-8 text-purple-600"})]})})}),e.jsx($,{children:e.jsx(W,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Price/kg"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:y(G.avgPricePerKg)})]}),e.jsx(Qe,{className:"h-8 w-8 text-orange-600"})]})})})]}),e.jsx($,{children:e.jsx(W,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(_e,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(U,{placeholder:"Search entries by farmer, code, or notes...",value:V,onChange:s=>oe(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(H,{value:A,onValueChange:me,children:[e.jsxs(M,{className:"w-40",children:[e.jsx(ze,{className:"h-4 w-4 mr-2"}),e.jsx(Y,{placeholder:"Filter by condition"})]}),e.jsxs(Z,{children:[e.jsx(m,{value:"all",children:"All Conditions"}),e.jsx(m,{value:"excellent",children:"Excellent"}),e.jsx(m,{value:"good",children:"Good"}),e.jsx(m,{value:"fair",children:"Fair"})]})]}),e.jsxs(h,{variant:z?"default":"outline",size:"sm",onClick:()=>$e(!z),className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),z?"Group by Farmer":"List View"]}),e.jsxs(h,{variant:"outline",onClick:ge,disabled:E.length===0,children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Export"]})]})]})})}),e.jsxs($,{children:[e.jsx(Ge,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(qe,{className:"flex items-center gap-2",children:[e.jsx(j,{className:"h-5 w-5 text-blue-600"}),"Warehouse Entries",e.jsxs(T,{variant:"secondary",children:[E.length," of ",n.length," entries"]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(h,{variant:"outline",size:"sm",onClick:ge,disabled:E.length===0,children:[e.jsx(Pe,{className:"h-4 w-4 mr-1"}),"Export"]})})]})}),e.jsx(W,{children:O?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(we,{className:"h-8 w-8 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading entries..."})]}):E.length>0?z?e.jsx("div",{className:"space-y-4",children:Ie(E).map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 p-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Oe(s.farmer.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.farmer.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.farmer.location})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(fe,{className:"h-4 w-4"}),s.entryCount," entries"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"h-4 w-4"}),s.totalWeight.toFixed(1),"kg"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"h-4 w-4"}),y(s.totalValue)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(T,{variant:"outline",className:"text-xs",children:R.has(s.farmer.id)?"Collapse":"Expand"}),e.jsx(Xe,{className:`h-4 w-4 text-gray-400 transition-transform ${R.has(s.farmer.id)?"rotate-180":""}`})]})]})}),R.has(s.farmer.id)&&e.jsx("div",{className:"divide-y divide-gray-100",children:s.entries.map(a=>e.jsxs("div",{className:"p-4 hover:bg-gray-50 transition-colors bg-white",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[he(a.condition),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ce,{className:"h-3 w-3"}),ee(a.entry_date)]}),e.jsx(T,{variant:"outline",className:"font-medium",children:a.entry_code})]})})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsx(T,{className:`${X(a.condition)} border`,children:a.condition}),e.jsxs("span",{className:"text-gray-600",children:[a.total_weight,"kg • ",a.total_pieces," pieces"]}),e.jsxs("span",{className:"text-gray-600",children:[y(a.price_per_kg),"/kg"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold text-gray-900 mb-2",children:y(a.total_value)}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(h,{size:"sm",variant:"outline",onClick:()=>B(a),children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),"View"]})})]})]}),a.notes&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded text-sm text-gray-600",children:[e.jsx("strong",{children:"Notes:"})," ",a.notes]})]},a.id))})]},s.farmer.id))}):e.jsx("div",{className:"divide-y divide-gray-100",children:E.map(s=>e.jsxs("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[he(s.condition),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:Fe(s.farmer_id)}),e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-500 mt-1",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ce,{className:"h-3 w-3"}),ee(s.entry_date)]})})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsx(T,{variant:"outline",className:"font-medium",children:s.entry_code}),e.jsx(T,{className:`${X(s.condition)} border`,children:s.condition}),e.jsxs("span",{className:"text-gray-600",children:[s.total_weight,"kg • ",s.total_pieces," pieces"]}),e.jsxs("span",{className:"text-gray-600",children:[y(s.price_per_kg),"/kg"]}),e.jsxs("span",{className:"text-gray-600 font-medium",children:["• ",s.farmer_name]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-3",children:y(s.total_value)}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(h,{size:"sm",variant:"outline",onClick:()=>B(s),children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),"View"]})})]})]}),s.notes&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded text-sm text-gray-600",children:[e.jsx("strong",{children:"Notes:"})," ",s.notes]})]},s.id))}):V||A!=="all"?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_e,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No entries match your search"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Try adjusting your search or filter criteria"}),e.jsxs("div",{className:"mt-4 flex gap-2 justify-center",children:[e.jsx(h,{variant:"outline",onClick:()=>{oe(""),me("all")},children:"Clear Filters"}),e.jsxs(h,{onClick:()=>k(!0),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"New Entry"]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(j,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No warehouse entries yet"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Start by recording your first fish delivery"}),e.jsxs(h,{onClick:()=>k(!0),className:"mt-4 bg-blue-600 hover:bg-blue-700",size:"lg",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Record First Entry"]})]})})]}),e.jsx(Ne,{open:!!N,onOpenChange:()=>B(null),children:e.jsxs(ve,{className:"max-w-2xl",children:[e.jsx(ye,{children:e.jsxs(be,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5 text-blue-600"}),"Entry Details"]})}),N&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Entry Code"}),e.jsx("p",{className:"text-lg font-semibold",children:N.entry_code})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Date"}),e.jsx("p",{className:"text-lg font-semibold",children:ee(N.entry_date)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Farmer"}),e.jsx("p",{className:"text-lg font-semibold",children:N.farmer_name})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Condition"}),e.jsx(T,{className:`${X(N.condition)} border`,children:N.condition})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Weight"}),e.jsxs("p",{className:"text-lg font-semibold",children:[N.total_weight," kg"]})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Pieces"}),e.jsx("p",{className:"text-lg font-semibold",children:N.total_pieces})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Price/kg"}),e.jsx("p",{className:"text-lg font-semibold",children:y(N.price_per_kg)})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Total Value"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:y(N.total_value)})]}),N.notes&&e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded",children:N.notes})]}),e.jsx("div",{className:"flex justify-end gap-2 pt-4 border-t",children:e.jsx(h,{variant:"outline",onClick:()=>B(null),children:"Close"})})]})]})})]})})}export{Ps as default};
