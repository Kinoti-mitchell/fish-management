var F=(t,s,l)=>new Promise((r,u)=>{var d=j=>{try{g(l.next(j))}catch(m){u(m)}},b=j=>{try{g(l.throw(j))}catch(m){u(m)}},g=j=>j.done?r(j.value):Promise.resolve(j.value).then(d,b);g((l=l.apply(t,s)).next())});import{s as O,r as h,j as e,p as B,e as ee,P as X,B as V,a as v,f as W,g as R,b as D,L as z,I as U,l as Y}from"./index-BsUmuyG4.js";import{S as ae,a as te,b as oe,c as re,d as le}from"./select-DpDEOpGc.js";import{D as ie,b as ne,c as ce,d as de,f as ge,e as me}from"./dialog-5_o2uvs1.js";import{D as xe}from"./dollar-sign-D8aCC5Ql.js";import{T as he}from"./trending-down-CsuMQ3XW.js";import{C as se}from"./clock-BAGB9i0B.js";import{S as pe}from"./scale-nOZOIHzY.js";import{A as ue}from"./activity-CfVImW7x.js";import{P as fe}from"./plus-6Z69TOmA.js";import{C as Z}from"./calendar-B_cPd3ko.js";import{M as be}from"./map-pin-H2p0nG-2.js";import"./index-CWowWWhq.js";import"./index-DPWWBWxf.js";import"./index-aBDulcc9.js";class je{getDisposalStats(){return F(this,null,function*(){try{console.log("ðŸ” [DisposalService] Fetching disposal statistics...");const{data:s,error:l}=yield O.from("disposal_records").select(`
          *,
          disposal_reason:disposal_reasons(name)
        `).order("created_at",{ascending:!1});if(l)throw console.error("âŒ [DisposalService] Error fetching disposal records:",l),l;console.log("ðŸ“Š [DisposalService] Disposal records:",(s==null?void 0:s.length)||0);const r=(s==null?void 0:s.length)||0,u=(s==null?void 0:s.reduce((i,n)=>i+(n.total_weight_kg||0),0))||0,d=(s==null?void 0:s.reduce((i,n)=>i+(n.disposal_cost||0),0))||0,b=(s==null?void 0:s.filter(i=>i.status==="pending").length)||0,g=new Date;g.setDate(g.getDate()-7);const j=(s==null?void 0:s.filter(i=>new Date(i.created_at)>=g).length)||0,m=(s==null?void 0:s.filter(i=>i.status==="completed"))||[];let q=0;m.length>0&&(q=m.reduce((n,N)=>{const S=new Date(N.created_at),I=new Date(N.disposal_date),C=Math.floor((I.getTime()-S.getTime())/(1e3*60*60*24));return n+C},0)/m.length);const _={};s==null||s.forEach(i=>{var N;const n=((N=i.disposal_reason)==null?void 0:N.name)||"Unknown";_[n]=(_[n]||0)+1});const E=Object.keys(_).reduce((i,n)=>_[i]>_[n]?i:n,"Age"),w=new Date,T=w.getMonth(),P=w.getFullYear(),x=T===0?11:T-1,o=T===0?P-1:P,c=(s==null?void 0:s.filter(i=>{const n=new Date(i.created_at);return n.getMonth()===T&&n.getFullYear()===P}).length)||0,f=(s==null?void 0:s.filter(i=>{const n=new Date(i.created_at);return n.getMonth()===x&&n.getFullYear()===o}).length)||0,y=f>0?(c-f)/f*100:0,p={totalDisposals:r,totalDisposedWeight:u,totalDisposalCost:d,pendingDisposals:b,recentDisposals:j,averageDisposalAge:q,topDisposalReason:E,monthlyDisposalTrend:y};return console.log("ðŸ“Š [DisposalService] Calculated stats:",p),p}catch(s){return console.error("âŒ [DisposalService] Error getting disposal stats:",s),{totalDisposals:0,totalDisposedWeight:0,totalDisposalCost:0,pendingDisposals:0,recentDisposals:0,averageDisposalAge:0,topDisposalReason:"Age",monthlyDisposalTrend:0}}})}getDisposalRecords(s=50,l=0){return F(this,null,function*(){try{const{data:r,error:u}=yield O.from("disposal_records").select(`
          *,
          disposal_reason:disposal_reasons(name)
        `).order("created_at",{ascending:!1}).range(l,l+s-1);if(u)throw u;return r||[]}catch(r){return console.error("Error fetching disposal records:",r),[]}})}getDisposalReasons(){return F(this,null,function*(){try{const{data:s,error:l}=yield O.from("disposal_reasons").select("*").eq("is_active",!0).order("name");if(l)throw l;return s||[]}catch(s){return console.error("Error fetching disposal reasons:",s),[]}})}getInventoryForDisposal(s=30,l=!0,r,u=!1,d,b){return F(this,null,function*(){try{console.log("ðŸ” [DisposalService] Getting inventory for disposal with improved filtering..."),console.log("ðŸ“Š [DisposalService] Filter criteria:",{daysOld:s,includeStorageIssues:l});const g=new Date;g.setDate(g.getDate()-s);const j=g.toISOString().split("T")[0];console.log("ðŸ“… [DisposalService] Cutoff date:",j);const{data:m,error:q}=yield O.from("storage_locations").select("id, name, status, capacity_kg, current_usage_kg").order("name");if(q)throw console.error("âŒ [DisposalService] Storage locations error:",q),q;console.log("ðŸ“ [DisposalService] Storage locations found:",(m==null?void 0:m.length)||0);const _=new Map;m==null||m.forEach(o=>{_.set(o.id,o)});let E=O.from("sorting_results").select(`
          id,
          size_class,
          total_pieces,
          total_weight_grams,
          storage_location_id,
          created_at,
          sorting_batch:sorting_batches(
            id,
            batch_number,
            status,
            created_at
          )
        `).not("storage_location_id","is",null).gt("total_weight_grams",0);E=E.eq("sorting_batch.status","completed");const{data:w,error:T}=yield E.order("created_at",{ascending:!1});if(T)throw console.error("âŒ [DisposalService] Query error:",T),T;console.log("ðŸ“Š [DisposalService] Raw query results:",(w==null?void 0:w.length)||0,"items");const P=(w||[]).filter(o=>{var S,I,C,k;const c=_.get(o.storage_location_id);if(!o.total_weight_grams||o.total_weight_grams<=0)return console.log("âŒ [DisposalService] Item filtered out - no weight:",o.id,o.total_weight_grams),!1;const f=((I=(S=o.sorting_batch)==null?void 0:S.created_at)==null?void 0:I.split("T")[0])||((C=o.created_at)==null?void 0:C.split("T")[0]);if(!f)return console.log("âŒ [DisposalService] Item filtered out - no processing date:",o.id),!1;const y=new Date(f);if(isNaN(y.getTime())||y>new Date)return console.log("âŒ [DisposalService] Item filtered out - invalid or future date:",o.id,f),!1;const p=Math.floor((new Date().getTime()-y.getTime())/(1e3*60*60*24));let i=!1;if(s===0?i=!0:r&&r>s?i=p>=s&&p<=r:i=p>=s,d||b){const A=f;let M=!0;if(d&&A<d&&(M=!1),b&&A>b&&(M=!1),!M)return console.log("âŒ [DisposalService] Item filtered out - not in date range:",o.id,A,"from:",d,"to:",b),!1}let n=!1;u?n=c&&c.status!=="active":l&&(n=!o.storage_location_id||!c||c.status!=="active"||c.current_usage_kg>c.capacity_kg);const N=i||n;return console.log("ðŸ” [DisposalService] Item check:",{id:o.id,batchNumber:(k=o.sorting_batch)==null?void 0:k.batch_number,processingDate:f,daysInStorage:p,weightGrams:o.total_weight_grams,isOldEnough:i,hasStorageIssues:n,storageStatus:c==null?void 0:c.status,isEligible:N}),N});console.log("ðŸ“Š [DisposalService] Eligible items after filtering:",P.length);const x=P.map(o=>{var i,n,N,S,I,C,k,A,M,H,L,Q,K,a;const c=_.get(o.storage_location_id),f=((n=(i=o.sorting_batch)==null?void 0:i.created_at)==null?void 0:n.split("T")[0])||((N=o.created_at)==null?void 0:N.split("T")[0]),y=Math.floor((new Date().getTime()-new Date(f).getTime())/(1e3*60*60*24));let p="Age";return o.storage_location_id?c?c.status!=="active"?p="Storage Inactive":c.current_usage_kg>c.capacity_kg?p="Storage Over Capacity":y>=s&&(p="Age"):p="Storage Not Found":p="No Storage Location",{sorting_result_id:o.id,size_class:o.size_class,total_pieces:o.total_pieces,total_weight_grams:o.total_weight_grams,batch_number:((S=o.sorting_batch)==null?void 0:S.batch_number)||"BATCH-"+((C=(I=o.sorting_batch)==null?void 0:I.id)==null?void 0:C.substring(0,8)),storage_location_name:(c==null?void 0:c.name)||"No Storage Assigned",farmer_name:((H=(M=(A=(k=o.sorting_batch)==null?void 0:k.processing_record)==null?void 0:A.warehouse_entry)==null?void 0:M.farmers)==null?void 0:H.name)||"Unknown Farmer",processing_date:f,days_in_storage:y,disposal_reason:p,quality_notes:`Fish from ${((a=(K=(Q=(L=o.sorting_batch)==null?void 0:L.processing_record)==null?void 0:Q.warehouse_entry)==null?void 0:K.farmers)==null?void 0:a.name)||"Unknown Farmer"}`,storage_status:(c==null?void 0:c.status)||"unknown"}});return console.log("ðŸ“Š [DisposalService] Transformed items:",x.length),x}catch(g){return console.error("âŒ [DisposalService] Error getting inventory for disposal:",g),[]}})}getInventoryForDisposalFallback(s=30){return F(this,null,function*(){try{const l=new Date;l.setDate(l.getDate()-s);const{data:r,error:u}=yield O.from("sorting_results").select(`
          id,
          size_class,
          total_weight_grams,
          batch_number,
          storage_location_name,
          farmer_name,
          processing_date,
          quality_notes,
          storage_locations!inner(status)
        `).eq("status","available").lte("processing_date",l.toISOString().split("T")[0]).gte("total_weight_grams",0);if(u)throw u;return(r==null?void 0:r.map(d=>{var b,g;return{sorting_result_id:d.id,size_class:d.size_class,total_weight_grams:d.total_weight_grams,batch_number:d.batch_number,storage_location_name:d.storage_location_name,storage_status:((b=d.storage_locations)==null?void 0:b.status)||"active",farmer_name:d.farmer_name,processing_date:d.processing_date,days_in_storage:Math.floor((new Date().getTime()-new Date(d.processing_date).getTime())/(1e3*60*60*24)),disposal_reason:((g=d.storage_locations)==null?void 0:g.status)==="inactive"?"Storage Inactive":"Age",quality_notes:d.quality_notes}}))||[]}catch(l){return console.error("Error in fallback method:",l),[]}})}}const J=new je;function ye({stats:t}){const[s,l]=h.useState([]);return h.useEffect(()=>{const r=[{id:"1",type:"warning",icon:e.jsx(B,{className:"h-5 w-5"}),text:`ðŸ—‘ï¸ Total Disposals: ${(t==null?void 0:t.totalDisposals)||0} records | ${((t==null?void 0:t.totalDisposedWeight)||0).toFixed(1)}kg disposed`,bgColor:"bg-orange-100",textColor:"text-orange-800"},{id:"2",type:"info",icon:e.jsx(xe,{className:"h-5 w-5"}),text:`ðŸ’° Disposal Costs: KES ${((t==null?void 0:t.totalDisposalCost)||0).toLocaleString()} total cost | ${((t==null?void 0:t.averageDisposalAge)||0).toFixed(1)} days avg age`,bgColor:"bg-red-100",textColor:"text-red-800"},{id:"3",type:"warning",icon:e.jsx(ee,{className:"h-5 w-5"}),text:`âš ï¸ Pending Disposals: ${(t==null?void 0:t.pendingDisposals)||0} awaiting approval | ${(t==null?void 0:t.recentDisposals)||0} this week`,bgColor:"bg-yellow-100",textColor:"text-yellow-800"},{id:"4",type:"info",icon:e.jsx(he,{className:"h-5 w-5"}),text:`ðŸ“‰ Disposal Trend: ${(t==null?void 0:t.monthlyDisposalTrend)||0}% change this month | Top reason: ${(t==null?void 0:t.topDisposalReason)||"Age"}`,bgColor:"bg-purple-100",textColor:"text-purple-800"},{id:"5",type:"info",icon:e.jsx(se,{className:"h-5 w-5"}),text:`â° Average Age: ${((t==null?void 0:t.averageDisposalAge)||0).toFixed(1)} days before disposal | Quality control active`,bgColor:"bg-indigo-100",textColor:"text-indigo-800"},{id:"6",type:"success",icon:e.jsx(X,{className:"h-5 w-5"}),text:"ðŸ“¦ Waste Management: Efficient disposal system | Environmental compliance maintained",bgColor:"bg-green-100",textColor:"text-green-800"},{id:"7",type:"info",icon:e.jsx(pe,{className:"h-5 w-5"}),text:"âš–ï¸ Quality Control: Automated disposal triggers | Storage optimization active",bgColor:"bg-blue-100",textColor:"text-blue-800"},{id:"8",type:"achievement",icon:e.jsx(ue,{className:"h-5 w-5"}),text:"ðŸŽ¯ Rio Fish Farm: Leading waste management practices in Kenya's fish industry",bgColor:"bg-emerald-100",textColor:"text-emerald-800"}];l(r)},[t]),e.jsx("div",{className:"w-full bg-gradient-to-r from-orange-50 to-red-50 border-b border-orange-200 shadow-sm overflow-hidden relative z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"relative py-2 sm:py-3 overflow-hidden",children:e.jsxs("div",{className:"flex animate-marquee-simple whitespace-nowrap",children:[s.map(r=>e.jsxs("div",{className:`flex items-center gap-2 sm:gap-3 px-3 sm:px-6 py-1 sm:py-2 rounded-full ${r.bgColor} ${r.textColor} font-medium text-xs sm:text-sm whitespace-nowrap mx-2 sm:mx-4 shadow-sm border flex-shrink-0`,children:[r.icon,e.jsx("span",{children:r.text})]},r.id)),s.map(r=>e.jsxs("div",{className:`flex items-center gap-2 sm:gap-3 px-3 sm:px-6 py-1 sm:py-2 rounded-full ${r.bgColor} ${r.textColor} font-medium text-xs sm:text-sm whitespace-nowrap mx-2 sm:mx-4 shadow-sm border flex-shrink-0`,children:[r.icon,e.jsx("span",{children:r.text})]},`duplicate-${r.id}`))]})})})})}const qe=()=>{var K;const[t,s]=h.useState([]),[l,r]=h.useState({totalDisposals:0,totalDisposedWeight:0,totalDisposalCost:0,pendingDisposals:0,recentDisposals:0,averageDisposalAge:0,topDisposalReason:"Age"}),[u,d]=h.useState([]),[b,g]=h.useState(!0),[j,m]=h.useState(!1),[q,_]=h.useState(!1),[E,w]=h.useState(!1),[T,P]=h.useState(null),[x,o]=h.useState(""),[c,f]=h.useState(30),[y,p]=h.useState([]),[i,n]=h.useState(""),[N,S]=h.useState(0),[I,C]=h.useState(""),k=[{value:"all",label:"All Items",description:"Show all available items",days:0},{value:"custom_age",label:"Custom Age",description:"Items older than specified days",days:0},{value:"inactive_storage",label:"Inactive Storage",description:"Items in inactive storage locations",days:0}];h.useEffect(()=>{A()},[]),h.useEffect(()=>{x&&x!==""&&M()},[x,c]);const A=()=>F(void 0,null,function*(){try{g(!0);const[a,$]=yield Promise.all([J.getDisposalRecords(),J.getDisposalStats()]);s(a),r($)}catch(a){console.error("Error loading disposal data:",a)}finally{g(!1)}}),M=()=>F(void 0,null,function*(){try{let a,$=!1;x==="custom_age"?a=c:x==="inactive_storage"&&($=!0);const G=yield J.getInventoryForDisposal(30,!0,a,$);d(G)}catch(a){console.error("Error loading inventory for disposal:",a),d([])}}),H=()=>F(void 0,null,function*(){if(y.length===0){alert("Please select at least one item for disposal");return}try{w(!0),console.log("Creating disposal with items:",y),L(),m(!1),yield A()}catch(a){console.error("Error creating disposal:",a)}finally{w(!1)}}),L=()=>{o(""),f(30),p([]),n(""),S(0),C("")},Q=a=>{p($=>$.includes(a)?$.filter(G=>G!==a):[...$,a])};return b?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading disposal data..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 content-container",children:[e.jsx(ye,{stats:l}),e.jsxs("div",{className:"container mx-auto responsive-padding max-w-full overflow-x-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Disposal Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage fish disposal and waste handling"})]}),e.jsxs(V,{className:"bg-red-600 hover:bg-red-700 text-white",onClick:()=>m(!0),children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),"Create Disposal"]})]}),e.jsx(ie,{open:j,onOpenChange:m,children:e.jsxs(ne,{className:"max-w-4xl w-[95vw] max-h-[90vh] overflow-y-auto overflow-x-hidden",children:[e.jsxs(ce,{children:[e.jsx(de,{className:"text-xl font-semibold",children:"Create New Disposal Record"}),e.jsx(ge,{children:"Configure disposal criteria and select items for disposal"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(v,{className:"shadow-lg border-0 bg-gradient-to-br from-blue-50 to-indigo-50 max-w-md mx-auto",children:[e.jsxs(W,{className:"pb-4",children:[e.jsxs(R,{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(X,{className:"w-5 h-5 text-blue-600"}),"Select Disposal Reason"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Choose why you want to dispose items"})]}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"ageCategory",className:"text-sm font-semibold text-gray-700",children:"Disposal Reason *"}),e.jsxs(ae,{value:x,onValueChange:o,children:[e.jsx(te,{className:"h-12 bg-white border-2 border-gray-200 hover:border-blue-300 focus:border-blue-500 transition-colors",children:e.jsx(oe,{placeholder:"Select disposal reason"})}),e.jsx(re,{children:k.map(a=>e.jsx(le,{value:a.value,children:e.jsxs("div",{className:"flex flex-col py-1",children:[e.jsx("span",{className:"font-medium text-gray-800",children:a.label}),e.jsx("span",{className:"text-xs text-gray-500",children:a.description})]})},a.value))})]})]})})]}),x&&x!==""&&e.jsxs("div",{className:"space-y-4",children:[x==="custom_age"&&e.jsxs(v,{className:"shadow-lg border-0 bg-gradient-to-br from-yellow-50 to-orange-50 max-w-md mx-auto",children:[e.jsxs(W,{className:"pb-4",children:[e.jsxs(R,{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5 text-orange-600"}),"Custom Age Threshold"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Set the minimum age in days for items to dispose"})]}),e.jsx(D,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"customDaysOld",className:"text-sm font-semibold text-gray-700",children:"Days Old Threshold *"}),e.jsx(U,{id:"customDaysOld",type:"number",value:c,onChange:a=>f(Number(a.target.value)),className:"h-12 bg-white border-2 border-gray-200 hover:border-orange-300 focus:border-orange-500 transition-colors",placeholder:"Enter days old threshold",min:"1"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 max-w-full overflow-x-hidden",children:[e.jsxs(v,{className:"shadow-lg border-0 bg-gradient-to-br from-blue-50 to-indigo-50",children:[e.jsxs(W,{className:"pb-4",children:[e.jsxs(R,{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(B,{className:"w-5 h-5 text-blue-600"}),"Filter Items for Disposal"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure criteria for selecting items"})]}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{className:"text-sm font-semibold text-gray-700",children:"Selected Reason"}),e.jsx("div",{className:"p-3 bg-white rounded-lg border border-gray-200",children:e.jsx(Y,{variant:"secondary",className:"text-sm",children:(K=k.find(a=>a.value===x))==null?void 0:K.label})})]}),x==="custom_age"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{className:"text-sm font-semibold text-gray-700",children:"Age Threshold"}),e.jsx("div",{className:"p-3 bg-white rounded-lg border border-gray-200",children:e.jsxs("span",{className:"text-sm text-gray-600",children:[c," days or older"]})})]})]})]}),e.jsxs(v,{className:"shadow-lg border-0 bg-gradient-to-br from-green-50 to-emerald-50",children:[e.jsxs(W,{className:"pb-4",children:[e.jsxs(R,{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(Z,{className:"w-5 h-5 text-green-600"}),"Disposal Details"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Provide disposal information"})]}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"disposalReason",className:"text-sm font-semibold text-gray-700",children:"Disposal Reason *"}),e.jsx(U,{id:"disposalReason",value:i,onChange:a=>n(a.target.value),className:"h-12 bg-white border-2 border-gray-200 hover:border-green-300 focus:border-green-500 transition-colors",placeholder:"Enter disposal reason"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"disposalCost",className:"text-sm font-semibold text-gray-700",children:"Disposal Cost (KES)"}),e.jsx(U,{id:"disposalCost",type:"number",value:N,onChange:a=>S(Number(a.target.value)),className:"h-12 bg-white border-2 border-gray-200 hover:border-green-300 focus:border-green-500 transition-colors",placeholder:"Enter disposal cost",min:"0",step:"0.01"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(z,{htmlFor:"disposalNotes",className:"text-sm font-semibold text-gray-700",children:"Notes"}),e.jsx(U,{id:"disposalNotes",value:I,onChange:a=>C(a.target.value),className:"h-12 bg-white border-2 border-gray-200 hover:border-green-300 focus:border-green-500 transition-colors",placeholder:"Additional notes (optional)"})]})]})]})]}),e.jsxs(v,{className:"overflow-x-hidden",children:[e.jsxs(W,{className:"pb-4",children:[e.jsxs(R,{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(be,{className:"w-5 h-5 text-gray-600"}),"Available Items for Disposal (",u.length,")"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Select items to include in this disposal"})]}),e.jsx(D,{children:u.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(B,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No items found matching your criteria"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 max-h-96 overflow-y-auto",children:u.map(a=>e.jsx(v,{className:`cursor-pointer transition-all duration-200 hover:shadow-md ${y.includes(a.id)?"ring-2 ring-red-500 bg-red-50":"hover:bg-gray-50"}`,onClick:()=>Q(a.id),children:e.jsxs(D,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(Y,{variant:"outline",className:"text-xs",children:a.batchNumber}),e.jsxs(Y,{variant:"secondary",className:"text-xs",children:["Size ",a.sizeClass]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Weight:"}),e.jsxs("span",{className:"font-medium",children:[a.weightKg.toFixed(2)," kg"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Location:"}),e.jsx("span",{className:"font-medium",children:a.storageLocation})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Age:"}),e.jsxs("span",{className:"font-medium",children:[a.daysInStorage," days"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Reason:"}),e.jsx("span",{className:"font-medium text-red-600",children:a.disposalReason})]})]}),y.includes(a.id)&&e.jsx("div",{className:"mt-2 text-center",children:e.jsx(Y,{className:"bg-red-600 text-white",children:"Selected"})})]})},a.id))})})]})]})]}),e.jsxs(me,{children:[e.jsx(V,{variant:"outline",onClick:()=>m(!1),children:"Cancel"}),x&&x!==""&&e.jsx(V,{onClick:H,className:"bg-red-600 hover:bg-red-700",disabled:E,children:E?"Processing...":"Create Disposal"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(v,{children:e.jsx(D,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Disposals"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t.length})]}),e.jsx(B,{className:"h-8 w-8 text-gray-400"})]})})}),e.jsx(v,{children:e.jsx(D,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Weight"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[l.totalDisposedWeight.toFixed(1)," kg"]})]}),e.jsx(X,{className:"h-8 w-8 text-gray-400"})]})})}),e.jsx(v,{children:e.jsx(D,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Cost"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["KES ",l.totalDisposalCost.toFixed(2)]})]}),e.jsx(Z,{className:"h-8 w-8 text-gray-400"})]})})}),e.jsx(v,{children:e.jsx(D,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.pendingDisposals})]}),e.jsx(ee,{className:"h-8 w-8 text-gray-400"})]})})})]}),e.jsxs(v,{children:[e.jsx(W,{children:e.jsx(R,{children:"Disposal Records"})}),e.jsx(D,{children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(B,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No disposal records found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b",children:[e.jsx("th",{className:"text-left p-2",children:"Date"}),e.jsx("th",{className:"text-left p-2",children:"Reason"}),e.jsx("th",{className:"text-left p-2",children:"Weight (kg)"}),e.jsx("th",{className:"text-left p-2",children:"Cost (KES)"}),e.jsx("th",{className:"text-left p-2",children:"Status"})]})}),e.jsx("tbody",{children:t.map(a=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-2",children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{className:"p-2",children:a.disposal_reason}),e.jsx("td",{className:"p-2",children:a.total_weight_kg.toFixed(2)}),e.jsx("td",{className:"p-2",children:a.disposal_cost.toFixed(2)}),e.jsx("td",{className:"p-2",children:e.jsx(Y,{variant:a.status==="completed"?"default":"secondary",children:a.status})})]},a.id))})]})})})]})]})]})};export{qe as default};
