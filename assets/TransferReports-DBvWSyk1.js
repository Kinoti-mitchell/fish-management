var me=Object.defineProperty,xe=Object.defineProperties;var he=Object.getOwnPropertyDescriptors;var Y=Object.getOwnPropertySymbols;var ge=Object.prototype.hasOwnProperty,pe=Object.prototype.propertyIsEnumerable;var K=(m,c,a)=>c in m?me(m,c,{enumerable:!0,configurable:!0,writable:!0,value:a}):m[c]=a,X=(m,c)=>{for(var a in c||(c={}))ge.call(c,a)&&K(m,a,c[a]);if(Y)for(var a of Y(c))pe.call(c,a)&&K(m,a,c[a]);return m},J=(m,c)=>xe(m,he(c));var D=(m,c,a)=>new Promise((L,z)=>{var _=d=>{try{y(a.next(d))}catch(N){z(N)}},$=d=>{try{y(a.throw(d))}catch(N){z(N)}},y=d=>d.done?L(d.value):Promise.resolve(d.value).then(_,$);y((a=a.apply(m,c)).next())});import{r as p,j as e,a as Z,b as ee,P as ue,L as k,l as v,B as g,m as je,H as be,I as Ne,n as q}from"./index-COZDezWH.js";import{C as R,T as ve,a as fe,b as se,c as j,d as ye,e as b}from"./table-DWGjy_B5.js";import{i as I}from"./inventoryService-C42W42Ps.js";import{D as we,b as _e,c as Te,d as Ce}from"./dialog-BhD-RmlJ.js";import{T as Se}from"./textarea-BnZhON7V.js";import{C as W}from"./circle-alert-CZuHyHG-.js";import{S as V}from"./scale-DXE6wn5i.js";import{L as G}from"./loader-circle-AIi5BBv3.js";import{C as f}from"./circle-check-big-CRihE8Ly.js";import{F as M}from"./file-text-vmAgeTkT.js";import{S as De}from"./search-BlGkZ4xz.js";import{R as ke}from"./refresh-cw-PX8yMuos.js";import{D as ze}from"./download-Cmd7qcQ2.js";import{C as U}from"./clock-D-G5_Fg7.js";function $e({isOpen:m,onClose:c,transferRequest:a,onApprove:L,onDecline:z,currentUserId:_}){const[$,y]=p.useState(""),[d,N]=p.useState(!1),[F,T]=p.useState(null),h=()=>D(this,null,function*(){N(!0),T(null);try{yield L(a.id,_),c()}catch(w){T(w.message||"Failed to approve transfer")}finally{N(!1)}}),A=()=>D(this,null,function*(){N(!0),T(null);try{yield z(a.id,_),c()}catch(w){T(w.message||"Failed to decline transfer")}finally{N(!1)}});return e.jsx(we,{open:m,onOpenChange:c,children:e.jsxs(_e,{className:"max-w-2xl",children:[e.jsx(Te,{children:e.jsxs(Ce,{className:"flex items-center gap-2",children:[e.jsx(W,{className:"w-5 h-5 text-amber-600"}),"Transfer Approval Required"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Z,{children:e.jsxs(ee,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(ue,{className:"w-4 h-4"}),"Transfer Request Details"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(k,{className:"text-sm font-medium text-gray-600",children:"From Storage"}),e.jsx("p",{className:"font-semibold text-gray-900",children:a.from_storage_name})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-sm font-medium text-gray-600",children:"To Storage"}),e.jsx("p",{className:"font-semibold text-gray-900",children:a.to_storage_name})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-sm font-medium text-gray-600",children:"Size Class"}),e.jsx(v,{variant:"outline",className:"w-auto justify-center",children:a.is_bulk?a.size_class:`Size ${a.size_class}`}),a.is_bulk&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.batch_size," size",a.batch_size!==1?"s":""," in batch"]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(k,{className:"text-sm font-medium text-gray-600",children:"Total Weight"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-5 h-5 text-green-600"}),e.jsxs("span",{className:"font-bold text-green-600 text-lg",children:[a.weight_kg.toFixed(1),"kg"]})]})]}),e.jsxs("div",{children:[e.jsx(k,{className:"text-sm font-medium text-gray-600",children:"Piece Count"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[a.quantity.toLocaleString()," pieces"]})]}),a.notes&&e.jsxs("div",{className:"col-span-2",children:[e.jsx(k,{className:"text-sm font-medium text-gray-600",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 p-2 rounded",children:a.notes})]})]})]})}),e.jsx(Z,{children:e.jsxs(ee,{className:"p-4",children:[e.jsx(k,{htmlFor:"approval-notes",className:"text-sm font-medium text-gray-700",children:"Approval Notes (Optional)"}),e.jsx(Se,{id:"approval-notes",placeholder:"Add any notes about this approval decision...",value:$,onChange:w=>y(w.target.value),className:"mt-2",rows:3})]})}),F&&e.jsxs("div",{className:"flex items-center gap-2 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx(W,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"text-red-700",children:F})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t",children:[e.jsxs(g,{variant:"outline",onClick:A,disabled:d,className:"text-red-600 border-red-300 hover:bg-red-50",children:[d?e.jsx(G,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(R,{className:"w-4 h-4 mr-2"}),"Decline Transfer"]}),e.jsxs(g,{onClick:h,disabled:d,className:"bg-green-600 hover:bg-green-700 text-white",children:[d?e.jsx(G,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(f,{className:"w-4 h-4 mr-2"}),"Approve & Complete"]})]})]})]})})}function Qe({onNavigate:m}={}){var Q;const{user:c}=je(),[a,L]=p.useState([]),[z,_]=p.useState(!1),[$,y]=p.useState(null),[d,N]=p.useState(""),[F,T]=p.useState(!1),[h,A]=p.useState("all"),[w,H]=p.useState(!1),[i,O]=p.useState(null),te=s=>{const l=new Map,t=[];return s.forEach(r=>{const n=`${r.from_storage}-${r.to_storage}-${r.created_at}-${r.notes||""}`;l.has(n)||l.set(n,[]),l.get(n).push(r)}),l.forEach(r=>{if(r.length>1){const n=r[0],B=r.reduce((S,E)=>S+(Number(E.quantity)||0),0),o=r.reduce((S,E)=>S+(Number(E.weight_kg)||0),0),C=r.map(S=>S.size).sort((S,E)=>S-E),oe=J(X({},n),{id:`batch-${n.id}`,is_batch:!0,batch_sizes:C,total_batch_quantity:B,total_batch_weight:o,batch_transfers:r,size:C[0]});t.push(oe)}else t.push(r[0])}),t.sort((r,n)=>new Date(n.created_at).getTime()-new Date(r.created_at).getTime())},P=()=>D(this,null,function*(){_(!0),y(null);try{console.log("🔍 Fetching transfer history...");const s=yield I.getTransferHistory(200);console.log("📊 Transfer history data received:",s),console.log("📋 Data analysis:",{totalTransfers:(s==null?void 0:s.length)||0,hasData:s&&s.length>0,sampleTransfer:(s==null?void 0:s[0])||null,allTransfers:s});const l=te(s);console.log("📦 Grouped transfers:",l),console.log("🔍 Individual transfers (before grouping):",s),L(l)}catch(s){console.error("Error fetching transfer history:",s),y(s.message||"Failed to fetch transfer history")}finally{_(!1)}}),ae=()=>D(this,null,function*(){T(!0),yield P(),T(!1)}),re=(s,l)=>D(this,null,function*(){try{const t=s.startsWith("batch-")?s.replace("batch-",""):s;yield I.approveTransfer(t,l),yield P(),H(!1),O(null)}catch(t){throw console.error("Error approving transfer:",t),t}}),le=(s,l)=>D(this,null,function*(){try{const t=s.startsWith("batch-")?s.replace("batch-",""):s;yield I.declineTransfer(t,l),yield P(),H(!1),O(null)}catch(t){throw console.error("Error declining transfer:",t),t}}),ie=s=>{O(s),H(!0)};p.useEffect(()=>{P()},[]);const x=a.filter(s=>{const l=!d||s.from_storage.toLowerCase().includes(d.toLowerCase())||s.to_storage.toLowerCase().includes(d.toLowerCase())||s.notes.toLowerCase().includes(d.toLowerCase())||(s.size||0).toString().includes(d),t=h==="all"||s.status===h;return l&&t}),ne=s=>{switch(s){case"pending":return e.jsxs(v,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:[e.jsx(U,{className:"w-3 h-3 mr-1"}),"Pending"]});case"approved":return e.jsxs(v,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.jsx(f,{className:"w-3 h-3 mr-1"}),"Approved"]});case"completed":return e.jsxs(v,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[e.jsx(f,{className:"w-3 h-3 mr-1"}),"Completed"]});case"declined":return e.jsxs(v,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:[e.jsx(R,{className:"w-3 h-3 mr-1"}),"Denied"]});default:return e.jsx(v,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:s})}},u=(()=>{const s=a.length,l=a.filter(n=>n.status==="pending").length,t=a.filter(n=>n.status==="approved").length,r=a.filter(n=>n.status==="declined").length;return{all:s,pending:l,approved:t,declined:r}})(),ce=()=>{const s=["Date","From Storage","To Storage","Size Class","Weight (kg)","Pieces","Status","Notes","Created By","Approved/Denied By","Action"],l=x.map(o=>{var C;return[new Date(o.created_at).toLocaleDateString(),o.from_storage,o.to_storage,o.size,((C=o.weight_kg)==null?void 0:C.toFixed(1))||"0.0",o.quantity,o.status,o.notes,o.created_by||"System",o.approved_by||(o.status==="pending"?"Pending":"-"),o.status==="pending"?"Review":o.status==="approved"?"Approved":o.status==="declined"?"Declined":o.status==="completed"?"Completed":"Unknown"]}),t=[s.join(","),...l.map(o=>o.map(C=>`"${C}"`).join(","))].join(`
`),r=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),B=URL.createObjectURL(r);n.setAttribute("href",B),n.setAttribute("download",`transfer-reports-${new Date().toISOString().split("T")[0]}.csv`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},de=()=>{const s=window.open("","_blank");if(!s)return;const l=`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Transfer Reports - ${new Date().toLocaleDateString()}</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            h1 { color: #2563eb; margin-bottom: 20px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
            th { background-color: #f5f5f5; font-weight: bold; }
            .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
            .summary { background-color: #f8fafc; padding: 15px; border-radius: 5px; margin-bottom: 20px; }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>Fish Inventory Transfer Reports</h1>
            <p>Generated: ${new Date().toLocaleString()}</p>
          </div>
          
          <div class="summary">
            <h3>Summary</h3>
            <p><strong>Total Transfers:</strong> ${x.length}</p>
            <p><strong>Total Quantity Transferred:</strong> ${x.reduce((t,r)=>t+r.quantity,0)} pieces</p>
            <p><strong>Date Range:</strong> ${x.length>0?`${new Date(Math.min(...x.map(t=>new Date(t.created_at).getTime()))).toLocaleDateString()} - ${new Date(Math.max(...x.map(t=>new Date(t.created_at).getTime()))).toLocaleDateString()}`:"No transfers found"}</p>
          </div>

          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>From Storage</th>
                <th>To Storage</th>
                <th>Size Class</th>
                <th>Weight (kg)</th>
                <th>Pieces</th>
                <th>Status</th>
                <th>Notes</th>
                <th>Created By</th>
                <th>Approved/Denied By</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              ${x.map(t=>{var r;return`
                <tr>
                  <td>${new Date(t.created_at).toLocaleDateString()}</td>
                  <td>${t.from_storage}</td>
                  <td>${t.to_storage}</td>
                  <td>Size ${t.size}</td>
                  <td>${((r=t.weight_kg)==null?void 0:r.toFixed(1))||"0.0"}</td>
                  <td>${t.quantity}</td>
                  <td>${t.status}</td>
                  <td>${t.notes}</td>
                  <td>${t.created_by||"System"}</td>
                  <td>${t.approved_by||(t.status==="pending"?"Pending":"-")}</td>
                  <td>${t.status==="pending"?"Review":t.status==="approved"?"Approved":t.status==="declined"?"Declined":t.status==="completed"?"Completed":"Unknown"}</td>
                </tr>
              `}).join("")}
            </tbody>
          </table>
        </body>
      </html>
    `;s.document.write(l),s.document.close(),s.print()};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 content-container responsive-padding",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(M,{className:"h-6 w-6 md:h-8 md:w-8 text-blue-600"}),"Transfer Reports & Approvals"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and approve fish transfer requests"})]}),m&&e.jsx("div",{className:"flex flex-col sm:flex-row gap-3",children:e.jsxs(g,{onClick:()=>m("inventory"),variant:"outline",className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx(be,{className:"w-4 h-4"}),"Back to Inventory"]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(De,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(Ne,{placeholder:"Search transfers...",value:d,onChange:s=>N(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(g,{onClick:ae,variant:"outline",size:"sm",disabled:F,children:[e.jsx(ke,{className:`w-4 h-4 mr-2 ${F?"animate-spin":""}`}),"Refresh"]}),e.jsxs(g,{onClick:ce,variant:"outline",size:"sm",disabled:x.length===0,children:[e.jsx(ze,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),e.jsxs(g,{onClick:de,variant:"outline",size:"sm",disabled:x.length===0,children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Export PDF"]})]})]})}),u.pending>0&&e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-amber-200 p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:e.jsx(W,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-amber-800",children:"Pending Transfers Require Approval"}),e.jsxs("p",{className:"text-sm text-amber-700",children:["You have ",u.pending," transfer request",u.pending!==1?"s":"",' waiting for approval. Click the "Review" button in the table below to approve or decline transfers.']})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(g,{variant:h==="all"?"default":"outline",size:"sm",onClick:()=>A("all"),className:`flex items-center gap-2 ${h==="all"?"bg-blue-600 hover:bg-blue-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(M,{className:"h-4 w-4"}),"All (",u.all,")"]}),e.jsxs(g,{variant:h==="pending"?"default":"outline",size:"sm",onClick:()=>A("pending"),className:`flex items-center gap-2 ${h==="pending"?"bg-yellow-600 hover:bg-yellow-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(U,{className:"h-4 w-4"}),"Pending (",u.pending,")"]}),e.jsxs(g,{variant:h==="approved"?"default":"outline",size:"sm",onClick:()=>A("approved"),className:`flex items-center gap-2 ${h==="approved"?"bg-green-600 hover:bg-green-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(f,{className:"h-4 w-4"}),"Approved (",u.approved,")"]}),e.jsxs(g,{variant:h==="declined"?"default":"outline",size:"sm",onClick:()=>A("declined"),className:`flex items-center gap-2 ${h==="declined"?"bg-red-600 hover:bg-red-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(R,{className:"h-4 w-4"}),"Denied (",u.declined,")"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Transfers"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:x.length})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(q,{className:"w-6 h-6 text-blue-600"})})]}),e.jsxs("div",{className:"mt-2 flex items-center text-sm",children:[e.jsxs("span",{className:"text-green-600 font-medium",children:[u.approved," approved"]}),e.jsx("span",{className:"text-gray-400 mx-2",children:"•"}),e.jsxs("span",{className:"text-gray-500",children:[u.pending," pending"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Approved Weight"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[x.filter(s=>s.status==="approved").reduce((s,l)=>s+(Number(l.weight_kg)||0),0).toFixed(1),"kg"]})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(f,{className:"w-6 h-6 text-green-600"})})]}),e.jsx("div",{className:"mt-2 flex items-center text-sm",children:e.jsx("span",{className:"text-gray-600",children:"Weight of approved transfers"})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Denied"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:x.filter(s=>s.status==="declined").length})]}),e.jsx("div",{className:"p-3 bg-red-100 rounded-lg",children:e.jsx(R,{className:"w-6 h-6 text-red-600"})})]}),e.jsx("div",{className:"mt-2 flex items-center text-sm",children:e.jsx("span",{className:"text-gray-600",children:"Number of denied transfers"})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Weight"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[x.reduce((s,l)=>s+(Number(l.weight_kg)||0),0).toFixed(1),"kg"]})]}),e.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:e.jsx(V,{className:"w-6 h-6 text-orange-600"})})]}),e.jsx("div",{className:"mt-2 flex items-center text-sm",children:e.jsx("span",{className:"text-gray-600",children:"Total weight transferred"})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Reviews"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:u.pending})]}),e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(U,{className:"w-6 h-6 text-purple-600"})})]}),e.jsx("div",{className:"mt-2 flex items-center text-sm",children:u.pending>0?e.jsxs("span",{className:"text-amber-600 font-medium flex items-center",children:[e.jsx(W,{className:"w-4 h-4 mr-1"}),"Needs attention"]}):e.jsxs("span",{className:"text-green-600 font-medium flex items-center",children:[e.jsx(f,{className:"w-4 h-4 mr-1"}),"All caught up"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Transfer History"}),e.jsx("p",{className:"text-sm text-gray-600",children:"View and manage all transfer requests"})]}),e.jsx("div",{className:"p-0",children:z?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(G,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),e.jsx("p",{className:"text-gray-600",children:"Loading transfer history..."})]})}):$?e.jsxs("div",{className:"flex items-center gap-2 p-8 bg-red-50 border border-red-200 rounded-lg m-6",children:[e.jsx(W,{className:"w-5 h-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-red-800",children:"Error Loading Data"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:$}),e.jsx(g,{onClick:P,variant:"outline",size:"sm",className:"mt-2",children:"Try Again"})]})]}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"p-4 bg-gray-50 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:e.jsx(q,{className:"w-10 h-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Transfers Found"}),e.jsx("p",{className:"text-gray-600",children:d?"No transfers match your search criteria":"No transfers have been recorded yet"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(ve,{children:[e.jsx(fe,{children:e.jsxs(se,{children:[e.jsx(j,{children:"Date"}),e.jsx(j,{children:"From Storage"}),e.jsx(j,{children:"To Storage"}),e.jsx(j,{children:"Size Class"}),e.jsx(j,{children:"Weight (kg)"}),e.jsx(j,{children:"Pieces"}),e.jsx(j,{children:"Status"}),e.jsx(j,{children:"Notes"}),e.jsx(j,{children:"Created By"}),e.jsx(j,{children:"Approved/Denied By"}),e.jsx(j,{children:"Actions"})]})}),e.jsx(ye,{children:x.map(s=>{var l,t,r;return e.jsxs(se,{children:[e.jsx(b,{className:"font-medium",children:new Date(s.created_at).toLocaleDateString()}),e.jsx(b,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1 bg-red-100 rounded",children:e.jsx(q,{className:"w-3 h-3 text-red-600"})}),e.jsx("span",{className:"font-medium",children:s.from_storage})]})}),e.jsx(b,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1 bg-green-100 rounded",children:e.jsx(q,{className:"w-3 h-3 text-green-600 rotate-180"})}),e.jsx("span",{className:"font-medium",children:s.to_storage})]})}),e.jsx(b,{children:e.jsx("div",{className:"flex flex-col items-center gap-1",children:s.is_batch?e.jsxs("div",{className:"flex flex-wrap gap-1 justify-center",children:[e.jsx(v,{variant:"secondary",className:"text-xs",children:"Batch"}),(l=s.batch_sizes)==null?void 0:l.map((n,B)=>e.jsxs(v,{variant:"outline",className:"text-xs",children:["Size ",n]},B))]}):e.jsxs(v,{variant:"outline",className:"w-auto justify-center",children:["Size ",s.size]})})}),e.jsx(b,{className:"font-semibold text-blue-600",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(V,{className:"w-4 h-4"}),s.is_batch?`${((t=s.total_batch_weight)==null?void 0:t.toFixed(1))||"0.0"}kg`:`${((r=s.weight_kg)==null?void 0:r.toFixed(1))||"0.0"}kg`]})}),e.jsx(b,{className:"text-sm text-gray-500",children:s.is_batch?`${s.total_batch_quantity||0} pieces`:`${s.quantity} pieces`}),e.jsx(b,{children:ne(s.status)}),e.jsx(b,{className:"max-w-xs truncate",children:s.notes||"-"}),e.jsx(b,{className:"text-sm text-gray-500",children:s.created_by||"System"}),e.jsx(b,{className:"text-sm text-gray-500",children:s.approved_by||(s.status==="pending"?"Pending":"-")}),e.jsxs(b,{children:[s.status==="pending"&&e.jsxs(g,{variant:"outline",size:"sm",onClick:()=>ie(s),className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:[e.jsx(f,{className:"w-4 h-4 mr-1"}),"Review"]}),s.status==="approved"&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Approved"})]}),s.status==="declined"&&e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Declined"})]}),s.status==="completed"&&e.jsxs("div",{className:"flex items-center gap-1 text-blue-600",children:[e.jsx(f,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Completed"})]})]})]},s.id)})})]})})})]}),w&&i&&e.jsx($e,{isOpen:w,onClose:()=>{H(!1),O(null)},transferRequest:{id:i.id,from_storage_name:i.from_storage,to_storage_name:i.to_storage,size_class:i.is_batch?0:i.size,quantity:i.is_batch?i.total_batch_quantity||0:i.quantity,weight_kg:i.is_batch?i.total_batch_weight||0:i.weight_kg,notes:i.notes,created_at:i.created_at,is_bulk:i.is_batch||i.is_bulk,batch_size:i.is_batch?((Q=i.batch_sizes)==null?void 0:Q.length)||0:i.batch_size,batch_transfers:i.batch_transfers,is_batch:i.is_batch,batch_sizes:i.batch_sizes,total_batch_quantity:i.total_batch_quantity,total_batch_weight:i.total_batch_weight},onApprove:re,onDecline:le,currentUserId:(c==null?void 0:c.id)||""})]})})}export{Qe as default};
