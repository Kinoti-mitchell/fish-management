var Oe=Object.defineProperty,Re=Object.defineProperties;var Ue=Object.getOwnPropertyDescriptors;var je=Object.getOwnPropertySymbols;var ze=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable;var ue=(f,d,o)=>d in f?Oe(f,d,{enumerable:!0,configurable:!0,writable:!0,value:o}):f[d]=o,j=(f,d)=>{for(var o in d||(d={}))ze.call(d,o)&&ue(f,o,d[o]);if(je)for(var o of je(d))Me.call(d,o)&&ue(f,o,d[o]);return f},u=(f,d)=>Re(f,Ue(d));var T=(f,d,o)=>new Promise((_,L)=>{var J=C=>{try{K(o.next(C))}catch(E){L(E)}},P=C=>{try{K(o.throw(C))}catch(E){L(E)}},K=C=>C.done?_(C.value):Promise.resolve(C.value).then(J,P);K((o=o.apply(f,d)).next())});import{r as x,j as e,A as pe,i as fe,B as h,X as Ne,e as y,W as qe,C as He,F as p,L as g,I as q,a as W,b as D,P as ve,k as Ge,f as Qe,g as Xe,l as F,E as se,s as ae}from"./index-BCWZ-H89.js";import{S as H,a as G,b as Q,c as X,d as m}from"./select-BeWWDAHA.js";import{T as Je}from"./textarea-Dnt-s_-s.js";import{D as be,a as Ye,b as we,c as ye,d as Ce}from"./dialog-BEFQI8fO.js";import{getOrGenerateEntryCode as Ze,generateUniqueEntryCode as es}from"./entryCodeGenerator-CA7pTR0M.js";import{a as ss}from"./auditLogger-DGXUxLyg.js";import{C as I}from"./circle-check-big-B_lzi8hR.js";import{P as te}from"./plus-OBpYIVmg.js";import{U as re}from"./user-CnQJaf1B.js";import{M as as}from"./map-pin-D9Y1viL5.js";import{W as le}from"./weight-D57ze2mW.js";import{D as ie}from"./dollar-sign-DPjnlSXf.js";import{L as Se}from"./loader-circle-70f-tBf_.js";import{T as ts}from"./trending-up-pEaLsZ6-.js";import{S as _e}from"./search-Dw4Da7Cv.js";import{D as Pe}from"./download-DuXf7iXp.js";import{C as rs}from"./index-a0SoWD4Z.js";import{C as Ee}from"./calendar-C6Sesfe9.js";import"./index-BT8xChTk.js";import"./index-DI_eAeAe.js";function Ps({onNavigate:f}){const[d,o]=x.useState([]),[_,L]=x.useState([]),[J,P]=x.useState(!1),[K,C]=x.useState(!1),[E,ce]=x.useState(!1),[ne,$]=x.useState(null),[de,A]=x.useState(null),[t,S]=x.useState({farmerId:"",totalWeight:"",totalPieces:"",pricePerKg:"",condition:"",fishType:"",notes:""}),[l,w]=x.useState({}),[V,oe]=x.useState(""),[B,me]=x.useState("all"),[Y,ke]=x.useState(!0),[N,O]=x.useState(null),[R,Fe]=x.useState(new Set),[U,Te]=x.useState(!0),We=s=>{switch(s){case"excellent":return"excellent";case"good":return"good";case"fair":return"fair";default:return"good"}},xe=s=>{switch(s){case"excellent":return"excellent";case"good":return"good";case"fair":return"fair";case"poor":return"poor";default:return"good"}},De=s=>{const a=_.find(i=>i.id===s);return a?a.name:`Farmer ID: ${s}`},Ie=s=>{const a=s.reduce((i,c)=>{const r=c.farmer_id;return i[r]||(i[r]={farmer:_.find(n=>n.id===r)||{id:r,name:`Farmer ID: ${r}`,location:"Unknown"},entries:[],totalWeight:0,totalValue:0,totalPieces:0,entryCount:0}),i[r].entries.push(c),i[r].totalWeight+=c.total_weight,i[r].totalValue+=c.total_value,i[r].totalPieces+=c.total_pieces,i[r].entryCount+=1,i},{});return Object.values(a).sort((i,c)=>c.totalValue-i.totalValue)},Le=s=>{const a=new Set(R);a.has(s)?a.delete(s):a.add(s),Fe(a)},Ke=()=>T(this,null,function*(){try{const{data:s,error:a}=yield ae.from("farmers").select("*").eq("status","active").order("name");if(a)throw a;L(s||[])}catch(s){L([])}}),Ve=()=>T(this,null,function*(){try{const{data:s,error:a}=yield ae.from("warehouse_entries").select(`
          *,
          farmers!inner(name)
        `).order("created_at",{ascending:!1}).limit(20);if(a)throw a;const i=yield Promise.all((s||[]).map(c=>T(this,null,function*(){var n;const r=c.entry_code||(yield Ze(c.id));return u(j({},c),{farmer_name:((n=c.farmers)==null?void 0:n.name)||`Farmer ID: ${c.farmer_id}`,entry_code:r})})));o(i)}catch(s){o([])}});x.useEffect(()=>{Ke(),Ve()},[]);const $e=()=>{const s={};return t.farmerId||(s.farmerId="Please select a farmer"),(!t.totalWeight||parseFloat(t.totalWeight)<=0)&&(s.totalWeight="Please enter a valid weight"),(!t.totalPieces||parseInt(t.totalPieces)<=0)&&(s.totalPieces="Please enter valid number of pieces"),(!t.pricePerKg||parseFloat(t.pricePerKg)<=0)&&(s.pricePerKg="Please enter a valid price per kg"),t.condition||(s.condition="Please select a grade/condition"),t.fishType||(s.fishType="Please select a fish type"),w(s),Object.keys(s).length===0},Ae=(s,a,i,c,r)=>T(this,null,function*(){try{yield ss.custom(s,a,i,{old_values:c,new_values:r})}catch(n){console.warn("Failed to log audit event:",n)}}),Be=()=>T(this,null,function*(){if($e()){ce(!0),$(null),A(null);try{const s=_.find(M=>M.id.toString()===t.farmerId||M.id===parseInt(t.farmerId));if(!s)throw new Error("Selected farmer not found");const a=parseFloat(t.totalWeight),i=parseFloat(t.pricePerKg),c=yield es(),r={entry_date:new Date().toISOString().split("T")[0],total_weight:a,total_pieces:parseInt(t.totalPieces),condition:We(t.condition),fish_type:t.fishType,farmer_id:s.id,price_per_kg:i,total_value:a*i,notes:t.notes.trim()||"",entry_code:c},{data:n,error:v}=yield ae.from("warehouse_entries").insert([r]).select();if(v)throw v;n&&n.length>0&&(o(M=>[n[0],...M]),yield Ae("INSERT","warehouse_entries",n[0].id,null,r)),S({farmerId:"",totalWeight:"",totalPieces:"",pricePerKg:"",condition:"",fishType:"",notes:""}),w({}),P(!1),A("Entry recorded successfully!"),setTimeout(()=>A(null),3e3)}catch(s){$("Failed to save entry: "+s.message)}finally{ce(!1)}}}),Z=s=>{switch(xe(s)){case"excellent":return"bg-emerald-100 text-emerald-800 border-emerald-300";case"good":return"bg-blue-100 text-blue-800 border-blue-300";case"fair":return"bg-amber-100 text-amber-800 border-amber-300";default:return"bg-gray-100 text-gray-800 border-gray-300"}},he=s=>{switch(xe(s)){case"excellent":case"good":return e.jsx(I,{className:"h-4 w-4 text-green-600"});case"fair":return e.jsx(y,{className:"h-4 w-4 text-amber-600"});default:return e.jsx(I,{className:"h-4 w-4 text-gray-600"})}},b=s=>`KES ${s.toLocaleString()}`,ee=s=>new Date(s).toLocaleDateString("en-KE",{year:"numeric",month:"short",day:"numeric"}),k=d.filter(s=>{var c,r,n;const a=((c=s.farmer_name)==null?void 0:c.toLowerCase().includes(V.toLowerCase()))||((r=s.entry_code)==null?void 0:r.toLowerCase().includes(V.toLowerCase()))||((n=s.notes)==null?void 0:n.toLowerCase().includes(V.toLowerCase())),i=B==="all"||s.condition===B;return a&&i}),z=(()=>{const s=d.reduce((n,v)=>n+v.total_weight,0),a=d.reduce((n,v)=>n+v.total_value,0),i=d.reduce((n,v)=>n+v.total_pieces,0),c=d.length>0?a/s:0,r=d.reduce((n,v)=>(n[v.condition]=(n[v.condition]||0)+1,n),{});return{totalWeight:s,totalValue:a,totalPieces:i,avgPricePerKg:c,conditionCounts:r,totalEntries:d.length}})(),ge=()=>{const s=[["Entry Code","Date","Farmer","Weight (kg)","Pieces","Price/kg","Total Value","Condition","Notes"],...k.map(r=>[r.entry_code||"",r.entry_date,r.farmer_name||"",r.total_weight,r.total_pieces,r.price_per_kg,r.total_value,r.condition,r.notes||""])].map(r=>r.join(",")).join(`
`),a=new Blob([s],{type:"text/csv"}),i=window.URL.createObjectURL(a),c=document.createElement("a");c.href=i,c.download=`warehouse-entries-${new Date().toISOString().split("T")[0]}.csv`,c.click(),window.URL.revokeObjectURL(i)};return e.jsx("div",{className:"min-h-screen bg-gray-50 content-container responsive-padding",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[de&&e.jsxs(pe,{className:"border-green-200 bg-green-50 text-green-800",children:[e.jsx(I,{className:"h-4 w-4"}),e.jsx(fe,{children:de}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>A(null),className:"ml-auto h-6 w-6 p-0",children:e.jsx(Ne,{className:"h-4 w-4"})})]}),ne&&e.jsxs(pe,{className:"border-red-200 bg-red-50 text-red-800",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx(fe,{children:ne}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>$(null),className:"ml-auto h-6 w-6 p-0",children:e.jsx(Ne,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(qe,{className:"h-8 w-8 text-blue-600"}),"Warehouse Entry"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track fish deliveries and manage inventory"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(h,{variant:"outline",onClick:()=>ke(!Y),children:[e.jsx(He,{className:"h-4 w-4 mr-2"}),Y?"Hide Stats":"Show Stats"]}),e.jsx(h,{variant:"outline",onClick:()=>f("dashboard"),children:"Dashboard"}),e.jsxs(be,{open:J,onOpenChange:P,children:[e.jsx(Ye,{asChild:!0,children:e.jsxs(h,{className:"bg-blue-600 hover:bg-blue-700 text-white",size:"lg",children:[e.jsx(te,{className:"h-5 w-5 mr-2"}),"New Entry"]})}),e.jsxs(we,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ye,{children:[e.jsxs(Ce,{className:"text-2xl flex items-center gap-3",children:[e.jsx(p,{className:"h-6 w-6 text-blue-600"}),"Record New Warehouse Entry"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Enter details for a new fish delivery from a farmer to the warehouse."})]}),e.jsxs("div",{className:"space-y-6 py-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),"Select Farmer *"]}),e.jsxs(H,{value:t.farmerId,onValueChange:s=>{S(u(j({},t),{farmerId:s})),l.farmerId&&w(u(j({},l),{farmerId:""}))},children:[e.jsx(G,{className:`h-12 ${l.farmerId?"border-red-300 focus:border-red-500":""}`,children:e.jsx(Q,{placeholder:"Choose a farmer..."})}),e.jsx(X,{children:_.length>0?_.map(s=>e.jsx(m,{value:s.id.toString(),children:e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-500 flex items-center gap-1",children:[e.jsx(as,{className:"h-3 w-3"}),s.location]})]})})},s.id)):e.jsx(m,{value:"no-farmers",disabled:!0,children:"No active farmers found"})})]}),l.farmerId&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),l.farmerId]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(le,{className:"h-4 w-4"}),"Total Weight (kg) *"]}),e.jsx(q,{type:"number",step:"0.1",placeholder:"e.g. 150.5",value:t.totalWeight,onChange:s=>{S(u(j({},t),{totalWeight:s.target.value})),l.totalWeight&&w(u(j({},l),{totalWeight:""}))},className:`h-12 ${l.totalWeight?"border-red-300 focus:border-red-500":""}`}),l.totalWeight&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),l.totalWeight]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4"}),"Number of Pieces *"]}),e.jsx(q,{type:"number",placeholder:"e.g. 75",value:t.totalPieces,onChange:s=>{S(u(j({},t),{totalPieces:s.target.value})),l.totalPieces&&w(u(j({},l),{totalPieces:""}))},className:`h-12 ${l.totalPieces?"border-red-300 focus:border-red-500":""}`}),l.totalPieces&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),l.totalPieces]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4"}),"Price per kg (KES) *"]}),e.jsx(q,{type:"number",placeholder:"e.g. 450",value:t.pricePerKg,onChange:s=>{S(u(j({},t),{pricePerKg:s.target.value})),l.pricePerKg&&w(u(j({},l),{pricePerKg:""}))},className:`h-12 ${l.pricePerKg?"border-red-300 focus:border-red-500":""}`}),l.pricePerKg&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),l.pricePerKg]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs(g,{className:"text-base font-medium flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4"}),"Fish Type *"]}),e.jsxs(H,{value:t.fishType,onValueChange:s=>{S(u(j({},t),{fishType:s})),l.fishType&&w(u(j({},l),{fishType:""}))},children:[e.jsx(G,{className:`h-12 ${l.fishType?"border-red-300 focus:border-red-500":""}`,children:e.jsx(Q,{placeholder:"Select fish type..."})}),e.jsxs(X,{children:[e.jsx(m,{value:"Nile Tilapia",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-blue-600"}),"Nile Tilapia (0.35kg avg)"]})}),e.jsx(m,{value:"Nile Perch",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-green-600"}),"Nile Perch (1.20kg avg)"]})}),e.jsx(m,{value:"African Catfish",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-purple-600"}),"African Catfish (0.65kg avg)"]})}),e.jsx(m,{value:"Silver Cyprinid",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-gray-600"}),"Silver Cyprinid (0.15kg avg)"]})}),e.jsx(m,{value:"African Lungfish",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-orange-600"}),"African Lungfish (0.80kg avg)"]})}),e.jsx(m,{value:"Blue-spotted Tilapia",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-cyan-600"}),"Blue-spotted Tilapia (0.30kg avg)"]})}),e.jsx(m,{value:"Marbled Lungfish",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-red-600"}),"Marbled Lungfish (0.75kg avg)"]})}),e.jsx(m,{value:"Electric Catfish",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-yellow-600"}),"Electric Catfish (0.55kg avg)"]})}),e.jsx(m,{value:"Mixed Batch",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-4 w-4 text-indigo-600"}),"Mixed Batch (0.50kg avg)"]})})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Select the primary fish type. This helps with accurate processing and sorting."}),l.fishType&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),l.fishType]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{className:"text-base font-medium",children:"Grade/Quality *"}),e.jsxs(H,{value:t.condition,onValueChange:s=>{S(u(j({},t),{condition:s})),l.condition&&w(u(j({},l),{condition:""}))},children:[e.jsx(G,{className:`h-12 ${l.condition?"border-red-300 focus:border-red-500":""}`,children:e.jsx(Q,{placeholder:"Select quality grade..."})}),e.jsxs(X,{children:[e.jsx(m,{value:"excellent",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4 text-green-600"}),"Excellent (Grade A)"]})}),e.jsx(m,{value:"good",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"h-4 w-4 text-blue-600"}),"Good (Grade B)"]})}),e.jsx(m,{value:"fair",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{className:"h-4 w-4 text-amber-600"}),"Fair (Grade C)"]})})]})]}),l.condition&&e.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1",children:[e.jsx(y,{className:"h-3 w-3"}),l.condition]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(g,{className:"text-base font-medium",children:"Additional Notes"}),e.jsx(Je,{placeholder:"Any special notes about this delivery...",value:t.notes,onChange:s=>S(u(j({},t),{notes:s.target.value})),className:"h-12 min-h-[48px]"})]})]}),t.totalWeight&&t.pricePerKg&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"text-sm text-blue-700 mb-1",children:"Total Value"}),e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:b(parseFloat(t.totalWeight)*parseFloat(t.pricePerKg))})]}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t",children:[e.jsx(h,{variant:"outline",onClick:()=>{P(!1),w({}),$(null)},disabled:E,children:"Cancel"}),e.jsx(h,{onClick:Be,disabled:E,className:"bg-blue-600 hover:bg-blue-700",children:E?e.jsxs(e.Fragment,{children:[e.jsx(Se,{className:"h-4 w-4 mr-2 animate-spin"}),"Recording..."]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Record Entry"]})})]})]})]})]})]})]}),Y&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(W,{children:e.jsx(D,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Weight"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[z.totalWeight.toFixed(1)," kg"]})]}),e.jsx(le,{className:"h-8 w-8 text-blue-600"})]})})}),e.jsx(W,{children:e.jsx(D,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Value"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:b(z.totalValue)})]}),e.jsx(ie,{className:"h-8 w-8 text-green-600"})]})})}),e.jsx(W,{children:e.jsx(D,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Pieces"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:z.totalPieces.toLocaleString()})]}),e.jsx(ve,{className:"h-8 w-8 text-purple-600"})]})})}),e.jsx(W,{children:e.jsx(D,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Avg Price/kg"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:b(z.avgPricePerKg)})]}),e.jsx(ts,{className:"h-8 w-8 text-orange-600"})]})})})]}),e.jsx(W,{children:e.jsx(D,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(_e,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(q,{placeholder:"Search entries by farmer, code, or notes...",value:V,onChange:s=>oe(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(H,{value:B,onValueChange:me,children:[e.jsxs(G,{className:"w-40",children:[e.jsx(Ge,{className:"h-4 w-4 mr-2"}),e.jsx(Q,{placeholder:"Filter by condition"})]}),e.jsxs(X,{children:[e.jsx(m,{value:"all",children:"All Conditions"}),e.jsx(m,{value:"excellent",children:"Excellent"}),e.jsx(m,{value:"good",children:"Good"}),e.jsx(m,{value:"fair",children:"Fair"})]})]}),e.jsxs(h,{variant:U?"default":"outline",size:"sm",onClick:()=>Te(!U),className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-4 w-4"}),U?"Group by Farmer":"List View"]}),e.jsxs(h,{variant:"outline",onClick:ge,disabled:k.length===0,children:[e.jsx(Pe,{className:"h-4 w-4 mr-2"}),"Export"]})]})]})})}),e.jsxs(W,{children:[e.jsx(Qe,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(Xe,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5 text-blue-600"}),"Warehouse Entries",e.jsxs(F,{variant:"secondary",children:[k.length," of ",d.length," entries"]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(h,{variant:"outline",size:"sm",onClick:ge,disabled:k.length===0,children:[e.jsx(Pe,{className:"h-4 w-4 mr-1"}),"Export"]})})]})}),e.jsx(D,{children:K?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(Se,{className:"h-8 w-8 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading entries..."})]}):k.length>0?U?e.jsx("div",{className:"space-y-4",children:Ie(k).map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 p-4 cursor-pointer hover:bg-gray-100 transition-colors",onClick:()=>Le(s.farmer.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(re,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.farmer.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.farmer.location})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ve,{className:"h-4 w-4"}),s.entryCount," entries"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(le,{className:"h-4 w-4"}),s.totalWeight.toFixed(1),"kg"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"h-4 w-4"}),b(s.totalValue)]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(F,{variant:"outline",className:"text-xs",children:R.has(s.farmer.id)?"Collapse":"Expand"}),e.jsx(rs,{className:`h-4 w-4 text-gray-400 transition-transform ${R.has(s.farmer.id)?"rotate-180":""}`})]})]})}),R.has(s.farmer.id)&&e.jsx("div",{className:"divide-y divide-gray-100",children:s.entries.map(a=>e.jsxs("div",{className:"p-4 hover:bg-gray-50 transition-colors bg-white",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[he(a.condition),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ee,{className:"h-3 w-3"}),ee(a.entry_date)]}),e.jsx(F,{variant:"outline",className:"font-medium",children:a.entry_code})]})})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsx(F,{className:`${Z(a.condition)} border`,children:a.condition}),e.jsxs("span",{className:"text-gray-600",children:[a.total_weight,"kg • ",a.total_pieces," pieces"]}),e.jsxs("span",{className:"text-gray-600",children:[b(a.price_per_kg),"/kg"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-xl font-bold text-gray-900 mb-2",children:b(a.total_value)}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(h,{size:"sm",variant:"outline",onClick:()=>O(a),children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),"View"]})})]})]}),a.notes&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded text-sm text-gray-600",children:[e.jsx("strong",{children:"Notes:"})," ",a.notes]})]},a.id))})]},s.farmer.id))}):e.jsx("div",{className:"divide-y divide-gray-100",children:k.map(s=>e.jsxs("div",{className:"p-6 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[he(s.condition),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:De(s.farmer_id)}),e.jsx("div",{className:"flex items-center gap-4 text-sm text-gray-500 mt-1",children:e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Ee,{className:"h-3 w-3"}),ee(s.entry_date)]})})]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[e.jsx(F,{variant:"outline",className:"font-medium",children:s.entry_code}),e.jsx(F,{className:`${Z(s.condition)} border`,children:s.condition}),e.jsxs("span",{className:"text-gray-600",children:[s.total_weight,"kg • ",s.total_pieces," pieces"]}),e.jsxs("span",{className:"text-gray-600",children:[b(s.price_per_kg),"/kg"]}),e.jsxs("span",{className:"text-gray-600 font-medium",children:["• ",s.farmer_name]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 mb-3",children:b(s.total_value)}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(h,{size:"sm",variant:"outline",onClick:()=>O(s),children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),"View"]})})]})]}),s.notes&&e.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded text-sm text-gray-600",children:[e.jsx("strong",{children:"Notes:"})," ",s.notes]})]},s.id))}):V||B!=="all"?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(_e,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No entries match your search"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Try adjusting your search or filter criteria"}),e.jsxs("div",{className:"mt-4 flex gap-2 justify-center",children:[e.jsx(h,{variant:"outline",onClick:()=>{oe(""),me("all")},children:"Clear Filters"}),e.jsxs(h,{onClick:()=>P(!0),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"New Entry"]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(p,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No warehouse entries yet"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Start by recording your first fish delivery"}),e.jsxs(h,{onClick:()=>P(!0),className:"mt-4 bg-blue-600 hover:bg-blue-700",size:"lg",children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),"Record First Entry"]})]})})]}),e.jsx(be,{open:!!N,onOpenChange:()=>O(null),children:e.jsxs(we,{className:"max-w-2xl",children:[e.jsx(ye,{children:e.jsxs(Ce,{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-5 w-5 text-blue-600"}),"Entry Details"]})}),N&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Entry Code"}),e.jsx("p",{className:"text-lg font-semibold",children:N.entry_code})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Date"}),e.jsx("p",{className:"text-lg font-semibold",children:ee(N.entry_date)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Farmer"}),e.jsx("p",{className:"text-lg font-semibold",children:N.farmer_name})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Condition"}),e.jsx(F,{className:`${Z(N.condition)} border`,children:N.condition})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Weight"}),e.jsxs("p",{className:"text-lg font-semibold",children:[N.total_weight," kg"]})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Pieces"}),e.jsx("p",{className:"text-lg font-semibold",children:N.total_pieces})]}),e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Price/kg"}),e.jsx("p",{className:"text-lg font-semibold",children:b(N.price_per_kg)})]})]}),e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Total Value"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:b(N.total_value)})]}),N.notes&&e.jsxs("div",{children:[e.jsx(g,{className:"text-sm font-medium text-gray-500",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 p-3 rounded",children:N.notes})]}),e.jsx("div",{className:"flex justify-end gap-2 pt-4 border-t",children:e.jsx(h,{variant:"outline",onClick:()=>O(null),children:"Close"})})]})]})})]})})}export{Ps as default};
