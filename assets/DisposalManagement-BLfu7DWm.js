var ze=Object.defineProperty,Me=Object.defineProperties;var $e=Object.getOwnPropertyDescriptors;var xe=Object.getOwnPropertySymbols;var Oe=Object.prototype.hasOwnProperty,Ue=Object.prototype.propertyIsEnumerable;var he=(l,o,r)=>o in l?ze(l,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[o]=r,ae=(l,o)=>{for(var r in o||(o={}))Oe.call(o,r)&&he(l,r,o[r]);if(xe)for(var r of xe(o))Ue.call(o,r)&&he(l,r,o[r]);return l},oe=(l,o)=>Me(l,$e(o));var P=(l,o,r)=>new Promise((i,x)=>{var t=b=>{try{N(r.next(b))}catch(w){x(w)}},f=b=>{try{N(r.throw(b))}catch(w){x(w)}},N=b=>b.done?i(b.value):Promise.resolve(b.value).then(t,f);N((r=r.apply(l,o)).next())});import{s as L,r as y,j as e,p as ee,e as ve,P as le,B as K,a as T,f as G,g as H,b as E,L as Y,I as se,l as B,C as We}from"./index-0XJeEQji.js";import{S as pe,a as ue,b as fe,c as je,d as be}from"./select-JyWggAir.js";import{D as Le,b as qe,c as Be,d as Pe,f as Ke,e as Ge}from"./dialog-BvRtH-vO.js";import{D as He}from"./dollar-sign-DNaiOaFk.js";import{T as Ve}from"./trending-down-fQcSfVx1.js";import{C as ye}from"./clock-olueJ0Ll.js";import{S as Ye}from"./scale-C1TfCHAl.js";import{A as Qe}from"./activity-Cuol5yI5.js";import{P as Je}from"./plus-DCtwfDNc.js";import{C as Ne}from"./calendar-CSrz5qku.js";import{M as _e}from"./map-pin-DopIXg3c.js";import{C as Xe}from"./index-ScoVEskh.js";import{C as Ze}from"./chevron-right-DxJFJcQq.js";import{F as es}from"./file-text-CDPffwtm.js";import{D as ss}from"./download-ClUvFsLV.js";import{T as ts}from"./trending-up-Dz-7ZKkh.js";import"./index-cQOHC384.js";import"./index-C3dOh4VJ.js";class as{getDisposalStats(){return P(this,null,function*(){var o,r,i,x;try{console.log("ðŸ” [DisposalService] Fetching disposal statistics...");const{data:t,error:f}=yield L.from("disposal_records").select(`
          *,
          disposal_reason:disposal_reasons(name)
        `).order("created_at",{ascending:!1});if(f){if(console.error("âŒ [DisposalService] Error fetching disposal records:",f),(o=f.message)!=null&&o.includes("relation")&&((r=f.message)!=null&&r.includes("does not exist")))return console.warn("âš ï¸ [DisposalService] Disposal tables may not exist yet"),this.getDefaultStats();if((i=f.message)!=null&&i.includes("permission")||(x=f.message)!=null&&x.includes("RLS"))return console.warn("âš ï¸ [DisposalService] Permission error - disposal tables may need RLS configuration"),this.getDefaultStats();throw f}console.log("ðŸ“Š [DisposalService] Disposal records:",(t==null?void 0:t.length)||0);const N=(t==null?void 0:t.length)||0,b=(t==null?void 0:t.reduce((h,j)=>h+(j.total_weight_kg||0),0))||0,w=(t==null?void 0:t.reduce((h,j)=>h+(j.disposal_cost||0),0))||0,z=(t==null?void 0:t.filter(h=>h.status==="pending").length)||0,F=new Date;F.setDate(F.getDate()-7);const _=(t==null?void 0:t.filter(h=>new Date(h.created_at)>=F).length)||0,p=(t==null?void 0:t.filter(h=>h.status==="completed"))||[];let I=0;p.length>0&&(I=p.reduce((j,M)=>{const W=new Date(M.created_at),q=new Date(M.disposal_date),Q=Math.floor((q.getTime()-W.getTime())/(1e3*60*60*24));return j+Q},0)/p.length);const S={};t==null||t.forEach(h=>{var M;const j=((M=h.disposal_reason)==null?void 0:M.name)||"Unknown";S[j]=(S[j]||0)+1});const v=Object.keys(S).reduce((h,j)=>S[h]>S[j]?h:j,"Age"),n=new Date,g=n.getMonth(),k=n.getFullYear(),C=g===0?11:g-1,D=g===0?k-1:k,R=(t==null?void 0:t.filter(h=>{const j=new Date(h.created_at);return j.getMonth()===g&&j.getFullYear()===k}).length)||0,A=(t==null?void 0:t.filter(h=>{const j=new Date(h.created_at);return j.getMonth()===C&&j.getFullYear()===D}).length)||0,O=A>0?(R-A)/A*100:0,U={totalDisposals:N,totalDisposedWeight:b,totalDisposalCost:w,pendingDisposals:z,recentDisposals:_,averageDisposalAge:I,topDisposalReason:v,monthlyDisposalTrend:O};return console.log("ðŸ“Š [DisposalService] Calculated stats:",U),U}catch(t){return console.error("âŒ [DisposalService] Error getting disposal stats:",t),this.getDefaultStats()}})}getDefaultStats(){return{totalDisposals:0,totalDisposedWeight:0,totalDisposalCost:0,pendingDisposals:0,recentDisposals:0,averageDisposalAge:0,topDisposalReason:"Age",monthlyDisposalTrend:0}}getDisposalRecords(o=50,r=0){return P(this,null,function*(){var i,x,t,f;try{const{data:N,error:b}=yield L.from("disposal_records").select(`
          *,
          disposal_reason:disposal_reasons(name),
          disposal_items(
            size_class,
            weight_kg,
            batch_number,
            sorting_result:sorting_results(
              sorting_batch:sorting_batches(batch_number)
            )
          )
        `).order("created_at",{ascending:!1}).range(r,r+o-1);if(b){if(console.error("âŒ [DisposalService] Error fetching disposal records:",b),(i=b.message)!=null&&i.includes("relation")&&((x=b.message)!=null&&x.includes("does not exist")))return console.warn("âš ï¸ [DisposalService] Disposal tables may not exist yet"),[];if((t=b.message)!=null&&t.includes("permission")||(f=b.message)!=null&&f.includes("RLS"))return console.warn("âš ï¸ [DisposalService] Permission error - disposal tables may need RLS configuration"),[];throw b}return(N||[]).map(z=>{var F,_;return oe(ae({},z),{batch_numbers:((F=z.disposal_items)==null?void 0:F.map(p=>{var I,S;return p.batch_number||((S=(I=p.sorting_result)==null?void 0:I.sorting_batch)==null?void 0:S.batch_number)||"Unknown"}).filter((p,I,S)=>S.indexOf(p)===I))||[],size_classes:((_=z.disposal_items)==null?void 0:_.map(p=>p.size_class).filter((p,I,S)=>S.indexOf(p)===I))||[]})})}catch(N){return console.error("Error fetching disposal records:",N),[]}})}getDisposalReasons(){return P(this,null,function*(){try{const{data:o,error:r}=yield L.from("disposal_reasons").select("*").eq("is_active",!0).order("name");if(r)throw r;return o||[]}catch(o){return console.error("Error fetching disposal reasons:",o),[]}})}getInventoryForDisposal(o=30,r=!0,i,x=!1,t,f){return P(this,null,function*(){try{console.log("ðŸ” [DisposalService] Getting inventory for disposal with improved filtering..."),console.log("ðŸ“Š [DisposalService] Filter criteria:",{daysOld:o,includeStorageIssues:r});const N=new Date;N.setDate(N.getDate()-o);const b=N.toISOString().split("T")[0];console.log("ðŸ“… [DisposalService] Cutoff date:",b);const{data:w,error:z}=yield L.from("storage_locations").select("id, name, status, capacity_kg, current_usage_kg").order("name");if(z)throw console.error("âŒ [DisposalService] Storage locations error:",z),z;console.log("ðŸ“ [DisposalService] Storage locations found:",(w==null?void 0:w.length)||0);const F=new Map;w==null||w.forEach(n=>{F.set(n.id,n)});let _=L.from("sorting_results").select(`
          id,
          size_class,
          total_pieces,
          total_weight_grams,
          storage_location_id,
          created_at,
          sorting_batch:sorting_batches(
            id,
            batch_number,
            status,
            created_at
          )
        `).not("storage_location_id","is",null).gt("total_weight_grams",0);_=_.eq("sorting_batch.status","completed");const{data:p,error:I}=yield _.order("created_at",{ascending:!1});if(I)throw console.error("âŒ [DisposalService] Query error:",I),I;console.log("ðŸ“Š [DisposalService] Raw query results:",(p==null?void 0:p.length)||0,"items");const S=(p||[]).filter(n=>{var U,h,j,M;const g=F.get(n.storage_location_id);if(!n.total_weight_grams||n.total_weight_grams<=0)return console.log("âŒ [DisposalService] Item filtered out - no weight:",n.id,n.total_weight_grams),!1;const k=((h=(U=n.sorting_batch)==null?void 0:U.created_at)==null?void 0:h.split("T")[0])||((j=n.created_at)==null?void 0:j.split("T")[0]);if(!k)return console.log("âŒ [DisposalService] Item filtered out - no processing date:",n.id),!1;const C=new Date(k);if(isNaN(C.getTime())||C>new Date)return console.log("âŒ [DisposalService] Item filtered out - invalid or future date:",n.id,k),!1;const D=Math.floor((new Date().getTime()-C.getTime())/(1e3*60*60*24));let R=!1;if(o===0?R=!0:i&&i>o?R=D>=o&&D<=i:R=D>=o,t||f){const W=k;let q=!0;if(t&&W<t&&(q=!1),f&&W>f&&(q=!1),!q)return console.log("âŒ [DisposalService] Item filtered out - not in date range:",n.id,W,"from:",t,"to:",f),!1}let A=!1;if(x)return A=g&&g.status!=="active",A;r&&(A=!n.storage_location_id||!g||g.status!=="active"||g.current_usage_kg>g.capacity_kg);const O=R||A;return console.log("ðŸ” [DisposalService] Item check:",{id:n.id,batchNumber:(M=n.sorting_batch)==null?void 0:M.batch_number,processingDate:k,daysInStorage:D,weightGrams:n.total_weight_grams,isOldEnough:R,hasStorageIssues:A,storageStatus:g==null?void 0:g.status,isEligible:O,inactiveStorageOnly:x}),O});console.log("ðŸ“Š [DisposalService] Eligible items after filtering:",S.length);const v=S.map(n=>{var R,A,O,U,h,j,M,W,q,Q,J,te,V,X;const g=F.get(n.storage_location_id),k=((A=(R=n.sorting_batch)==null?void 0:R.created_at)==null?void 0:A.split("T")[0])||((O=n.created_at)==null?void 0:O.split("T")[0]),C=Math.floor((new Date().getTime()-new Date(k).getTime())/(1e3*60*60*24));let D="Age";return n.storage_location_id?g?g.status!=="active"?D="Storage Inactive":g.current_usage_kg>g.capacity_kg?D="Storage Over Capacity":C>=o&&(D="Age"):D="Storage Not Found":D="No Storage Location",{sorting_result_id:n.id,size_class:n.size_class,total_pieces:n.total_pieces,total_weight_grams:n.total_weight_grams,batch_number:((U=n.sorting_batch)==null?void 0:U.batch_number)||"BATCH-"+((j=(h=n.sorting_batch)==null?void 0:h.id)==null?void 0:j.substring(0,8)),storage_location_name:(g==null?void 0:g.name)||"No Storage Assigned",farmer_name:((Q=(q=(W=(M=n.sorting_batch)==null?void 0:M.processing_record)==null?void 0:W.warehouse_entry)==null?void 0:q.farmers)==null?void 0:Q.name)||"Unknown Farmer",processing_date:k,days_in_storage:C,disposal_reason:D,quality_notes:`Fish from ${((X=(V=(te=(J=n.sorting_batch)==null?void 0:J.processing_record)==null?void 0:te.warehouse_entry)==null?void 0:V.farmers)==null?void 0:X.name)||"Unknown Farmer"}`,storage_status:(g==null?void 0:g.status)||"unknown"}});return console.log("ðŸ“Š [DisposalService] Transformed items:",v.length),v}catch(N){return console.error("âŒ [DisposalService] Error getting inventory for disposal:",N),[]}})}createDisposal(o){return P(this,null,function*(){try{console.log("ðŸ” [DisposalService] Creating disposal record..."),console.log("ðŸ“Š [DisposalService] Disposal data:",o);let{data:r,error:i}=yield L.from("disposal_reasons").select("id").eq("name",o.disposalReason).single();if(i){console.log("ðŸ” [DisposalService] Disposal reason not found, creating new one:",o.disposalReason),console.log("ðŸ” [DisposalService] Error details:",i);const{data:_,error:p}=yield L.from("disposal_reasons").insert({name:o.disposalReason,description:`Auto-created disposal reason: ${o.disposalReason}`,is_active:!0}).select("id").single();if(p)throw console.error("âŒ [DisposalService] Error creating disposal reason:",p),new Error(`Failed to create disposal reason "${o.disposalReason}": ${p.message}`);r=_,console.log("âœ… [DisposalService] Created new disposal reason:",r.id)}const x={disposal_reason_id:r.id,total_weight_kg:o.totalWeight,disposal_cost:o.disposalCost,notes:o.disposalNotes,status:"completed",disposal_date:new Date().toISOString().split("T")[0],disposal_method:o.disposalMethod,created_by:"system",approved_by:"system"};console.log("ðŸ” [DisposalService] Disposal record data:",x);const{data:t,error:f}=yield L.from("disposal_records").insert(x).select().single();if(f)throw console.error("âŒ [DisposalService] Error creating disposal record:",f),f;console.log("âœ… [DisposalService] Disposal record created:",t.id);const{data:N,error:b}=yield L.from("sorting_results").select(`
          id, 
          size_class, 
          total_weight_grams,
          storage_location_id,
          created_at,
          sorting_batch:sorting_batches(
            batch_number,
            processing_record:processing_records(
              warehouse_entry:warehouse_entries(
                farmers(name)
              )
            )
          ),
          storage_locations(name)
        `).in("id",o.selectedItems);if(b)throw console.error("âŒ [DisposalService] Error fetching sorting results:",b),b;const w=N.map(_=>{var v,n,g,k,C,D,R,A,O;const p=((g=(n=(v=_.sorting_batch)==null?void 0:v.processing_record)==null?void 0:n.warehouse_entry)==null?void 0:g.created_at)||_.created_at,I=((R=(D=(C=(k=_.sorting_batch)==null?void 0:k.processing_record)==null?void 0:C.warehouse_entry)==null?void 0:D.farmers)==null?void 0:R.name)||"Unknown Farmer",S=((A=_.storage_locations)==null?void 0:A.name)||"Unknown Storage";return{disposal_record_id:t.id,sorting_result_id:_.id,size_class:_.size_class,weight_kg:_.total_weight_grams/1e3,batch_number:((O=_.sorting_batch)==null?void 0:O.batch_number)||"Unknown",storage_location_name:S,farmer_name:I,processing_date:p?p.split("T")[0]:new Date().toISOString().split("T")[0],quality_notes:`Disposed from ${S} - ${o.disposalReason}`,disposal_reason:o.disposalReason,status:"pending"}}),{error:z}=yield L.from("disposal_items").insert(w);if(z)throw console.error("âŒ [DisposalService] Error creating disposal items:",z),z;console.log("âœ… [DisposalService] Disposal items created:",w.length);const{error:F}=yield L.from("sorting_results").update({status:"disposed"}).in("id",o.selectedItems);if(F)throw console.error("âŒ [DisposalService] Error updating sorting results:",F),F;return console.log("âœ… [DisposalService] Sorting results updated to disposed status"),{success:!0,disposalRecord:t,message:`Successfully disposed ${o.selectedItems.length} items`}}catch(r){return console.error("âŒ [DisposalService] Error creating disposal:",r),console.error("âŒ [DisposalService] Error details:",{message:r instanceof Error?r.message:"Unknown error",stack:r instanceof Error?r.stack:void 0,disposalData:o}),{success:!1,error:r instanceof Error?r.message:"Unknown error occurred"}}})}getInventoryForDisposalFallback(o=30){return P(this,null,function*(){try{const r=new Date;r.setDate(r.getDate()-o);const{data:i,error:x}=yield L.from("sorting_results").select(`
          id,
          size_class,
          total_weight_grams,
          batch_number,
          storage_location_name,
          farmer_name,
          processing_date,
          quality_notes,
          storage_locations!inner(status)
        `).eq("status","available").lte("processing_date",r.toISOString().split("T")[0]).gte("total_weight_grams",0);if(x)throw x;return(i==null?void 0:i.map(t=>{var f,N;return{sorting_result_id:t.id,size_class:t.size_class,total_weight_grams:t.total_weight_grams,batch_number:t.batch_number,storage_location_name:t.storage_location_name,storage_status:((f=t.storage_locations)==null?void 0:f.status)||"active",farmer_name:t.farmer_name,processing_date:t.processing_date,days_in_storage:Math.floor((new Date().getTime()-new Date(t.processing_date).getTime())/(1e3*60*60*24)),disposal_reason:((N=t.storage_locations)==null?void 0:N.status)==="inactive"?"Storage Inactive":"Age",quality_notes:t.quality_notes}}))||[]}catch(r){return console.error("Error in fallback method:",r),[]}})}}const re=new as;function os({stats:l}){const[o,r]=y.useState([]);return y.useEffect(()=>{const i={totalDisposals:Number(l==null?void 0:l.totalDisposals)||0,totalDisposedWeight:Number(l==null?void 0:l.totalDisposedWeight)||0,totalDisposalCost:Number(l==null?void 0:l.totalDisposalCost)||0,pendingDisposals:Number(l==null?void 0:l.pendingDisposals)||0,recentDisposals:Number(l==null?void 0:l.recentDisposals)||0,averageDisposalAge:Number(l==null?void 0:l.averageDisposalAge)||0,monthlyDisposalTrend:Number(l==null?void 0:l.monthlyDisposalTrend)||0,topDisposalReason:String((l==null?void 0:l.topDisposalReason)||"Age")},x=[{id:"1",type:"warning",icon:e.jsx(ee,{className:"h-5 w-5"}),text:`ðŸ—‘ï¸ Total Disposals: ${i.totalDisposals} records | ${i.totalDisposedWeight.toFixed(1)}kg disposed`,bgColor:"bg-orange-100",textColor:"text-orange-800"},{id:"2",type:"info",icon:e.jsx(He,{className:"h-5 w-5"}),text:`ðŸ’° Disposal Costs: KES ${i.totalDisposalCost.toLocaleString()} total cost | ${i.averageDisposalAge.toFixed(1)} days avg age`,bgColor:"bg-red-100",textColor:"text-red-800"},{id:"3",type:"warning",icon:e.jsx(ve,{className:"h-5 w-5"}),text:`âš ï¸ Pending Disposals: ${i.pendingDisposals} awaiting approval | ${i.recentDisposals} this week`,bgColor:"bg-yellow-100",textColor:"text-yellow-800"},{id:"4",type:"info",icon:e.jsx(Ve,{className:"h-5 w-5"}),text:`ðŸ“‰ Disposal Trend: ${i.monthlyDisposalTrend}% change this month | Top reason: ${i.topDisposalReason}`,bgColor:"bg-purple-100",textColor:"text-purple-800"},{id:"5",type:"info",icon:e.jsx(ye,{className:"h-5 w-5"}),text:`â° Average Age: ${i.averageDisposalAge.toFixed(1)} days before disposal | Quality control active`,bgColor:"bg-indigo-100",textColor:"text-indigo-800"},{id:"6",type:"success",icon:e.jsx(le,{className:"h-5 w-5"}),text:"ðŸ“¦ Waste Management: Efficient disposal system | Environmental compliance maintained",bgColor:"bg-green-100",textColor:"text-green-800"},{id:"7",type:"info",icon:e.jsx(Ye,{className:"h-5 w-5"}),text:"âš–ï¸ Quality Control: Automated disposal triggers | Storage optimization active",bgColor:"bg-blue-100",textColor:"text-blue-800"},{id:"8",type:"achievement",icon:e.jsx(Qe,{className:"h-5 w-5"}),text:"ðŸŽ¯ Rio Fish Farm: Leading waste management practices in Kenya's fish industry",bgColor:"bg-emerald-100",textColor:"text-emerald-800"}];r(x)},[l]),e.jsx("div",{className:"w-full bg-gradient-to-r from-orange-50 to-red-50 border-b border-orange-200 shadow-sm overflow-hidden relative z-10",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"relative py-2 sm:py-3 overflow-hidden",children:e.jsxs("div",{className:"flex animate-marquee-simple whitespace-nowrap",children:[o.map(i=>e.jsxs("div",{className:`flex items-center gap-2 sm:gap-3 px-3 sm:px-6 py-1 sm:py-2 rounded-full ${i.bgColor} ${i.textColor} font-medium text-xs sm:text-sm whitespace-nowrap mx-2 sm:mx-4 shadow-sm border flex-shrink-0`,children:[i.icon,e.jsx("span",{children:i.text})]},i.id)),o.map(i=>e.jsxs("div",{className:`flex items-center gap-2 sm:gap-3 px-3 sm:px-6 py-1 sm:py-2 rounded-full ${i.bgColor} ${i.textColor} font-medium text-xs sm:text-sm whitespace-nowrap mx-2 sm:mx-4 shadow-sm border flex-shrink-0`,children:[i.icon,e.jsx("span",{children:i.text})]},`duplicate-${i.id}`))]})})})})}const ws=()=>{const[l,o]=y.useState([]),[r,i]=y.useState({totalDisposals:0,totalDisposedWeight:0,totalDisposalCost:0,pendingDisposals:0,recentDisposals:0,averageDisposalAge:0,topDisposalReason:"Age"}),[x,t]=y.useState([]),[f,N]=y.useState(!0),[b,w]=y.useState(!1),[z,F]=y.useState(!1),[_,p]=y.useState(!1),[I,S]=y.useState(null),[v,n]=y.useState("all"),[g,k]=y.useState(1),[C,D]=y.useState([]),[R,A]=y.useState(""),[O,U]=y.useState(new Set),[h,j]=y.useState(0),[M,W]=y.useState(""),[q,Q]=y.useState("waste"),[J,te]=y.useState(!1),[V,X]=y.useState({from:new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0],to:new Date().toISOString().split("T")[0]}),ie=[{value:"all",label:"All Items",description:"Show all available items",days:0},{value:"custom_age",label:"Custom Age",description:"Items older than specified days",days:0},{value:"inactive_storage",label:"Inactive Storage",description:"Items in inactive storage locations",days:0}],we=[{value:"waste",label:"Waste Disposal",description:"Dispose as general waste"},{value:"compost",label:"Compost",description:"Convert to compost for farming"},{value:"donation",label:"Donation",description:"Donate to charity or food bank"},{value:"return_to_farmer",label:"Return to Farmer",description:"Return to original farmer"}];y.useEffect(()=>{ne(),ce()},[]),y.useEffect(()=>{ce()},[v,g]);const ne=()=>P(void 0,null,function*(){try{N(!0);const[s,a]=yield Promise.all([re.getDisposalRecords(),re.getDisposalStats()]);o(s),i(a)}catch(s){console.error("Error loading disposal data:",s)}finally{N(!1)}}),ce=()=>P(void 0,null,function*(){try{let s=0,a,c=!1,u=!1;v==="all"?(s=0,u=!0):v==="custom_age"?s=g:v==="inactive_storage"&&(s=0,c=!0,u=!1);const d=yield re.getInventoryForDisposal(s,u,a,c);t(d)}catch(s){console.error("Error loading inventory for disposal:",s),t([])}}),De=()=>P(void 0,null,function*(){if(C.length===0){alert("Please select at least one item for disposal");return}try{p(!0);const a=x.filter(u=>C.includes(u.sorting_result_id)).reduce((u,d)=>u+d.total_weight_grams/1e3,0),c=yield re.createDisposal({selectedItems:C,disposalReason:R,disposalCost:h,disposalNotes:M,disposalMethod:q,totalWeight:a});c.success?(alert(`âœ… ${c.message}`),Se(),w(!1),yield ne()):alert(`âŒ Error creating disposal: ${c.error}`)}catch(s){console.error("Error creating disposal:",s),alert("âŒ An error occurred while creating the disposal record")}finally{p(!1)}}),Se=()=>{n("all"),k(1),D([]),A(""),j(0),W(""),Q("waste")},Ce=s=>{D(a=>a.includes(s)?a.filter(c=>c!==s):[...a,s])},ke=s=>{U(a=>{const c=new Set(a);return c.has(s)?c.delete(s):c.add(s),c})},Ae=()=>{const s=new Set(x.map(a=>a.storage_location_name));U(s)},Te=()=>{U(new Set)},Ee=()=>{const s=x.map(a=>a.sorting_result_id);D(s)},Ie=()=>{D([])},de=()=>{const s=l.filter(d=>{const m=new Date(d.created_at).toISOString().split("T")[0];return m>=V.from&&m<=V.to}),a=s.reduce((d,m)=>d+(m.total_weight_kg||0),0),c=s.reduce((d,m)=>d+(m.disposal_cost||0),0),u={};return s.forEach(d=>{var $;const m=typeof d.disposal_reason=="object"?(($=d.disposal_reason)==null?void 0:$.name)||"Unknown":d.disposal_reason||"Unknown";u[m]||(u[m]={count:0,weight:0,cost:0}),u[m].count++,u[m].weight+=d.total_weight_kg||0,u[m].cost+=d.disposal_cost||0}),{totalRecords:s.length,totalWeight:a,totalCost:c,reasonGroups:u,records:s}},Fe=()=>{const s=de(),a=[["Date","Time","Batch Numbers","Size Classes","Disposal Reason","Disposal Method","Weight (kg)","Cost (KES)","Created By","Approved By","Status","Notes"].join(","),...s.records.map(m=>{var Z,me,ge;const $=new Date(m.created_at);return[$.toLocaleDateString(),$.toLocaleTimeString(),((Z=m.batch_numbers)==null?void 0:Z.join("; "))||"N/A",((me=m.size_classes)==null?void 0:me.join("; "))||"N/A",typeof m.disposal_reason=="object"?((ge=m.disposal_reason)==null?void 0:ge.name)||"Unknown":m.disposal_reason||"Unknown",m.disposal_method||"N/A",m.total_weight_kg||0,m.disposal_cost||0,m.created_by||"N/A",m.approved_by||"N/A",m.status,m.notes||"N/A"].map(Re=>`"${Re}"`).join(",")})].join(`
`),c=new Blob([a],{type:"text/csv"}),u=window.URL.createObjectURL(c),d=document.createElement("a");d.href=u,d.download=`disposal-report-${V.from}-to-${V.to}.csv`,d.click(),window.URL.revokeObjectURL(u)};return f?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading disposal data..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 content-container",children:[e.jsx(os,{stats:r}),e.jsxs("div",{className:"container mx-auto responsive-padding max-w-full overflow-x-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Disposal Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage fish disposal and waste handling"})]}),e.jsxs(K,{className:"bg-red-600 hover:bg-red-700 text-white",onClick:()=>w(!0),children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Create Disposal"]})]}),e.jsx(Le,{open:b,onOpenChange:w,children:e.jsxs(qe,{className:"!max-w-4xl !w-[90vw] !h-[80vh] !flex !flex-col !top-[10vh] !left-[5vw] !translate-x-0 !translate-y-0",children:[e.jsxs(Be,{children:[e.jsx(Pe,{className:"text-xl font-semibold",children:"Create New Disposal Record"}),e.jsx(Ke,{children:"Configure disposal criteria and select items for disposal"})]}),e.jsxs("div",{className:"space-y-4 flex-1 overflow-y-auto overflow-x-hidden min-h-0 pt-2",style:{maxHeight:"calc(80vh - 150px)"},children:[e.jsxs(T,{className:"shadow-lg border-0 bg-gradient-to-br from-blue-50 to-indigo-50 max-w-md mx-auto",children:[e.jsxs(G,{className:"pb-4",children:[e.jsxs(H,{className:"text-xl font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5 text-blue-600"}),"Select Filter Criteria"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Choose criteria for selecting items to dispose"})]}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{htmlFor:"ageCategory",className:"text-sm font-semibold text-gray-700",children:"Filter Criteria *"}),e.jsxs(pe,{value:v,onValueChange:s=>{n(s);const a=ie.find(c=>c.value===s);a&&A(a.label)},children:[e.jsx(ue,{className:"h-12 bg-white border-2 border-gray-200 hover:border-blue-300 focus:border-blue-500 transition-colors",children:e.jsx(fe,{placeholder:"Select filter criteria"})}),e.jsx(je,{children:ie.map(s=>e.jsx(be,{value:s.value,children:e.jsxs("div",{className:"flex flex-col py-1",children:[e.jsx("span",{className:"font-medium text-gray-800",children:s.label}),e.jsx("span",{className:"text-xs text-gray-500",children:s.description})]})},s.value))})]})]})})]}),v&&v!==""&&e.jsxs("div",{className:"space-y-4",children:[v==="custom_age"&&e.jsxs(T,{className:"shadow-lg border-0 bg-gradient-to-br from-yellow-50 to-orange-50 max-w-md mx-auto",children:[e.jsxs(G,{className:"pb-4",children:[e.jsxs(H,{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-orange-600"}),"Custom Age Threshold"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Set the minimum age in days for items to dispose"})]}),e.jsx(E,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{htmlFor:"customDaysOld",className:"text-sm font-semibold text-gray-700",children:"Days Old Threshold *"}),e.jsx(se,{id:"customDaysOld",type:"number",value:g,onChange:s=>k(Number(s.target.value)),className:"h-12 bg-white border-2 border-gray-200 hover:border-orange-300 focus:border-orange-500 transition-colors",placeholder:"Enter days old threshold",min:"1"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 max-w-full overflow-x-hidden",children:[e.jsxs(T,{className:"shadow-lg border-0 bg-gradient-to-br from-blue-50 to-indigo-50",children:[e.jsxs(G,{className:"pb-4",children:[e.jsxs(H,{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(ee,{className:"w-5 h-5 text-blue-600"}),"Filter Items for Disposal"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Configure criteria for selecting items"})]}),e.jsx(E,{className:"space-y-4",children:v==="custom_age"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{className:"text-sm font-semibold text-gray-700",children:"Age Threshold"}),e.jsx("div",{className:"p-3 bg-white rounded-lg border border-gray-200",children:e.jsxs("span",{className:"text-sm text-gray-600",children:[g," days or older"]})})]})})]}),e.jsxs(T,{className:"shadow-lg border-0 bg-gradient-to-br from-green-50 to-emerald-50",children:[e.jsxs(G,{className:"pb-4",children:[e.jsxs(H,{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5 text-green-600"}),"Disposal Details"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Provide disposal information"})]}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{htmlFor:"disposalMethod",className:"text-sm font-semibold text-gray-700",children:"Disposal Method *"}),e.jsxs(pe,{value:q,onValueChange:Q,children:[e.jsx(ue,{className:"h-12 bg-white border-2 border-gray-200 hover:border-green-300 focus:border-green-500 transition-colors",children:e.jsx(fe,{placeholder:"Select disposal method"})}),e.jsx(je,{children:we.map(s=>e.jsx(be,{value:s.value,children:e.jsxs("div",{className:"flex flex-col py-1",children:[e.jsx("span",{className:"font-medium text-gray-800",children:s.label}),e.jsx("span",{className:"text-xs text-gray-500",children:s.description})]})},s.value))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{htmlFor:"disposalCost",className:"text-sm font-semibold text-gray-700",children:"Disposal Cost (KES)"}),e.jsx(se,{id:"disposalCost",type:"number",value:h,onChange:s=>j(Number(s.target.value)),className:"h-12 bg-white border-2 border-gray-200 hover:border-green-300 focus:border-green-500 transition-colors",placeholder:"Enter disposal cost",min:"0",step:"0.01"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Y,{htmlFor:"disposalNotes",className:"text-sm font-semibold text-gray-700",children:"Notes"}),e.jsx(se,{id:"disposalNotes",value:M,onChange:s=>W(s.target.value),className:"h-12 bg-white border-2 border-gray-200 hover:border-green-300 focus:border-green-500 transition-colors",placeholder:"Additional notes (optional)"})]})]})]})]}),e.jsxs(T,{className:"overflow-hidden",children:[e.jsxs(G,{className:"pb-4",children:[e.jsxs(H,{className:"text-lg font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(_e,{className:"w-5 h-5 text-gray-600"}),"Available Items for Disposal (",x.length,")"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[v==="all"&&"Showing all available items",v==="custom_age"&&`Showing items older than ${g} days`,v==="inactive_storage"&&"Showing items in inactive storage locations"]})]}),e.jsx(E,{className:"max-h-96 overflow-y-auto",children:x.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ee,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No items found matching your criteria"})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between bg-blue-50 p-3 rounded-lg",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",x.length," items across ",new Set(x.map(s=>s.storage_location_name)).size," storage locations",C.length>0&&e.jsxs("span",{className:"ml-2 font-semibold text-blue-600",children:["â€¢ ",C.length," selected"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(K,{variant:"outline",size:"sm",onClick:Ae,className:"text-xs",children:"Expand All"}),e.jsx(K,{variant:"outline",size:"sm",onClick:Te,className:"text-xs",children:"Collapse All"}),e.jsx(K,{variant:"outline",size:"sm",onClick:Ee,className:"text-xs bg-green-50 hover:bg-green-100 text-green-700 border-green-200",children:"Select All"}),e.jsx(K,{variant:"outline",size:"sm",onClick:Ie,className:"text-xs bg-red-50 hover:bg-red-100 text-red-700 border-red-200",children:"Deselect All"})]})]}),Object.entries(x.reduce((s,a)=>{const c=a.storage_location_name;return s[c]||(s[c]=[]),s[c].push(a),s},{})).map(([s,a])=>{const c=O.has(s),u=a;return e.jsxs(T,{className:"border-2 border-gray-200",children:[e.jsxs(G,{className:"pb-3 cursor-pointer hover:bg-gray-50 transition-colors",onClick:()=>ke(s),children:[e.jsxs(H,{className:"text-lg font-semibold text-gray-800 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[c?e.jsx(Xe,{className:"w-4 h-4 text-gray-500"}):e.jsx(Ze,{className:"w-4 h-4 text-gray-500"}),e.jsx(_e,{className:"w-5 h-5 text-blue-600"}),s]}),e.jsxs(B,{variant:"outline",className:"text-sm",children:[u.length," items"]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Total Weight: ",(u.reduce((d,m)=>d+m.total_weight_grams,0)/1e3).toFixed(2)," kg"]})]}),c&&e.jsx(E,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 overflow-x-hidden",children:u.map(d=>e.jsx(T,{className:`cursor-pointer transition-all duration-200 hover:shadow-md ${C.includes(d.sorting_result_id)?"ring-2 ring-red-500 bg-red-50":"hover:bg-gray-50"}`,onClick:()=>Ce(d.sorting_result_id),children:e.jsxs(E,{className:"p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(B,{variant:"outline",className:"text-xs",children:d.batch_number}),e.jsxs(B,{variant:"secondary",className:"text-xs",children:["Size ",d.size_class]})]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Weight:"}),e.jsxs("span",{className:"font-medium",children:[(d.total_weight_grams/1e3).toFixed(2)," kg"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Age:"}),e.jsxs("span",{className:"font-medium",children:[d.days_in_storage," days"]})]})]}),C.includes(d.sorting_result_id)&&e.jsx("div",{className:"mt-2 text-center",children:e.jsx(B,{className:"bg-red-600 text-white text-xs",children:"Selected"})})]})},d.sorting_result_id))})})]},s)})]})})]})]})]}),e.jsxs(Ge,{className:"flex-shrink-0 border-t pt-4",children:[e.jsx(K,{variant:"outline",onClick:()=>w(!1),children:"Cancel"}),v&&v!==""&&e.jsx(K,{onClick:De,className:"bg-red-600 hover:bg-red-700",disabled:_,children:_?"Processing...":"Create Disposal"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(T,{children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Disposals"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.length})]}),e.jsx(ee,{className:"h-8 w-8 text-gray-400"})]})})}),e.jsx(T,{children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Weight"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[(r.totalDisposedWeight||0).toFixed(1)," kg"]})]}),e.jsx(le,{className:"h-8 w-8 text-gray-400"})]})})}),e.jsx(T,{children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Cost"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["KES ",(r.totalDisposalCost||0).toFixed(2)]})]}),e.jsx(Ne,{className:"h-8 w-8 text-gray-400"})]})})}),e.jsx(T,{children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.pendingDisposals||0})]}),e.jsx(ve,{className:"h-8 w-8 text-gray-400"})]})})})]}),e.jsxs(T,{className:"mb-6",children:[e.jsx(G,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(H,{className:"flex items-center gap-2",children:[e.jsx(We,{className:"w-5 h-5 text-blue-600"}),"Disposal Reports"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(K,{variant:"outline",size:"sm",onClick:()=>te(!J),className:"flex items-center gap-2",children:[e.jsx(es,{className:"w-4 h-4"}),J?"Hide Reports":"Show Reports"]}),J&&e.jsxs(K,{variant:"outline",size:"sm",onClick:Fe,className:"flex items-center gap-2",children:[e.jsx(ss,{className:"w-4 h-4"}),"Export CSV"]})]})]})}),J&&e.jsxs(E,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx(Y,{htmlFor:"reportFromDate",className:"text-sm font-semibold text-gray-700",children:"From Date"}),e.jsx(se,{id:"reportFromDate",type:"date",value:V.from,onChange:s=>X(a=>oe(ae({},a),{from:s.target.value})),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(Y,{htmlFor:"reportToDate",className:"text-sm font-semibold text-gray-700",children:"To Date"}),e.jsx(se,{id:"reportToDate",type:"date",value:V.to,onChange:s=>X(a=>oe(ae({},a),{to:s.target.value})),className:"mt-1"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(K,{onClick:()=>{const s=new Date().toISOString().split("T")[0],a=new Date(Date.now()-30*24*60*60*1e3).toISOString().split("T")[0];X({from:a,to:s})},variant:"outline",size:"sm",className:"w-full",children:"Last 30 Days"})})]}),(()=>{const s=de();return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(T,{className:"bg-blue-50 border-blue-200",children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-blue-600",children:"Total Disposals"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:s.totalRecords})]}),e.jsx(ee,{className:"h-8 w-8 text-blue-400"})]})})}),e.jsx(T,{className:"bg-green-50 border-green-200",children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-600",children:"Total Weight"}),e.jsxs("p",{className:"text-2xl font-bold text-green-900",children:[s.totalWeight.toFixed(1)," kg"]})]}),e.jsx(le,{className:"h-8 w-8 text-green-400"})]})})}),e.jsx(T,{className:"bg-orange-50 border-orange-200",children:e.jsx(E,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-orange-600",children:"Total Cost"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-900",children:["KES ",s.totalCost.toLocaleString()]})]}),e.jsx(ts,{className:"h-8 w-8 text-orange-400"})]})})})]}),e.jsxs(T,{children:[e.jsx(G,{children:e.jsx(H,{className:"text-lg",children:"Disposal by Reason"})}),e.jsx(E,{children:Object.keys(s.reasonGroups).length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No disposals found for the selected date range"}):e.jsx("div",{className:"space-y-3",children:Object.entries(s.reasonGroups).map(([a,c])=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(B,{variant:"outline",className:"text-sm",children:[c.count," records"]}),e.jsx("span",{className:"font-medium text-gray-800",children:a})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-sm text-gray-600",children:[c.weight.toFixed(1)," kg â€¢ KES ",c.cost.toLocaleString()]})})]},a))})})]}),e.jsxs(T,{children:[e.jsx(G,{children:e.jsx(H,{className:"text-lg",children:"Recent Disposals"})}),e.jsx(E,{children:s.records.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No disposals found for the selected date range"}):e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left p-2 font-medium",children:"Date & Time"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Batch Numbers"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Size Classes"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Reason"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Method"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Weight (kg)"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Cost (KES)"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Created By"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Approved By"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Status"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Notes"})]})}),e.jsx("tbody",{children:s.records.slice(0,10).map(a=>{var u,d,m;const c=new Date(a.created_at);return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{children:c.toLocaleDateString()}),e.jsx("div",{className:"text-gray-500",children:c.toLocaleTimeString()})]})}),e.jsx("td",{className:"p-2",children:e.jsx("div",{className:"text-xs",children:(u=a.batch_numbers)!=null&&u.length?a.batch_numbers.map(($,Z)=>e.jsx(B,{variant:"outline",className:"text-xs mr-1 mb-1",children:$},Z)):e.jsx("span",{className:"text-gray-400",children:"N/A"})})}),e.jsx("td",{className:"p-2",children:e.jsx("div",{className:"text-xs",children:(d=a.size_classes)!=null&&d.length?a.size_classes.map(($,Z)=>e.jsxs(B,{variant:"secondary",className:"text-xs mr-1 mb-1",children:["Size ",$]},Z)):e.jsx("span",{className:"text-gray-400",children:"N/A"})})}),e.jsx("td",{className:"p-2 text-xs",children:typeof a.disposal_reason=="object"?((m=a.disposal_reason)==null?void 0:m.name)||"Unknown":a.disposal_reason||"Unknown"}),e.jsx("td",{className:"p-2 text-xs",children:a.disposal_method||"N/A"}),e.jsx("td",{className:"p-2 text-xs font-medium",children:(a.total_weight_kg||0).toFixed(1)}),e.jsx("td",{className:"p-2 text-xs font-medium",children:(a.disposal_cost||0).toLocaleString()}),e.jsx("td",{className:"p-2 text-xs",children:a.created_by||"N/A"}),e.jsx("td",{className:"p-2 text-xs",children:a.approved_by||"N/A"}),e.jsx("td",{className:"p-2",children:e.jsx(B,{variant:a.status==="completed"?"default":"secondary",className:"text-xs",children:a.status})}),e.jsx("td",{className:"p-2 text-xs max-w-32 truncate",title:a.notes||"",children:a.notes||"N/A"})]},a.id)})})]}),s.records.length>10&&e.jsxs("p",{className:"text-sm text-gray-500 mt-2 text-center",children:["Showing 10 of ",s.records.length," records"]})]})})]})]})})()]})]}),e.jsxs(T,{children:[e.jsx(G,{children:e.jsx(H,{children:"Disposal Records"})}),e.jsx(E,{children:l.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ee,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"No disposal records found"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left p-2 font-medium",children:"Date & Time"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Batch Numbers"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Size Classes"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Reason"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Method"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Weight (kg)"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Cost (KES)"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Created By"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Approved By"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Status"}),e.jsx("th",{className:"text-left p-2 font-medium",children:"Notes"})]})}),e.jsx("tbody",{children:l.map(s=>{var c,u,d;const a=new Date(s.created_at);return e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-2",children:e.jsxs("div",{className:"text-xs",children:[e.jsx("div",{children:a.toLocaleDateString()}),e.jsx("div",{className:"text-gray-500",children:a.toLocaleTimeString()})]})}),e.jsx("td",{className:"p-2",children:e.jsx("div",{className:"text-xs",children:(c=s.batch_numbers)!=null&&c.length?s.batch_numbers.map((m,$)=>e.jsx(B,{variant:"outline",className:"text-xs mr-1 mb-1",children:m},$)):e.jsx("span",{className:"text-gray-400",children:"N/A"})})}),e.jsx("td",{className:"p-2",children:e.jsx("div",{className:"text-xs",children:(u=s.size_classes)!=null&&u.length?s.size_classes.map((m,$)=>e.jsxs(B,{variant:"secondary",className:"text-xs mr-1 mb-1",children:["Size ",m]},$)):e.jsx("span",{className:"text-gray-400",children:"N/A"})})}),e.jsx("td",{className:"p-2 text-xs",children:typeof s.disposal_reason=="object"?((d=s.disposal_reason)==null?void 0:d.name)||"Unknown":s.disposal_reason||"Unknown"}),e.jsx("td",{className:"p-2 text-xs",children:s.disposal_method||"N/A"}),e.jsx("td",{className:"p-2 text-xs font-medium",children:s.total_weight_kg.toFixed(2)}),e.jsx("td",{className:"p-2 text-xs font-medium",children:s.disposal_cost.toFixed(2)}),e.jsx("td",{className:"p-2 text-xs",children:s.created_by||"N/A"}),e.jsx("td",{className:"p-2 text-xs",children:s.approved_by||"N/A"}),e.jsx("td",{className:"p-2",children:e.jsx(B,{variant:s.status==="completed"?"default":"secondary",className:"text-xs",children:s.status})}),e.jsx("td",{className:"p-2 text-xs max-w-32 truncate",title:s.notes||"",children:s.notes||"N/A"})]},s.id)})})]})})})]})]})]})};export{ws as default};
