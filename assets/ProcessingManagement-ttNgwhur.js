const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/entryCodeGenerator-B_emgdBK.js","assets/index-BsUmuyG4.js","assets/index-c8IhzymI.css"])))=>i.map(i=>d[i]);
var Re=Object.defineProperty,Te=Object.defineProperties;var We=Object.getOwnPropertyDescriptors;var he=Object.getOwnPropertySymbols;var Fe=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var pe=(a,t,r)=>t in a?Re(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r,L=(a,t)=>{for(var r in t||(t={}))Fe.call(t,r)&&pe(a,r,t[r]);if(he)for(var r of he(t))Le.call(t,r)&&pe(a,r,t[r]);return a},O=(a,t)=>Te(a,We(t));var D=(a,t,r)=>new Promise((l,o)=>{var _=j=>{try{y(r.next(j))}catch(N){o(N)}},C=j=>{try{y(r.throw(j))}catch(N){o(N)}},y=j=>j.done?l(j.value):Promise.resolve(j.value).then(_,C);y((r=r.apply(a,t)).next())});import{r as p,j as e,d as Z,B as b,H as Oe,a as w,f as E,g as U,C as ye,b as A,l as u,E as je,P as ae,s as z,_ as ze,L as V,I as K}from"./index-BsUmuyG4.js";import{S as Be,a as Ge,b as Me,c as $e,d as re}from"./select-DpDEOpGc.js";import{D as fe,a as Ye,b as ue,c as Ne,d as be}from"./dialog-5_o2uvs1.js";import{getOrGenerateEntryCode as Ee,getOrGenerateProcessingCode as Ue}from"./entryCodeGenerator-B_emgdBK.js";import{R as ne}from"./refresh-cw-mNOj2Y0g.js";import{P as Ve}from"./plus-6Z69TOmA.js";import{T as we}from"./trending-up-BGl6jV3k.js";import{S as Ie}from"./star-DMOlXcJm.js";import{C as qe}from"./clock-BAGB9i0B.js";import{M as le}from"./map-pin-H2p0nG-2.js";import{C as _e}from"./calendar-B_cPd3ko.js";import{C as ve}from"./circle-alert-FZyE1zWR.js";import{S as He}from"./scale-nOZOIHzY.js";import{W as Qe}from"./weight-1vY1U_u6.js";import{C as Je}from"./circle-check-big-DM7oTrKY.js";import"./index-CWowWWhq.js";import"./index-DPWWBWxf.js";import"./index-aBDulcc9.js";const ee=a=>({A:"bg-green-500",B:"bg-yellow-500",C:"bg-orange-500"})[a]||"bg-gray-500",se=a=>a>=80?"text-green-600":a>=70?"text-yellow-600":"text-red-600",Xe=({data:a,dataKey:t})=>{if(!a||a.length===0)return e.jsx("div",{className:"flex items-center justify-center h-32 text-gray-500",children:"No data available"});const r=Math.max(...a.map(l=>l[t]||0));return e.jsx("div",{className:"flex items-end justify-between h-32 gap-1",children:a.map((l,o)=>e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:"bg-blue-500 rounded-t w-full min-h-[4px]",style:{height:`${r>0?(l[t]||0)/r*100:0}%`}}),e.jsx("span",{className:"text-xs text-gray-600 mt-1 text-center",children:l.date?new Date(l.date).getDate():o+1})]},o))})},Ze=({data:a,dataKey:t})=>{if(!a||a.length===0)return e.jsx("div",{className:"flex items-center justify-center h-32 text-gray-500",children:"No data available"});const r=a.map(C=>C[t]||0),l=Math.max(...r),o=Math.min(...r),_=l-o||1;return e.jsx("div",{className:"relative h-32",children:e.jsxs("svg",{width:"100%",height:"100%",className:"overflow-visible",children:[e.jsx("polyline",{fill:"none",stroke:"#8b5cf6",strokeWidth:"2",points:a.map((C,y)=>{const j=a.length>1?y/(a.length-1)*100:50,S=100-((C[t]||0)-o)/_*80,P=isNaN(S)?50:Math.max(0,Math.min(100,S));return`${j},${P}`}).join(" ")}),a.map((C,y)=>{const j=a.length>1?y/(a.length-1)*100:50,S=100-((C[t]||0)-o)/_*80,P=isNaN(S)?50:Math.max(0,Math.min(100,S));return e.jsx("circle",{cx:`${j}%`,cy:`${P}%`,r:"3",fill:"#8b5cf6"},y)})]})})},Ke=({stats:a,processingRecords:t})=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6",children:[e.jsx(w,{className:"bg-gradient-to-br from-blue-500 to-blue-600 text-white",children:e.jsx(A,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm",children:"Ready for Processing"}),e.jsx("p",{className:"text-3xl font-bold",children:a.readyForProcessing})]}),e.jsx(ve,{className:"h-8 w-8 text-blue-200"})]})})}),e.jsx(w,{className:"bg-gradient-to-br from-green-500 to-green-600 text-white",children:e.jsx(A,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-100 text-sm",children:"Total Processed"}),e.jsx("p",{className:"text-3xl font-bold",children:a.totalProcessed})]}),e.jsx(Je,{className:"h-8 w-8 text-green-200"})]})})}),e.jsx(w,{className:"bg-gradient-to-br from-purple-500 to-purple-600 text-white",children:e.jsx(A,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-purple-100 text-sm",children:"Average Yield"}),e.jsxs("p",{className:"text-3xl font-bold",children:[a.averageYield,"%"]})]}),e.jsx(we,{className:"h-8 w-8 text-purple-200"})]})})}),e.jsx(w,{className:"bg-gradient-to-br from-orange-500 to-orange-600 text-white",children:e.jsx(A,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-100 text-sm",children:"Total Waste"}),e.jsxs("p",{className:"text-3xl font-bold",children:[a.totalWaste,"kg"]})]}),e.jsx(ye,{className:"h-8 w-8 text-orange-200"})]})})})]}),es=({selectedEntryId:a,setSelectedEntryId:t,warehouseEntries:r,processingRecords:l,formData:o,setFormData:_,selectedStorage:C,setSelectedStorage:y,storageLocations:j,isProcessing:N,onSubmit:S,onClose:P})=>{var G,g,q,H,F,M,$,Y;const B=r.filter(i=>!a||i.id===a).filter(i=>!l.some(R=>R.warehouse_entry_id===i.id)),I=(i,R)=>{_(O(L({},o),{[i]:R}))};return a?e.jsxs("div",{className:"py-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-1",children:"Selected Entry"}),e.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[e.jsx(u,{variant:"outline",className:"bg-white",children:(G=r.find(i=>i.id===a))==null?void 0:G.entry_code}),e.jsxs("span",{className:"text-blue-700",children:[(g=r.find(i=>i.id===a))==null?void 0:g.total_weight,"kg - ",(q=r.find(i=>i.id===a))==null?void 0:q.total_pieces," pieces"]}),e.jsxs("span",{className:"text-blue-600",children:["â€¢ ",(H=r.find(i=>i.id===a))==null?void 0:H.farmer_name]})]})]}),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>{t(""),_({})},children:"Change Entry"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{className:"text-sm font-medium",children:"Pre-Processing Weight (kg)"}),e.jsx(K,{type:"number",value:((F=r.find(i=>i.id===a))==null?void 0:F.total_weight)||"",readOnly:!0,className:"bg-gray-50"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{className:"text-sm font-medium",children:"Post-Processing Weight (kg) *"}),e.jsx(K,{type:"number",step:"0.1",value:o.post_processing_weight||"",onChange:i=>I("post_processing_weight",Number(i.target.value)),placeholder:"Enter weight after processing"})]})]}),o.post_processing_weight&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Processing Calculations"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{className:"bg-white p-3 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Processing Waste"}),e.jsxs("p",{className:"text-xl font-bold text-red-600",children:[o.processing_waste||0,"kg"]})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Processing Yield"}),e.jsxs("p",{className:`text-xl font-bold ${se(o.processing_yield||0)}`,children:[o.processing_yield||0,"%"]})]}),e.jsxs("div",{className:"bg-white p-3 rounded-lg border",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Weight Loss"}),e.jsxs("p",{className:"text-xl font-bold text-orange-600",children:[((o.processing_waste||0)/(((M=r.find(i=>i.id===a))==null?void 0:M.total_weight)||1)*100).toFixed(1),"%"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{className:"text-sm font-medium",children:"Number of Fish"}),e.jsx(K,{type:"number",value:(($=r.find(i=>i.id===a))==null?void 0:$.total_pieces)||"",readOnly:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Inherited from warehouse entry"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{className:"text-sm font-medium",children:"Final Grade *"}),e.jsxs(Be,{value:o.final_grade||"",onValueChange:i=>I("final_grade",i),children:[e.jsx(Ge,{children:e.jsx(Me,{placeholder:"Select grade"})}),e.jsxs($e,{children:[e.jsx(re,{value:"A",children:"Grade A"}),e.jsx(re,{value:"B",children:"Grade B"}),e.jsx(re,{value:"C",children:"Grade C"})]})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Size classification will be determined during sorting process"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{className:"text-sm font-medium",children:"Fish Type"}),e.jsx(K,{value:((Y=r.find(i=>i.id===a))==null?void 0:Y.fish_type)||"Not specified",readOnly:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Inherited from warehouse entry"})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(ae,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Next Step: Sorting"}),e.jsx("p",{className:"text-sm text-blue-700",children:"After processing, fish will be sorted into size classes and assigned to storage locations."})]})]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(b,{variant:"outline",onClick:P,children:"Cancel"}),e.jsx(b,{onClick:S,className:"bg-blue-600 hover:bg-blue-700",disabled:!o.post_processing_weight||!o.final_grade||N,children:N?e.jsxs(e.Fragment,{children:[e.jsx(ne,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):"Complete Processing"})]})]})]}):e.jsxs("div",{className:"py-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ae,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Select Warehouse Entry"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Choose a warehouse entry to begin processing"})]}),B.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ve,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No Entries Available"}),e.jsx("p",{className:"text-sm text-gray-400",children:r.length===0?"No warehouse entries found":"All warehouse entries have been processed"}),r.length>0&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-700",children:[e.jsx("strong",{children:r.length})," total warehouse entries exist,",e.jsxs("strong",{children:[" ",l.length]})," have been processed"]})})]}):e.jsx("div",{className:"space-y-3",children:B.map(i=>e.jsx(w,{className:"p-4 hover:shadow-md transition-all duration-200 cursor-pointer border hover:border-blue-300",onClick:()=>t(i.id),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(He,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(u,{variant:"outline",className:"font-medium",children:i.entry_code}),e.jsxs(u,{className:"bg-green-500 text-white font-medium",children:[i.total_pieces," pieces"]})]}),e.jsxs("div",{className:"flex items-center gap-6 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Qe,{className:"h-4 w-4"}),i.total_weight,"kg"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(_e,{className:"h-4 w-4"}),new Date(i.entry_date).toLocaleDateString()]}),e.jsxs("span",{className:"flex items-center gap-1 font-medium text-gray-900",children:[e.jsx(le,{className:"h-4 w-4"}),i.farmer_name]})]})]})]}),e.jsx(b,{size:"sm",className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:R=>{R.stopPropagation(),t(i.id)},children:"Select"})]})},i.id))}),e.jsxs("div",{className:"flex justify-between pt-6 border-t mt-6",children:[e.jsxs(b,{variant:"outline",onClick:()=>{window.location.reload()},className:"text-blue-600 border-blue-300 hover:bg-blue-50",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Refresh Entries"]}),e.jsx(b,{variant:"outline",onClick:P,children:"Cancel"})]})]})};function bs({onNavigate:a}){var me;const[t,r]=p.useState([]),[l,o]=p.useState([]),[_,C]=p.useState([]),[y,j]=p.useState([]),[N,S]=p.useState(""),[P,B]=p.useState(""),[I,G]=p.useState(!1),[g,q]=p.useState(null),[H,F]=p.useState(!1),[M,$]=p.useState(!1),[Y,i]=p.useState(!1),[R,ce]=p.useState(!1),[h,Q]=p.useState({}),[W,Ce]=p.useState({totalProcessed:0,readyForProcessing:0,averageYield:0,totalWaste:0,gradeDistribution:{A:0,B:0,C:0},weeklyProcessing:[],yieldTrends:[]}),oe=()=>D(this,null,function*(){const{data:s,error:n}=yield z.from("warehouse_entries").select(`
        *,
        farmers!inner(name)
      `).order("entry_date",{ascending:!1});if(n)console.error("Error fetching warehouse entries:",n.message);else{const d=yield Promise.all((s||[]).map(m=>D(this,null,function*(){var k;const v=m.entry_code||(yield Ee(m.id));return O(L({},m),{farmer_name:((k=m.farmers)==null?void 0:k.name)||`Farmer ID: ${m.farmer_id}`,entry_code:v})})));r(d)}}),J=()=>D(this,null,function*(){const{data:s,error:n}=yield z.from("processing_records").select(`
        *,
        warehouse_entries!inner(
          id,
          farmer_id,
          farmers!inner(name)
        )
      `).order("processing_date",{ascending:!1});if(n)console.error("Error fetching processing records:",n.message);else{const d=yield Promise.all((s||[]).map(m=>D(this,null,function*(){var x,f;const v=m.grading_results||{},k=m.size_distribution||{},T=Object.keys(v)[0]||"A";Object.keys(k)[0];const c=m.processing_code||(yield Ue(m.id));return O(L({},m),{farmer_name:((f=(x=m.warehouse_entries)==null?void 0:x.farmers)==null?void 0:f.name)||"Unknown Farmer",final_grade:T,final_size:null,storage_location:"Not specified",ready_for_dispatch:!1,processing_code:c})})));o(d),C(d.slice(0,5))}}),de=()=>D(this,null,function*(){try{const{data:s,error:n}=yield z.from("storage_locations").select("*").eq("status","active").order("name");if(n)console.warn("Storage locations table not found, using default locations:",n.message),j([{id:"1",name:"Cold Storage A",capacity:2e3},{id:"2",name:"Cold Storage B",capacity:1500},{id:"3",name:"Freezer Unit 1",capacity:1e3},{id:"4",name:"Processing Area 1",capacity:500},{id:"5",name:"Processing Area 2",capacity:500}]);else{const{data:d,error:m}=yield z.from("processing_records").select("post_processing_weight"),v=new Map;if(d&&!m){const x=d.reduce((f,X)=>f+(X.post_processing_weight||0),0)/((s==null?void 0:s.length)||1);s==null||s.forEach(f=>{v.set(f.name,x)})}const T=((s==null?void 0:s.map(c=>({id:c.id,name:c.name,capacity:c.capacity_kg,currentUsage:v.get(c.name)||0,availableCapacity:c.capacity_kg-(v.get(c.name)||0)})))||[]).filter(c=>c.availableCapacity>0);T.length===0?(console.warn("No available storage locations found, using defaults"),j([{id:"1",name:"Cold Storage A",capacity:2e3},{id:"2",name:"Cold Storage B",capacity:1500},{id:"3",name:"Freezer Unit 1",capacity:1e3},{id:"4",name:"Processing Area 1",capacity:500},{id:"5",name:"Processing Area 2",capacity:500}])):j(T)}}catch(s){console.warn("Error fetching storage locations, using defaults:",s),j([{id:"1",name:"Cold Storage A",capacity:2e3},{id:"2",name:"Cold Storage B",capacity:1500},{id:"3",name:"Freezer Unit 1",capacity:1e3},{id:"4",name:"Processing Area 1",capacity:500},{id:"5",name:"Processing Area 2",capacity:500}])}}),Se=()=>D(this,null,function*(){$(!0);try{yield Promise.all([oe(),J(),de()])}finally{$(!1)}}),Pe=()=>{const s=t.filter(c=>!l.some(x=>x.warehouse_entry_id===c.id)).length,n=l.reduce((c,x)=>c+(x.processing_yield||0),0),d=l.length>0?n/l.length:0,m=l.reduce((c,x)=>c+(x.processing_waste||0),0),v=l.reduce((c,x)=>(x.final_grade&&["A","B","C"].includes(x.final_grade)&&c[x.final_grade]++,c),{A:0,B:0,C:0}),k=Array.from({length:7},(c,x)=>{const f=new Date;f.setDate(f.getDate()-x);const X=f.toISOString().split("T")[0],De=l.filter(Ae=>{var ge;return(ge=Ae.processing_date)==null?void 0:ge.startsWith(X)}).length;return{date:X,count:De}}).reverse(),T=l.slice(0,10).map(c=>({date:new Date(c.processing_date).toLocaleDateString(),yield:c.processing_yield||0})).reverse();Ce({totalProcessed:l.length,readyForProcessing:s,averageYield:Number(d.toFixed(1)),totalWaste:Number(m.toFixed(1)),gradeDistribution:v,weeklyProcessing:k,yieldTrends:T})};p.useEffect(()=>{if(N&&t.length>0){const s=t.find(n=>n.id===N);s&&Q(n=>O(L({},n),{warehouse_entry_id:s.id,pre_processing_weight:s.total_weight?Number(s.total_weight):0,post_processing_weight:0,final_grade:n.final_grade||"",processing_date:new Date().toISOString()}))}},[N,t]),p.useEffect(()=>{if(h.pre_processing_weight&&h.post_processing_weight!==void 0){const s=h.pre_processing_weight-h.post_processing_weight,n=h.pre_processing_weight>0?h.post_processing_weight/h.pre_processing_weight*100:0;Q(d=>O(L({},d),{processing_waste:s,processing_yield:Number(n.toFixed(2))}))}},[h.pre_processing_weight,h.post_processing_weight]),p.useEffect(()=>{oe(),J(),de()},[]),p.useEffect(()=>{Pe()},[t,l]);const ke=()=>D(this,null,function*(){if(!Y){i(!0);try{const s=y.find(f=>f.name===P),n=t.find(f=>f.id===N),{data:d,error:m}=yield z.from("processing_records").select("id, processing_code").eq("warehouse_entry_id",N).single();if(m&&m.code!=="PGRST116")throw m;if(d){alert(`This warehouse entry has already been processed! Processing Code: ${d.processing_code}`);return}const{generateUniqueProcessingCode:v}=yield ze(()=>D(this,null,function*(){const{generateUniqueProcessingCode:f}=yield import("./entryCodeGenerator-B_emgdBK.js");return{generateUniqueProcessingCode:f}}),__vite__mapDeps([0,1,2])),k=yield v(),T=Math.round((h.post_processing_weight||0)*5),c={warehouse_entry_id:h.warehouse_entry_id,processing_date:new Date().toISOString().split("T")[0],processed_by:null,pre_processing_weight:h.pre_processing_weight,post_processing_weight:h.post_processing_weight,processing_waste:h.processing_waste,processing_yield:h.processing_yield,size_distribution:{},grading_results:{[h.final_grade||"A"]:h.post_processing_weight||0},final_value:(h.post_processing_weight||0)*450,total_pieces:(n==null?void 0:n.total_pieces)||0,ready_for_dispatch_count:T,processing_code:k},{error:x}=yield z.from("processing_records").insert([c]);if(x){if(x.code==="23505"&&x.message.includes("warehouse_entry_id")){alert("This warehouse entry has already been processed! Please refresh the page to see the updated list."),yield J();return}throw x}yield J(),te(),a("sorting")}catch(s){console.error("Error creating processing record:",s.message),alert(`Error creating processing record: ${s.message}`)}finally{i(!1)}}}),te=()=>{G(!1),S(""),Q({}),B(""),i(!1)},xe=s=>{q(s),F(!0)},ie=t.filter(s=>!l.some(n=>n.warehouse_entry_id===s.id));return e.jsx("div",{className:"min-h-screen bg-gray-50 content-container responsive-padding",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(Z,{className:"h-6 w-6 md:h-8 md:w-8 text-blue-600"}),"Processing Management"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Monitor and manage fish processing operations"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(b,{variant:"outline",onClick:Se,disabled:M,children:[e.jsx(ne,{className:`h-4 w-4 mr-2 ${M?"animate-spin":""}`}),"Refresh"]}),e.jsxs(b,{variant:"outline",onClick:()=>a("dashboard"),children:[e.jsx(Oe,{className:"h-4 w-4 mr-2"}),"Dashboard"]}),e.jsxs(fe,{open:I,onOpenChange:s=>s?G(!0):te(),children:[e.jsx(Ye,{asChild:!0,children:e.jsxs(b,{className:"bg-blue-600 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",disabled:ie.length===0,children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),ie.length===0?"No Entries to Process":"Start Processing"]})}),e.jsxs(ue,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ne,{children:e.jsxs(be,{className:"flex items-center gap-2",children:[e.jsx(Z,{className:"h-5 w-5 text-blue-600"}),"Start Fish Processing"]})}),e.jsx(es,{selectedEntryId:N,setSelectedEntryId:S,warehouseEntries:ie,processingRecords:l,formData:h,setFormData:Q,selectedStorage:P,setSelectedStorage:B,storageLocations:y,isProcessing:Y,onSubmit:ke,onClose:te})]})]})]})]}),e.jsx(Ke,{stats:W,processingRecords:l}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(w,{children:[e.jsx(E,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5 text-blue-600"}),"Weekly Processing Activity"]})}),e.jsxs(A,{children:[e.jsx(Xe,{data:W.weeklyProcessing,dataKey:"count"}),e.jsx("div",{className:"mt-2 text-center",children:e.jsx("p",{className:"text-sm text-gray-600",children:"Last 7 days"})})]})]}),e.jsxs(w,{children:[e.jsx(E,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(we,{className:"h-5 w-5 text-purple-600"}),"Yield Trends"]})}),e.jsxs(A,{children:[W.yieldTrends.length>0?e.jsx(Ze,{data:W.yieldTrends,dataKey:"yield"}):e.jsx("div",{className:"h-32 flex items-center justify-center text-gray-500",children:"No yield data available"}),e.jsx("div",{className:"mt-2 text-center",children:e.jsx("p",{className:"text-sm text-gray-600",children:"Recent processing yield %"})})]})]})]}),e.jsxs(w,{children:[e.jsx(E,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-5 w-5"}),"Quality Grade Distribution"]})}),e.jsx(A,{children:e.jsx("div",{className:"grid grid-cols-3 gap-4",children:Object.entries(W.gradeDistribution).map(([s,n])=>e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs(u,{className:`${ee(s)} text-white mb-2`,children:["Grade ",s]}),e.jsx("p",{className:"text-2xl font-bold mt-2",children:n}),e.jsxs("p",{className:"text-sm text-gray-600",children:[W.totalProcessed>0?(n/W.totalProcessed*100).toFixed(1):0,"%"]})]},s))})})]}),e.jsxs(w,{children:[e.jsx(E,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(qe,{className:"h-5 w-5"}),"Recent Processing Activity",e.jsxs(u,{variant:"secondary",className:"ml-auto",children:[_.length," recent"]})]})}),e.jsx(A,{children:_.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No recent processing activity"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Start by processing some warehouse entries"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3",children:_.map(s=>{var n;return t.find(d=>d.id===s.warehouse_entry_id),e.jsx(w,{className:"p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[e.jsxs("div",{className:"space-y-2 flex-1",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(u,{variant:"outline",children:(n=t.find(d=>d.id===s.warehouse_entry_id))==null?void 0:n.entry_code}),e.jsx(u,{className:"bg-purple-500 text-white",children:s.processing_code}),e.jsxs(u,{className:`${ee(s.final_grade)} text-white`,children:["Grade ",s.final_grade]}),e.jsx("span",{className:"text-sm text-gray-600",children:"Size: To be sorted"}),e.jsx(u,{variant:"outline",className:"text-blue-600 border-blue-300",children:"Processing Complete"}),e.jsx("span",{className:"text-xs text-gray-400",children:new Date(s.processing_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-4 text-sm",children:[e.jsxs("span",{children:["Pre: ",s.pre_processing_weight,"kg"]}),e.jsxs("span",{children:["Post: ",s.post_processing_weight,"kg"]}),e.jsxs("span",{children:["Waste: ",s.processing_waste,"kg"]}),e.jsxs("span",{className:se(s.processing_yield),children:["Yield: ",s.processing_yield,"%"]})]}),e.jsxs("p",{className:"flex items-center gap-1 text-sm",children:[e.jsx(le,{className:"h-3 w-3"}),e.jsx("strong",{children:s.storage_location||"Not assigned"})]})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(b,{size:"sm",variant:"outline",onClick:()=>xe(s),children:[e.jsx(je,{className:"h-3 w-3 mr-1"}),"Details"]})})]})},s.id)})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs(b,{variant:"outline",onClick:()=>ce(!R),className:"w-full",children:["View All ",l.length," Records"]})})]})})]}),R&&e.jsxs(w,{className:"mt-6",children:[e.jsx(E,{children:e.jsxs(U,{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"h-5 w-5"}),"All Processing Records (",l.length,")"]})}),e.jsxs(A,{children:[e.jsx("div",{className:"space-y-4",children:l.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Z,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No processing records found"})]}):l.map(s=>{var n;return t.find(d=>d.id===s.warehouse_entry_id),e.jsx(w,{className:"p-4 border border-gray-200 hover:shadow-md transition-all duration-200",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-start gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsx(u,{variant:"outline",className:"font-medium",children:(n=t.find(d=>d.id===s.warehouse_entry_id))==null?void 0:n.entry_code}),e.jsx(u,{className:"bg-purple-500 text-white font-medium",children:s.processing_code}),e.jsxs(u,{className:`${ee(s.final_grade)} text-white font-medium`,children:["Grade ",s.final_grade]}),e.jsx(u,{className:"bg-purple-500 text-white font-medium",children:"Size: To be sorted"}),e.jsx(u,{variant:"outline",className:"text-blue-600 border-blue-300 font-medium",children:"Processing Complete"}),e.jsxs("span",{className:"text-sm text-gray-500 flex items-center gap-1",children:[e.jsx(_e,{className:"h-4 w-4"}),new Date(s.processing_date).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-6 text-sm",children:[e.jsxs("span",{children:["Pre: ",s.pre_processing_weight,"kg"]}),e.jsxs("span",{children:["Post: ",s.post_processing_weight,"kg"]}),e.jsxs("span",{children:["Waste: ",s.processing_waste,"kg"]}),e.jsxs("span",{className:se(s.processing_yield),children:["Yield: ",s.processing_yield,"%"]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:gap-4 text-sm",children:[e.jsxs("span",{className:"flex items-center gap-1 font-medium text-gray-900",children:[e.jsx(le,{className:"h-4 w-4"}),s.farmer_name]}),e.jsxs("span",{className:"flex items-center gap-1 text-gray-600",children:[e.jsx(ae,{className:"h-4 w-4"}),"Storage: ",s.storage_location||"Not assigned"]})]})]}),e.jsx("div",{className:"flex gap-2 flex-shrink-0",children:e.jsxs(b,{size:"sm",variant:"outline",onClick:()=>xe(s),children:[e.jsx(je,{className:"h-4 w-4 mr-1"}),"View Details"]})})]})},s.id)})}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(b,{variant:"outline",onClick:()=>ce(!1),className:"w-full",children:"Show Less"})})]})]}),e.jsx(fe,{open:H,onOpenChange:F,children:e.jsxs(ue,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsx(Ne,{children:e.jsx(be,{className:"text-2xl font-bold",children:"Processing Details"})}),g&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Entry Code"}),e.jsx("span",{className:"font-medium",children:(me=t.find(s=>s.id===g.warehouse_entry_id))==null?void 0:me.entry_code})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Processing Code"}),e.jsx("span",{className:"font-medium",children:g.processing_code})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Processing Date"}),e.jsx("span",{className:"font-medium",children:new Date(g.processing_date).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Farmer"}),e.jsx("span",{className:"font-medium",children:g.farmer_name||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Processed By"}),e.jsx("span",{className:"font-medium",children:g.processed_by||"Not specified"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Final Grade"}),e.jsxs(u,{className:`${ee(g.final_grade)} text-white`,children:["Grade ",g.final_grade]})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Size"}),e.jsx("span",{className:"font-medium",children:"To be sorted"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Storage Location"}),e.jsx("span",{className:"font-medium",children:g.storage_location||"Not assigned"})]}),e.jsxs("div",{className:"flex justify-between py-2 border-b",children:[e.jsx("span",{className:"text-gray-600",children:"Status"}),e.jsx(u,{className:"bg-green-600 text-white",children:"Complete"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Weight Analysis"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[g.pre_processing_weight,"kg"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Pre-Processing"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[g.post_processing_weight,"kg"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Post-Processing"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[g.processing_waste,"kg"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Waste"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:`text-2xl font-bold ${se(g.processing_yield)}`,children:[g.processing_yield,"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Yield"})]})]})]}),g.notes&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Notes"}),e.jsx("p",{className:"text-gray-700 bg-gray-50 p-4 rounded-lg",children:g.notes})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx(b,{onClick:()=>F(!1),children:"Close"})})]})]})})]})})}export{bs as default};
