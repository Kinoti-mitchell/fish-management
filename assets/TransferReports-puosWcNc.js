import{r as h,j as e,a as V,b as G,P as K,L as f,l as j,B as x,m as ie,H as ne,I as ce,n as E}from"./main-DyVZDjuq.js";import{T as de,a as oe,b as Y,c as p,d as me,e as u}from"./table-C7YTP9mR.js";import{i as O}from"./inventoryService-CGfBaGvr.js";import{D as xe,b as he,c as ge,d as pe}from"./dialog-DWWm2Q7P.js";import{T as ue}from"./textarea-COPRaf5U.js";import{C as z}from"./circle-alert-B7JttzzH.js";import{S as I}from"./scale-2Q0tlyLA.js";import{L as Q}from"./loader-circle-D8k1Jz8d.js";import{C as R}from"./circle-x-Dm-Ay4hG.js";import{C as N}from"./circle-check-big-C1kRXgwe.js";import{F as M}from"./file-text-CIYurVtZ.js";import{S as je}from"./search-C0EC0_0v.js";import{R as be}from"./refresh-cw-Cr97JAvS.js";import{D as Ne}from"./download-BUiGx1C6.js";import{C as U}from"./clock-BABH2_nd.js";function ve({isOpen:$,onClose:T,transferRequest:n,onApprove:W,onDecline:q,currentUserId:C}){const[A,L]=h.useState(""),[o,w]=h.useState(!1),[S,v]=h.useState(null),m=async()=>{w(!0),v(null);try{await W(n.id,C),T()}catch(b){v(b.message||"Failed to approve transfer")}finally{w(!1)}},_=async()=>{w(!0),v(null);try{await q(n.id,C),T()}catch(b){v(b.message||"Failed to decline transfer")}finally{w(!1)}};return e.jsx(xe,{open:$,onOpenChange:T,children:e.jsxs(he,{className:"max-w-2xl",children:[e.jsx(ge,{children:e.jsxs(pe,{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-amber-600"}),"Transfer Approval Required"]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(V,{children:e.jsxs(G,{className:"p-4",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),"Transfer Request Details"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(f,{className:"text-sm font-medium text-gray-600",children:"From Storage"}),e.jsx("p",{className:"font-semibold text-gray-900",children:n.from_storage_name})]}),e.jsxs("div",{children:[e.jsx(f,{className:"text-sm font-medium text-gray-600",children:"To Storage"}),e.jsx("p",{className:"font-semibold text-gray-900",children:n.to_storage_name})]}),e.jsxs("div",{children:[e.jsx(f,{className:"text-sm font-medium text-gray-600",children:"Size Class"}),e.jsx(j,{variant:"outline",className:"w-auto justify-center",children:n.is_bulk?n.size_class:`Size ${n.size_class}`}),n.is_bulk&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[n.batch_size," size",n.batch_size!==1?"s":""," in batch"]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx(f,{className:"text-sm font-medium text-gray-600",children:"Total Weight"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5 text-green-600"}),e.jsxs("span",{className:"font-bold text-green-600 text-lg",children:[n.weight_kg.toFixed(1),"kg"]})]})]}),e.jsxs("div",{children:[e.jsx(f,{className:"text-sm font-medium text-gray-600",children:"Piece Count"}),e.jsxs("p",{className:"text-sm text-gray-500",children:[n.quantity.toLocaleString()," pieces"]})]}),n.notes&&e.jsxs("div",{className:"col-span-2",children:[e.jsx(f,{className:"text-sm font-medium text-gray-600",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-700 bg-gray-50 p-2 rounded",children:n.notes})]})]})]})}),e.jsx(V,{children:e.jsxs(G,{className:"p-4",children:[e.jsx(f,{htmlFor:"approval-notes",className:"text-sm font-medium text-gray-700",children:"Approval Notes (Optional)"}),e.jsx(ue,{id:"approval-notes",placeholder:"Add any notes about this approval decision...",value:A,onChange:b=>L(b.target.value),className:"mt-2",rows:3})]})}),S&&e.jsxs("div",{className:"flex items-center gap-2 p-4 bg-red-50 border border-red-200 rounded-lg",children:[e.jsx(z,{className:"w-5 h-5 text-red-600"}),e.jsx("span",{className:"text-red-700",children:S})]}),e.jsxs("div",{className:"flex items-center justify-end gap-3 pt-4 border-t",children:[e.jsxs(x,{variant:"outline",onClick:_,disabled:o,className:"text-red-600 border-red-300 hover:bg-red-50",children:[o?e.jsx(Q,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(R,{className:"w-4 h-4 mr-2"}),"Decline Transfer"]}),e.jsxs(x,{onClick:m,disabled:o,className:"bg-green-600 hover:bg-green-700 text-white",children:[o?e.jsx(Q,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(N,{className:"w-4 h-4 mr-2"}),"Approve & Complete"]})]})]})]})})}function Ee({onNavigate:$}={}){const{user:T}=ie(),[n,W]=h.useState([]),[q,C]=h.useState(!1),[A,L]=h.useState(null),[o,w]=h.useState(""),[S,v]=h.useState(!1),[m,_]=h.useState("all"),[b,F]=h.useState(!1),[r,P]=h.useState(null),X=s=>{const a=new Map,t=[];return s.forEach(l=>{const i=`${l.from_storage}-${l.to_storage}-${l.created_at}-${l.notes||""}`;a.has(i)||a.set(i,[]),a.get(i).push(l)}),a.forEach(l=>{if(l.length>1){const i=l[0],H=l.reduce((y,k)=>y+k.quantity,0),c=l.reduce((y,k)=>y+k.weight_kg,0),B=l.map(y=>y.size).sort((y,k)=>y-k),le={...i,id:`batch-${i.id}`,is_batch:!0,batch_sizes:B,total_batch_quantity:H,total_batch_weight:c,batch_transfers:l,size:B[0]};t.push(le)}else t.push(l[0])}),t.sort((l,i)=>new Date(i.created_at).getTime()-new Date(l.created_at).getTime())},D=async()=>{C(!0),L(null);try{console.log("ðŸ” Fetching transfer history...");const s=await O.getTransferHistory(200);console.log("ðŸ“Š Transfer history data received:",s),console.log("ðŸ“‹ Data analysis:",{totalTransfers:s?.length||0,hasData:s&&s.length>0,sampleTransfer:s?.[0]||null,allTransfers:s});const a=X(s);console.log("ðŸ“¦ Grouped transfers:",a),W(a)}catch(s){console.error("Error fetching transfer history:",s),L(s.message||"Failed to fetch transfer history")}finally{C(!1)}},J=async()=>{v(!0),await D(),v(!1)},Z=async(s,a)=>{try{const t=s.startsWith("batch-")?s.replace("batch-",""):s;await O.approveTransfer(t,a),await D(),F(!1),P(null)}catch(t){throw console.error("Error approving transfer:",t),t}},ee=async(s,a)=>{try{const t=s.startsWith("batch-")?s.replace("batch-",""):s;await O.declineTransfer(t,a),await D(),F(!1),P(null)}catch(t){throw console.error("Error declining transfer:",t),t}},se=s=>{P(s),F(!0)};h.useEffect(()=>{D()},[]);const d=n.filter(s=>{const a=!o||s.from_storage.toLowerCase().includes(o.toLowerCase())||s.to_storage.toLowerCase().includes(o.toLowerCase())||s.notes.toLowerCase().includes(o.toLowerCase())||s.size.toString().includes(o),t=m==="all"||s.status===m;return a&&t}),te=s=>{switch(s){case"pending":return e.jsxs(j,{variant:"outline",className:"bg-yellow-50 text-yellow-700 border-yellow-200",children:[e.jsx(U,{className:"w-3 h-3 mr-1"}),"Pending"]});case"approved":return e.jsxs(j,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.jsx(N,{className:"w-3 h-3 mr-1"}),"Approved"]});case"completed":return e.jsxs(j,{variant:"outline",className:"bg-blue-50 text-blue-700 border-blue-200",children:[e.jsx(N,{className:"w-3 h-3 mr-1"}),"Completed"]});case"declined":return e.jsxs(j,{variant:"outline",className:"bg-red-50 text-red-700 border-red-200",children:[e.jsx(R,{className:"w-3 h-3 mr-1"}),"Denied"]});default:return e.jsx(j,{variant:"outline",className:"bg-gray-50 text-gray-700 border-gray-200",children:s})}},g=(()=>{const s=n.length,a=n.filter(i=>i.status==="pending").length,t=n.filter(i=>i.status==="approved").length,l=n.filter(i=>i.status==="declined").length;return{all:s,pending:a,approved:t,declined:l}})(),ae=()=>{const s=["Date","From Storage","To Storage","Size Class","Weight (kg)","Pieces","Status","Notes","Created By","Approved/Denied By","Action"],a=d.map(c=>[new Date(c.created_at).toLocaleDateString(),c.from_storage,c.to_storage,c.size,c.weight_kg?.toFixed(1)||"0.0",c.quantity,c.status,c.notes,c.created_by||"System",c.approved_by||(c.status==="pending"?"Pending":"-"),c.status==="pending"?"Review":c.status==="approved"?"Approved":c.status==="declined"?"Declined":c.status==="completed"?"Completed":"Unknown"]),t=[s.join(","),...a.map(c=>c.map(B=>`"${B}"`).join(","))].join(`
`),l=new Blob([t],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),H=URL.createObjectURL(l);i.setAttribute("href",H),i.setAttribute("download",`transfer-reports-${new Date().toISOString().split("T")[0]}.csv`),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)},re=()=>{const s=window.open("","_blank");if(!s)return;const a=`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Transfer Reports - ${new Date().toLocaleDateString()}</title>
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            h1 { color: #2563eb; margin-bottom: 20px; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
            th { background-color: #f5f5f5; font-weight: bold; }
            .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
            .summary { background-color: #f8fafc; padding: 15px; border-radius: 5px; margin-bottom: 20px; }
          </style>
        </head>
        <body>
          <div class="header">
            <h1>Fish Inventory Transfer Reports</h1>
            <p>Generated: ${new Date().toLocaleString()}</p>
          </div>
          
          <div class="summary">
            <h3>Summary</h3>
            <p><strong>Total Transfers:</strong> ${d.length}</p>
            <p><strong>Total Quantity Transferred:</strong> ${d.reduce((t,l)=>t+l.quantity,0)} pieces</p>
            <p><strong>Date Range:</strong> ${d.length>0?`${new Date(Math.min(...d.map(t=>new Date(t.created_at).getTime()))).toLocaleDateString()} - ${new Date(Math.max(...d.map(t=>new Date(t.created_at).getTime()))).toLocaleDateString()}`:"No transfers found"}</p>
          </div>

          <table>
            <thead>
              <tr>
                <th>Date</th>
                <th>From Storage</th>
                <th>To Storage</th>
                <th>Size Class</th>
                <th>Weight (kg)</th>
                <th>Pieces</th>
                <th>Status</th>
                <th>Notes</th>
                <th>Created By</th>
                <th>Approved/Denied By</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody>
              ${d.map(t=>`
                <tr>
                  <td>${new Date(t.created_at).toLocaleDateString()}</td>
                  <td>${t.from_storage}</td>
                  <td>${t.to_storage}</td>
                  <td>Size ${t.size}</td>
                  <td>${t.weight_kg?.toFixed(1)||"0.0"}</td>
                  <td>${t.quantity}</td>
                  <td>${t.status}</td>
                  <td>${t.notes}</td>
                  <td>${t.created_by||"System"}</td>
                  <td>${t.approved_by||(t.status==="pending"?"Pending":"-")}</td>
                  <td>${t.status==="pending"?"Review":t.status==="approved"?"Approved":t.status==="declined"?"Declined":t.status==="completed"?"Completed":"Unknown"}</td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </body>
      </html>
    `;s.document.write(a),s.document.close(),s.print()};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 content-container responsive-padding",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(M,{className:"h-6 w-6 md:h-8 md:w-8 text-blue-600"}),"Transfer Reports & Approvals"]}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage and approve fish transfer requests"})]}),$&&e.jsx("div",{className:"flex flex-col sm:flex-row gap-3",children:e.jsxs(x,{onClick:()=>$("inventory"),variant:"outline",className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsx(ne,{className:"w-4 h-4"}),"Back to Inventory"]})})]}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsx("div",{className:"flex-1 max-w-md",children:e.jsxs("div",{className:"relative",children:[e.jsx(je,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(ce,{placeholder:"Search transfers...",value:o,onChange:s=>w(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{onClick:J,variant:"outline",size:"sm",disabled:S,children:[e.jsx(be,{className:`w-4 h-4 mr-2 ${S?"animate-spin":""}`}),"Refresh"]}),e.jsxs(x,{onClick:ae,variant:"outline",size:"sm",disabled:d.length===0,children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),e.jsxs(x,{onClick:re,variant:"outline",size:"sm",disabled:d.length===0,children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Export PDF"]})]})]})}),g.pending>0&&e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-amber-200 p-4 sm:p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:e.jsx(z,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-amber-800",children:"Pending Transfers Require Approval"}),e.jsxs("p",{className:"text-sm text-amber-700",children:["You have ",g.pending," transfer request",g.pending!==1?"s":"",' waiting for approval. Click the "Review" button in the table below to approve or decline transfers.']})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(x,{variant:m==="all"?"default":"outline",size:"sm",onClick:()=>_("all"),className:`flex items-center gap-2 ${m==="all"?"bg-blue-600 hover:bg-blue-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(M,{className:"h-4 w-4"}),"All (",g.all,")"]}),e.jsxs(x,{variant:m==="pending"?"default":"outline",size:"sm",onClick:()=>_("pending"),className:`flex items-center gap-2 ${m==="pending"?"bg-yellow-600 hover:bg-yellow-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(U,{className:"h-4 w-4"}),"Pending (",g.pending,")"]}),e.jsxs(x,{variant:m==="approved"?"default":"outline",size:"sm",onClick:()=>_("approved"),className:`flex items-center gap-2 ${m==="approved"?"bg-green-600 hover:bg-green-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(N,{className:"h-4 w-4"}),"Approved (",g.approved,")"]}),e.jsxs(x,{variant:m==="declined"?"default":"outline",size:"sm",onClick:()=>_("declined"),className:`flex items-center gap-2 ${m==="declined"?"bg-red-600 hover:bg-red-700 text-white":"bg-white hover:bg-gray-50 text-gray-700 border-gray-300"}`,children:[e.jsx(R,{className:"h-4 w-4"}),"Denied (",g.declined,")"]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Transfers"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:d.length})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(E,{className:"w-6 h-6 text-blue-600"})})]}),e.jsxs("div",{className:"mt-2 flex items-center text-sm",children:[e.jsxs("span",{className:"text-green-600 font-medium",children:[g.approved," approved"]}),e.jsx("span",{className:"text-gray-400 mx-2",children:"â€¢"}),e.jsxs("span",{className:"text-gray-500",children:[g.pending," pending"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Quantity"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:d.reduce((s,a)=>s+a.quantity,0)})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(K,{className:"w-6 h-6 text-green-600"})})]}),e.jsx("div",{className:"mt-2 flex items-center text-sm",children:e.jsx("span",{className:"text-gray-600",children:"Total pieces transferred"})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Weight"}),e.jsxs("p",{className:"text-2xl font-bold text-orange-600",children:[d.reduce((s,a)=>s+(a.weight_kg||0),0).toFixed(1),"kg"]})]}),e.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:e.jsx(I,{className:"w-6 h-6 text-orange-600"})})]}),e.jsx("div",{className:"mt-2 flex items-center text-sm",children:e.jsx("span",{className:"text-gray-600",children:"Total weight transferred"})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pending Reviews"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:g.pending})]}),e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(U,{className:"w-6 h-6 text-purple-600"})})]}),e.jsx("div",{className:"mt-2 flex items-center text-sm",children:g.pending>0?e.jsxs("span",{className:"text-amber-600 font-medium flex items-center",children:[e.jsx(z,{className:"w-4 h-4 mr-1"}),"Needs attention"]}):e.jsxs("span",{className:"text-green-600 font-medium flex items-center",children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),"All caught up"]})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Transfer History"}),e.jsx("p",{className:"text-sm text-gray-600",children:"View and manage all transfer requests"})]}),e.jsx("div",{className:"p-0",children:q?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Q,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),e.jsx("p",{className:"text-gray-600",children:"Loading transfer history..."})]})}):A?e.jsxs("div",{className:"flex items-center gap-2 p-8 bg-red-50 border border-red-200 rounded-lg m-6",children:[e.jsx(z,{className:"w-5 h-5 text-red-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-red-800",children:"Error Loading Data"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:A}),e.jsx(x,{onClick:D,variant:"outline",size:"sm",className:"mt-2",children:"Try Again"})]})]}):d.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"p-4 bg-gray-50 rounded-full w-20 h-20 mx-auto mb-4 flex items-center justify-center",children:e.jsx(E,{className:"w-10 h-10 text-gray-400"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Transfers Found"}),e.jsx("p",{className:"text-gray-600",children:o?"No transfers match your search criteria":"No transfers have been recorded yet"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(de,{children:[e.jsx(oe,{children:e.jsxs(Y,{children:[e.jsx(p,{children:"Date"}),e.jsx(p,{children:"From Storage"}),e.jsx(p,{children:"To Storage"}),e.jsx(p,{children:"Size Class"}),e.jsx(p,{children:"Weight (kg)"}),e.jsx(p,{children:"Pieces"}),e.jsx(p,{children:"Status"}),e.jsx(p,{children:"Notes"}),e.jsx(p,{children:"Created By"}),e.jsx(p,{children:"Approved/Denied By"}),e.jsx(p,{children:"Actions"})]})}),e.jsx(me,{children:d.map(s=>e.jsxs(Y,{children:[e.jsx(u,{className:"font-medium",children:new Date(s.created_at).toLocaleDateString()}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1 bg-red-100 rounded",children:e.jsx(E,{className:"w-3 h-3 text-red-600"})}),e.jsx("span",{className:"font-medium",children:s.from_storage})]})}),e.jsx(u,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-1 bg-green-100 rounded",children:e.jsx(E,{className:"w-3 h-3 text-green-600 rotate-180"})}),e.jsx("span",{className:"font-medium",children:s.to_storage})]})}),e.jsx(u,{children:e.jsx("div",{className:"flex flex-col items-center gap-1",children:s.is_batch?e.jsxs("div",{className:"flex flex-wrap gap-1 justify-center",children:[e.jsx(j,{variant:"secondary",className:"text-xs",children:"Batch"}),s.batch_sizes?.map((a,t)=>e.jsxs(j,{variant:"outline",className:"text-xs",children:["Size ",a]},t))]}):e.jsxs(j,{variant:"outline",className:"w-auto justify-center",children:["Size ",s.size]})})}),e.jsx(u,{className:"font-semibold text-blue-600",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(I,{className:"w-4 h-4"}),s.is_batch?`${s.total_batch_weight?.toFixed(1)||"0.0"}kg`:`${s.weight_kg?.toFixed(1)||"0.0"}kg`]})}),e.jsx(u,{className:"text-sm text-gray-500",children:s.is_batch?`${s.total_batch_quantity||0} pieces`:`${s.quantity} pieces`}),e.jsx(u,{children:te(s.status)}),e.jsx(u,{className:"max-w-xs truncate",children:s.notes||"-"}),e.jsx(u,{className:"text-sm text-gray-500",children:s.created_by||"System"}),e.jsx(u,{className:"text-sm text-gray-500",children:s.approved_by||(s.status==="pending"?"Pending":"-")}),e.jsxs(u,{children:[s.status==="pending"&&e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>se(s),className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:[e.jsx(N,{className:"w-4 h-4 mr-1"}),"Review"]}),s.status==="approved"&&e.jsxs("div",{className:"flex items-center gap-1 text-green-600",children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Approved"})]}),s.status==="declined"&&e.jsxs("div",{className:"flex items-center gap-1 text-red-600",children:[e.jsx(R,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Declined"})]}),s.status==="completed"&&e.jsxs("div",{className:"flex items-center gap-1 text-blue-600",children:[e.jsx(N,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Completed"})]})]})]},s.id))})]})})})]}),b&&r&&e.jsx(ve,{isOpen:b,onClose:()=>{F(!1),P(null)},transferRequest:{id:r.id,from_storage_name:r.from_storage,to_storage_name:r.to_storage,size_class:r.is_batch?0:r.size,quantity:r.is_batch?r.total_batch_quantity||0:r.quantity,weight_kg:r.is_batch?r.total_batch_weight||0:r.weight_kg,notes:r.notes,created_at:r.created_at,is_bulk:r.is_batch||r.is_bulk,batch_size:r.is_batch?r.batch_sizes?.length||0:r.batch_size,batch_transfers:r.batch_transfers,is_batch:r.is_batch,batch_sizes:r.batch_sizes,total_batch_quantity:r.total_batch_quantity,total_batch_weight:r.total_batch_weight},onApprove:Z,onDecline:ee,currentUserId:T?.id||""})]})})}export{Ee as default};
